{"version":3,"sources":["components/browseOrgs/Organizations.tsx","components/browseOrgs/OrganizationsContainer.tsx","types/index.tsx","redux/actions/index.tsx","redux/reducers/addOrg.ts","redux/reducers/editOrg.ts","redux/reducers/viewOrg.ts","redux/reducers/searchOrgs.ts","redux/reducers/auth.ts","redux/reducers/app.ts","redux/reducers/manageOrganizationRequests.ts","redux/reducers/viewMembers.ts","redux/reducers/inviteUser.ts","redux/reducers/manageMembership.ts","redux/reducers/index.tsx","data/groups.tsx","components/Header.tsx","components/browseOrgs/OrganizationsBrowser.tsx","data/userProfile.ts","data/model.ts","redux/actions/viewOrg.ts","redux/actions/searchOrgs.ts","components/browseOrgs/OrganizationsBrowserContainer.tsx","redux/actions/addOrg.ts","components/newOrganization/NewOrganization.tsx","components/newOrganization/container.tsx","components/organizationHeader/component.tsx","components/Avatar.tsx","components/Member.tsx","components/organizationHeader/container.tsx","components/viewOrganization/ViewOrganization.tsx","components/viewOrganization/ViewOrganizationContainer.tsx","redux/actions/editOrg.ts","components/EditOrganization.tsx","containers/EditOrganization.tsx","components/Auth.tsx","data/auth.ts","redux/actions/auth.ts","containers/Auth.tsx","lib/windowChannel.ts","lib/IFrameSimulator.ts","lib/IFrameIntegration.ts","redux/actions/app.ts","components/KBaseIntegration.tsx","containers/KBaseIntegration.tsx","redux/actions/manageOrganizationRequests.ts","components/User.tsx","components/manageOrganizationRequests/component.tsx","components/manageOrganizationRequests/container.tsx","components/manageOrganizationRequests/loader.tsx","redux/actions/viewMembers.ts","components/viewMembers/MemberRow.tsx","components/viewMembers/component.tsx","components/viewMembers/container.ts","components/viewMembers/loader.tsx","redux/actions/inviteUser.ts","components/inviteUser/InviteUser.tsx","components/inviteUser/InviteUserContainer.tsx","components/inviteUser/InviteUserLoader.tsx","components/manageMembership/component.tsx","redux/actions/manageMembership.ts","components/manageMembership/loader.tsx","redux/state.tsx","App.tsx","index.tsx"],"names":["Organizations","_React$Component","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","searchTerms","inherits","createClass","key","value","org","gravatarHash","react","style","width","height","src","getAvatarUrl","relation","type","types","NONE","icon","VIEW","tooltip","placement","mouseEnterDelay","title","MEMBER_REQUEST_PENDING","color","MEMBER_INVITATION_PENDING","MEMBER","ADMIN","OWNER","requestsPending","adminRequests","length","theme","twoToneColor","className","count","singular","plural","members","pluralize","renderMemberCount","index","String","NavLink","to","concat","id","renderAvatar","name","href","owner","user","username","target","realname","Intl","DateTimeFormat","month","day","year","format","createdAt","renderRelation","renderRelationInfo","renderAdminInfo","_this2","organizations","map","renderOrg","es_alert","maxWidth","margin","message","renderOrgs","React","connect","UIErrorType","MemberType","UserRelationToOrganization","RequestType","RequestResourceType","RequestStatus","AuthState","EditOrgState","SyncState","EditState","SaveState","ValidationState","FieldState","ViewOrgState","AppState","SortDirection","ComponentLoadingState","ViewMembersViewState","BrowseOrgsState","InviteUserState","ActionFlag","browseOrgs","view","Error","reducer","action","ADD_ORG_START","objectSpread","addOrg","saveState","SAVING","addOrgStart","ADD_ORG_SUCCESS","editState","UNEDITED","SAVED","addOrgSuccess","ADD_ORG_ERROR","SAVE_ERROR","error","addOrgError","ADD_ORG_EDIT_START","validationState","NEW","newOrganization","status","description","addOrgEditStart","ADD_ORG_EDIT_FINISH","addOrgEditFinish","ADD_ORG_UPDATE_NAME_SUCCESS","EDITED","EDITED_OK","addOrgUpdateNameSuccess","ADD_ORG_UPDATE_NAME_ERROR","EDITED_ERROR","addOrgUpdateNameError","ADD_ORG_UPDATE_GRAVATAR_HASH_SUCCESS","addOrgUpdateGravatarHashSuccess","ADD_ORG_UPDATE_GRAVATAR_HASH_ERROR","addOrgUpdateGravatarHashError","ADD_ORG_UPDATE_ID_SUCCESS","addOrgUpdateIdSuccess","ADD_ORG_UPDATE_ID_ERROR","addOrgUpdateIdError","ADD_ORG_UPDATE_DESCRIPTION_SUCCESS","addOrgUpdateDescriptionSuccess","ADD_ORG_UPDATE_DESCRIPTION_ERROR","addOrgUpdateDescriptionError","ADD_ORG_EVALUATE_OK","VALID","addOrgEvaluateOk","ADD_ORG_EVALUATE_ERRORS","INVALID","addOrgEvaluateErrors","EDIT_ORG_EDIT_START","editOrg","organizationId","editedOrganization","editOrgEditStart","EDIT_ORG_EDIT_SUCCESS","editOrgEditSuccess","EDIT_ORG_SAVE_START","editOrgSaveStart","EDIT_ORG_SAVE_SUCCESS","editOrgSaveSuccess","EDIT_ORG_SAVE_ERROR","editOrgSaveError","EDIT_ORG_UPDATE_NAME_SUCCESS","editOrgUpdateNameSuccess","EDIT_ORG_UPDATE_NAME_ERROR","editOrgUpdateNameError","EDIT_ORG_UPDATE_GRAVATAR_HASH_SUCCESS","editOrgUpdateGravatarHashSuccess","EDIT_ORG_UPDATE_GRAVATAR_HASH_ERROR","editOrgUpdateGravatarHashError","EDIT_ORG_UPDATE_DESCRIPTION_SUCCESS","editOrgUpdateDescriptionSuccess","EDIT_ORG_UPDATE_DESCRIPTION_ERROR","editOrgUpdateDescriptionError","EDIT_ORG_EVALUATE_OK","editOrgEvaluateOk","EDIT_ORG_EVALUATE_ERRORS","editOrgEvaluateErrors","VIEW_ORG_FETCH_START","viewOrg","FETCHING","viewOrgStart","VIEW_ORG_FETCH_SUCCESS","READY","organization","viewOrgSuccess","VIEW_ORG_FETCH_ERROR","ERROR","viewOrgError","VIEW_ORG_STOP","viewOrgStop","SEARCH_ORGS_START","console","warn","_state$browseOrgs$vie","filter","sortBy","sortDirection","auth","authorization","SEARCHING","selectedOrganizationId","searchOrgsStart","SEARCH_ORGS_SUCCESS","SUCCESS","totalCount","filteredCount","searchOrgsSuccess","SEARCH_ORGS_ERROR","log","searching","searchOrgsError","SORT_ORGS_START","_state$browseOrgs$vie2","sortOrgsStart","FILTER_ORGS_START","filterOrgsStart","AUTH_CHECK_START","CHECKING","token","roles","authCheckStart","AUTH_AUTHORIZED","AUTHORIZED","authAuthorized","AUTH_UNAUTHORIZED","UNAUTHORIZED","authUnauthorized","AUTH_CHECK_ERROR","authCheckError","APP_SUCCESS","app","config","appSuccess","ADMIN_MANAGE_REQUESTS_START","manageOrganizationRequestsStart","ADMIN_MANAGE_REQUESTS_SUCCESS","manageOrganizationRequestsView","viewState","requests","manageOrganizationRequestsSuccess","ADMIN_MANAGE_REQUESTS_ERROR","manageOrganizationRequestsError","VIEW_MEMBERS_LOAD_START","viewMembersView","LOADING","viewMembersLoadStart","VIEW_MEMBERS_LOAD_SUCCESS","viewMembersLoadSuccess","VIEW_MEMBERS_LOAD_ERROR","viewMembersLoadError","VIEW_MEMBERS_UNLOAD","viewMembersUnload","VIEW_MEMBERS_PROMOTE_TO_ADMIN_SUCCESS","member","memberUsername","newState","viewMembersPromoteToAdminSuccess","VIEW_MEMBERS_DEMOTE_TO_MEMBER_SUCCESS","viewMembersDemoteToMemberSuccess","INVITE_USER_LOAD_START","inviteUserView","inviteUserLoadStart","INVITE_USER_LOAD_READY","users","selectedUser","inviteUserLoadReady","INVITE_USER_LOAD_ERROR","inviteUserLoadError","INVITE_USER_SEARCH_USERS_SUCCESS","searchUsersSuccess","INVITE_USER_SELECT_USER_SUCCESS","selectUserSuccess","MANAGE_MEMBERSHIP_LOAD_START","manageMembershipView","loading","manageMembershipLoadStart","MANAGE_MEMBERSHIP_LOAD_SUCCESS","manageMembershipLoadSuccess","MANAGE_MEMBERSHIP_LOAD_ERROR","manageMembershipLoadError","addOrgReducer","editOrgReducer","searchOrgsReducer","viewOrgReducer","authReducer","appReducer","manageOrganizatiopRequests","viewMembers","inviteUser","manageMembership","Header","children","fa","verticalAlign","marginLeft","marginRight","flex","data-test","display","flexDirection","alignItems","buildSeparator","OrganizationsBrowser","searchInput","searchButton","showInfo","onSearchOrgs","Modal","info","content","current","split","currentSearchInputValue","setState","e","preventDefault","doSearch","onSortOrgs","onFilterOrgs","onSearchInputChange","onSubmit","bind","placeholder","onChange","autoFocus","ref","es_button","disabled","haveSearchInput","form","htmlType","renderSearchIcon","onClick","onClearSearch","src_components_Header","fontWeight","fontStyle","renderSearchFeedback","justifyContent","shape","onShowInfo","es_select","onSortByChange2","defaultValue","dropdownMatchSelectWidth","Option","onSortDirectionChange2","ASCENDING","DESCENDING","onFilterChange2","code","OrganizationsContainer","renderHeader","renderSearchBar","renderSearchFilter","renderOrganizations","UserProfileClient","_ref","url","method","param","version","Math","random","slice","params","fetch","mode","cache","headers","Authorization","Content-Type","Accept","body","JSON","stringify","makeEmptyPayload","then","response","statusText","json","makePayload","result","usernames","query","start","Date","getTime","GroupsClient","exists","orgs","_ref2","Promise","all","group","getGroupById","newGroup","custom","gravatarhash","groupUpdate","groupId","URLSearchParams","includeClosed","append","startAt","toString","_ref3","requestId","_ref4","_ref5","_ref6","join","_ref7","_ref8","_ref9","Model","cachedOrgs","groupsClient","groupsServiceURL","getCreatedRequests","groups","getTargetedRequests","slicedToArray","invitations","request","userProfileClient","userProfile","userProfileServiceURL","requester","resourcetype","push","resource","getUserProfiles","profiles","requestType","INVITATION","REQUEST","stringToRequestType","resourceType","USER","WORKSPACE","APP","stringToResourceType","requestStatus","OPEN","groupid","profileToUser","createdate","expireAt","expiredate","modifiedAt","moddate","workspace","getGroupRequests","groupRequestToOrgRequest","memberUsernames","adminUsernames","userProfileMap","_this3","p","get","admin","sort","a","b","localeCompare","_this4","admins","_this5","allUsers","getPendingRequests","pendingRequests","Map","forEach","req","set","pendingInvites","userProfiles","reduce","profile","ownerProfile","fun","getGroupMembers","indexOf","has","getPendingOrganizationRequests","resolve","reject","ex","groupIds","_this6","allRequests","_this7","keys","adminGroupIds","Array","from","getPendingAdminRequests","_ref8$","pendingAdminRequests","profileMap","orgMembers","membersAndAdminsToMembers","_this8","getGroups","groupsToOrgs","getOrgs","direction","applySort","searchTermsRe","term","RegExp","every","termRe","test","applyOrgSearch","findIndex","applyFilter","total","jobTitle","userdata","jobTitleOther","city","country","avatarOption","synced","gravatarDefault","_this9","groupToOrg","groupExists","newOrg","_this10","createGroup","orgUpdate","updateGroup","_this11","requestMembership","catch","err","_this12","cancelRequest","_this13","acceptRequest","_this14","denyRequest","_this15","_this16","memberToAdmin","adminToMember","removeMember","_this17","requestJoinGroup","Validation","validateOrgId","validateOrgName","validateOrgDescription","searchUsers","_ref10","_this18","getUserProfile","match","StaticData","viewOrgJoinRequestError","VIEW_ORG_JOIN_REQUEST_ERROR","viewOrgCancelJoinRequestError","VIEW_ORG_CANCEL_JOIN_REQUEST_ERROR","acceptJoinInvitationStart","VIEW_ORG_ACCEPT_JOIN_INVITATION_START","acceptJoinInvitationError","VIEW_ORG_ACCEPT_JOIN_INVITATION_ERROR","viewOrgFetch","dispatch","getState","_getState","_getState$auth$author","services","Groups","UserProfile","workspaceServiceURL","Workspace","getOrg","viewOrgJoinRequest","_getState2","_getState2$auth$autho","model","requestMembershipToGroup","VIEW_ORG_JOIN_REQUEST_SUCCESS","viewOrgCancelJoinRequest","VIEW_ORG_JOIN_REQUEST_START","_getState3","_getState3$auth$autho","newRequest","VIEW_ORG_CANCEL_JOIN_REQUEST_SUCCESS","acceptJoinInvitation","_getState4","_getState4$auth$autho","VIEW_ORG_ACCEPT_JOIN_INVITATION_SUCCESS","rejectJoinInvitation","_getState5","_getState5$auth$autho","VIEW_ORG_REJECT_JOIN_INVITATION_SUCCESS","VIEW_ORG_REJECT_JOIN_INVITATION_ERROR","searchOrgs","_browseOrgs$view","queryOrgs","sortOrgs","_browseOrgs$view2","filterOrgs","_browseOrgs$view3","storeState","_storeState$browseOrg","_storeState$browseOrg2","actions","AddOrgEvaluateErrors","addOrgEdit","addOrgEvaluate","addOrgUpdateName","_Validation$validateO","_Validation$validateO2","validatedName","addOrgUpdateGravatarHash","_Validation$validateO3","validateOrgGravatarHash","_Validation$validateO4","validateGravatarHash","addOrgUpdateId","_Validation$validateO5","_Validation$validateO6","validatedId","_state$auth$authoriza","newModelFromState","addOrgUpdateDescription","_model$validateOrgDes","_model$validateOrgDes2","validatedDescription","NewOrganization","cancelToBrowser","gravatarEmail","origin","document","location","onAddOrgEdit","email","hashed","md5","onUpdateGravatarHash","isModified","confirm","onOk","onCancel","okText","cancelText","onAddOrg","persist","onUpdateName","onUpdateDescription","onUpdateId","onNameChange","marginBottom","onGravatarEmailSync","onGravatarHashChange","onIdChange","minHeight","maxHeight","onDescriptionChange","getOrgAvatarUrl","renderOrgAvatar","dangerouslySetInnerHTML","__html","marked","_this$props","label","orgName","canSave","onClickCancelToBrowser","Redirect","renderForm","renderPreview","renderLoadingHeader","NavigateTo","_ref$addOrg","Avatar","avatarUrl","size","Member","src_components_Avatar","avatarSize","renderRole","x","OrganizationHeader","navigateTo","onJoinOrg","success","onCancelJoinRequest","onAcceptInvitation","onRejectInvitation","MANAGE_MEMBERSHIP","VIEW_MEMBERS","MANAGE_REQUESTS","EDIT_ORGANIZATION","Avatar_Avatar","textAlign","onJoinClick","spin","menu","es_menu","Item","onNavigateToMembership","dropdown","overlay","trigger","fontSize","adminMenu","onNavigateToViewMembers","onNavigateToManageRequests","onNavigateToEditOrganization","ownerMenu","renderOrgInfo","getRelationClass","ViewOrganization","onViewOrg","renderEditRow","organizationHeader_container","marginTop","isMember","src_components_Member","card","renderAdminRequestsRow","renderAdminRequests","renderEditButton","renderJoinButton","memberCount","extras","onViewMembers","extra","renderMembers","fakeNarratives","i","workspaceId","public","perm","floor","narrativesTable","narrative","narrativeCount","renderOrgHeader","renderNarratives","renderAdminTasks","renderInfo","renderMemberCard","_ref$viewOrg","EditOrgEvaluateErrors","editOrgEdit","editableOrg","UNEDITED_OK","EDIT_ORG_EDIT_ERROR","editOrgSave","_getState2$editOrg","update","updateOrg","editOrgEvaluate","editOrgUpdateName","editOrgUpdateGravatarHash","editOrgUpdateDescription","EditOrganization","cancelToViewer","onEditOrgEdit","onEditOrgSave","onClickCancelToViewer","_ref$editOrg","Auth","tokenRef","checkAuth","onRemoveAuthorization","onAddAuthorization","onLoginClick","onLogoutClick","buildAuthToolbar","buildAuthForm","hosted","buildAuthProd","buildAuthDev","endpoints","AuthClient","path","makePath","Cookies","getTokenInfo","getMe","account","desc","Listener","onSuccess","onError","WaitingListener","started","timeout","Message","payload","channel","uuidv4","created","envelope","Channel","window","host","channelId","awaitingResponse","waitingListeners","listeners","lastId","sentCount","receivedCount","unwelcomeReceivedCount","unwelcomeReceivedCountThreshhold","unwelcomeReceiptWarning","unwelcomeReceiptWarningCount","currentListener","messageEvent","data","delete","handler","awaiting","listener","messageId","listen","postMessage","getMessage","sendMessage","sendRequest","setTimeout","now","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_loop","elapsed","_iterator","entries","Symbol","iterator","next","done","return","startMonitor","listenOnce","sent","received","receiveMessage","addEventListener","removeEventListener","IFrameSimulator","frameId","uuid","parentHost","IFrameIntegration","frameElement","hasAttribute","getAttribute","parse","decodeURIComponent","KBaseIntegration","onAppStart","iframeParams","getParamsFromIFrame","baseUrl","fakeIframeParams","manageOrganizationRequests","manageOrganizationRequestsAcceptJoinRequest","ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_SUCCESS","manageOrganizationRequestsAcceptJoinRequestSuccess","ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_ERROR","manageOrganizationRequestsDenyJoinRequest","ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_SUCCESS","manageOrganizationRequestsDenyJoinRequestSuccess","ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_ERROR","User","ManageGroupRequests","onAcceptJoinRequest","onDenyJoinRequest","open","someDate","measure","measureAbs","unit","nowDate","round","elapsedAbs","abs","prefix","suffix","getFullYear","hoverable","headStyle","backgroundColor","src_components_User","niceElapsed","renderRequestJoinRequest","renderRequestNarrativeRequest","renderRequestAppRequest","padding","renderRequest","es_Redirect","renderRequests","Component","Loader","loadingState","onLoad","renderLoading","manageOrganizationRequests_container","viewMembersLoad","viewMembersPromoteToAdmin","VIEW_MEMBERS_PROMOTE_TO_ADMIN_START","VIEW_MEMBERS_PROMOTE_TO_ADMIN_ERROR","viewMembersDemoteToMember","VIEW_MEMBERS_DEMOTE_TO_MEMBER_START","VIEW_MEMBERS_DEMOTE_TO_MEMBER_ERROR","viewMembersRemoveMember","VIEW_MEMBERS_REMOVE_MEMBER_START","VIEW_MEMBERS_REMOVE_MEMBER_SUCCESS","VIEW_MEMBERS_REMOVE_MEMBER_ERROR","MemberRow","over","onPromoteMemberToAdmin","onDemoteAdminToMember","onRemoveMember","renderPromoteButton","renderOwnerMenu","renderAdminMenu","renderMemberMenu","onMouseEnter","onMouseOver","onMouseLeave","onMouseOut","renderMemberOptions","ViewMembers","adminUsername","viewMembers_MemberRow","overflowY","adminList","renderAdminButtons","onViewMembersUnload","renderOrganizationHeader","renderMembersToolbar","renderAdminsToolbar","renderAdmins","ViewMembersLoader","onViewMembersLoad","viewMembers_container","inviteUserLoad","inviteUserSearchUsers","INVITE_USER_SEARCH_USERS_START","INVITE_USER_SEARCH_USERS_ERROR","selectUser","selectedUsername","INVITE_USER_SELECT_USER_START","getUser","INVITE_USER_SELECT_USER_ERROR","sendInvitation","INVITE_USER_SEND_INVITATION_START","_getState4$inviteUser","groupRequest","INVITE_USER_SEND_INVITATION_SUCCESS","INVITE_USER_SEND_INVITATION_ERROR","InviteUser","lastSearchAt","cancelToViewMembers","autocompleteMessage","onSendInvitation","searchDebounce","onSearchUsers","onSelectUser","text","onClickCancelToViewMembers","dataSource","foundUsers","auto_complete","onSearch","onSelect","input","colSpan","renderUserSelection","renderSelectedUser","renderInvitationForm","renderInvitationStatus","InviteUserLoader","onInviteUserLoad","renderError","InviteUserContainer","ManageMembership","doCancelToViewer","doCancelToBrowser","doShowInfo","manageMembershipLoad","ManageMembershipLoader","manageMembership_component","StateInstances","rawOrganizations","makeEmptyEditableOrganization","pending","library","add","faSpinner","faSearch","initialState","makeInitialState","store","createStore","theReducer","compose","applyMiddleware","thunk","App","react_default","createElement","es","containers_Auth","containers_KBaseIntegration","HashRouter","basename","Route","component","ViewOrganizationContainer","containers_EditOrganization","loader","viewMembers_loader","inviteUser_InviteUserLoader","manageMembership_loader","exact","ReactDOM","render","src_App_0","getElementById"],"mappings":"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","file":"static/js/main.0541a2e0.chunk.js","sourcesContent":["import * as React from 'react';\nimport './Organizations.css';\nimport * as types from '../../types';\nimport { NavLink } from 'react-router-dom';\nimport { Alert, Icon, Tooltip } from 'antd';\nimport { Organization } from '../../types';\n\n// TODO: need more ergonomic way to resolve the common issue of data types interfering with \n// component types.\n\nexport interface OrganizationsProps {\n    organizations: Array<Organization>\n}\n\nexport interface OrganizationsState {\n    searchTerms: Array<string>\n}\n\nexport class Organizations extends React.Component<OrganizationsProps, OrganizationsState> {\n\n    constructor(props: OrganizationsProps) {\n        super(props)\n\n        this.state = {\n            searchTerms: []\n        }\n    }\n\n    getAvatarUrl(org: Organization) {\n        // const defaultImages = [\n        //     'orgs-64.png',\n        //     'unicorn-64.png'\n        // ]\n        // if (!org.gravatarHash) {\n        //     return defaultImages[Math.floor(Math.random() * 2)]\n        // }\n        if (!org.gravatarHash) {\n            return 'unicorn-64.png'\n        }\n        const gravatarDefault = 'identicon';\n\n        return 'https://www.gravatar.com/avatar/' + org.gravatarHash + '?s=64&amp;r=pg&d=' + gravatarDefault;\n    }\n\n    renderAvatar(org: Organization) {\n        return (\n            <img style={{ width: 64, height: 64 }}\n                src={this.getAvatarUrl(org)} />\n        )\n    }\n\n    renderRelation(org: Organization) {\n        switch (org.relation.type) {\n            case (types.UserRelationToOrganization.NONE):\n                return (\n                    <span><Icon type=\"stop\" />None</span>\n                )\n            case (types.UserRelationToOrganization.VIEW):\n                return (\n                    <Tooltip\n                        placement=\"bottomRight\"\n                        mouseEnterDelay={0.5}\n                        title=\"You are not a member of this org, but you may access it; you may request membership\"\n                    >\n                        <span><Icon type=\"stop\" /> You are not a member - view group to join</span>\n                    </Tooltip>\n                )\n            case (types.UserRelationToOrganization.MEMBER_REQUEST_PENDING):\n                return (<span><Icon type=\"user\" style={{ color: 'orange' }} /> Your membership <b>request</b> is pending</span>)\n            case (types.UserRelationToOrganization.MEMBER_INVITATION_PENDING):\n                return (<span><Icon type=\"user\" style={{ color: 'blue' }} /> You have been <b>invited</b> to join</span>)\n            case (types.UserRelationToOrganization.MEMBER):\n                return (<span><Icon type=\"user\" /> You are a <b>member</b> of this organization</span>)\n            case (types.UserRelationToOrganization.ADMIN):\n                return (<span><Icon type=\"unlock\" />Admin</span>)\n            case (types.UserRelationToOrganization.OWNER):\n                return (\n                    <Tooltip\n                        placement=\"bottomRight\"\n                        mouseEnterDelay={0.5}\n                        title=\"You own this org\"\n                    >\n                        <span><Icon type=\"crown\" /> You are the <b>owner</b> of this Organization</span>\n                    </Tooltip>\n                )\n        }\n    }\n\n    renderAdminInfo(org: Organization) {\n        if (!(org.relation.type === types.UserRelationToOrganization.OWNER ||\n            org.relation.type === types.UserRelationToOrganization.ADMIN)) {\n            return\n        }\n        let requestsPending\n        if (org.adminRequests.length > 0) {\n            requestsPending = (\n                <div>\n                    <Icon type=\"exclamation-circle\" theme=\"twoTone\" twoToneColor=\"orange\" />  group has <b>{org.adminRequests.length} pending request{org.adminRequests.length > 1 ? 's' : ''}</b>\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"admin\">\n                {requestsPending}\n            </div>\n        )\n    }\n\n    pluralize(count: number, singular: string, plural: string) {\n        if (count === 0 || count > 1) {\n            return plural\n        }\n        return singular\n    }\n\n    renderMemberCount(org: Organization) {\n        return (\n            <div className=\"memberCount\">\n                {org.members.length > 0 ? org.members.length : 'no'} {this.pluralize(org.members.length, 'member', 'members')}\n            </div>\n        )\n    }\n\n    renderRelationInfo(org: Organization) {\n        switch (org.relation.type) {\n            case types.UserRelationToOrganization.NONE:\n                return (\n                    <div>\n                        Only members may view membership information\n                    </div>\n                )\n                break\n            case types.UserRelationToOrganization.VIEW:\n                return (\n                    <div>Only members may view membership information</div>\n                )\n                break\n            case types.UserRelationToOrganization.MEMBER:\n                return (\n                    <div>\n                        {this.renderMemberCount(org)}\n                    </div>\n                )\n                break\n            case types.UserRelationToOrganization.MEMBER_REQUEST_PENDING:\n                return (\n                    <div>Only members may view membership information</div>\n                )\n                break\n            case types.UserRelationToOrganization.MEMBER_INVITATION_PENDING:\n                return (\n                    <div>\n                        Only members may view membership information\n                    </div>\n                )\n                break\n            case types.UserRelationToOrganization.ADMIN:\n                return (\n                    <div>\n                        {this.renderMemberCount(org)}\n                    </div>\n                )\n                break\n            case types.UserRelationToOrganization.OWNER:\n                return (\n                    <div>\n                        {this.renderMemberCount(org)}\n                    </div>\n                )\n                break\n        }\n    }\n\n    renderOrg(org: Organization, index: Number) {\n        return (\n            <div className=\"row organization\" key={String(index)}>\n                <div className=\"col2\">\n                    <NavLink to={`/viewOrganization/${org.id}`}>\n                        {this.renderAvatar(org)}\n                    </NavLink>\n                </div>\n                <div className=\"col1\">\n                    <div className=\"orgName\">\n                        <NavLink to={`/viewOrganization/${org.id}`}>\n                            {org.name}\n                        </NavLink>\n                    </div>\n                    <div className=\"orgOwner\">\n                        <span className=\"field-label\">owner</span>\n                        <span className=\"field-value\"><a href={\"/#people/\" + org.owner.user.username} target=\"_blank\">{org.owner.user.realname} {org.owner.user.username}</a></span>\n\n                    </div>\n                    <div className=\"orgCreated\">\n                        <span className=\"field-label\">established</span>\n                        <span className=\"field-value\">{Intl.DateTimeFormat('en-US', {\n                            month: 'short',\n                            day: 'numeric',\n                            year: 'numeric'\n                        }).format(org.createdAt)}</span>\n                    </div>\n\n                    <div className=\"relation\">\n                        {/* <span className=\"field-label\">you</span> */}\n                        {this.renderRelation(org)}\n                    </div>\n                    {this.renderRelationInfo(org)}\n\n                    {this.renderAdminInfo(org)}\n                </div>\n            </div>\n        )\n    }\n\n    renderOrgs() {\n        if (this.props.organizations.length > 0) {\n            return (\n                this.props.organizations.map((org: Organization, index) => {\n                    return (\n                        this.renderOrg(org, index)\n                    )\n                })\n            )\n        } else {\n            return (\n                <Alert type=\"warning\"\n                    style={{ maxWidth: '20em', margin: '20px auto 0 auto' }}\n                    message=\"Sorry, no organizations were found.\" />\n            )\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"Organizations\">\n                {this.renderOrgs()}\n            </div>\n        )\n    }\n}\n\nexport default Organizations;","import { Organizations, OrganizationsProps } from './Organizations';\nimport { StoreState } from '../../types';\nimport { connect } from 'react-redux';\n\nexport function mapStateToProps(state: StoreState): OrganizationsProps {\n    // TODO: wow, should not do this here\n    if (state.browseOrgs.view === null) {\n        throw new Error('view not ready')\n    }\n    const { browseOrgs: {\n        view: { organizations } } } = state;\n    return {\n        organizations\n    }\n}\n\nexport default connect(mapStateToProps)(Organizations);","import { ViewOrganizationState } from \"../components/viewOrganization/ViewOrganization\";\nimport { types, error } from \"util\";\nimport Organizations from \"../components/browseOrgs/OrganizationsContainer\";\n\n/* Types from the organization service (approximately) */\n\n/*\n    Organization\n*/\n\nexport interface OrganizationUpdate {\n    name: string\n    gravatarHash: string | null\n    description: string\n}\n\nexport enum UIErrorType {\n    NONE = 0,\n    INFO,\n    WARNING,\n    ERROR\n}\n\nexport interface UIError {\n    type: UIErrorType,\n    message?: string\n}\n\nexport interface EditableOrganization {\n    id: {\n        value: string,\n        status: FieldState,\n        error: UIError\n    }\n    name: {\n        value: string,\n        status: FieldState,\n        error: UIError\n    }\n    gravatarHash: {\n        value: string | null\n        status: FieldState\n        error: UIError\n    }\n    description: {\n        value: string,\n        status: FieldState,\n        error: UIError\n    }\n}\n\nexport interface User {\n    username: string\n    realname: string\n    title: string,\n    organization: string\n    city: string\n    state: string\n    country: string\n    avatarOption: string\n    gravatarHash: string\n    gravatarDefault: string\n}\n\nexport enum MemberType {\n    MEMBER = 0,\n    ADMIN,\n    OWNER\n}\nexport interface Member {\n    user: User,\n    type: MemberType\n}\n\n\n\n// export interface User extends UserBase {\n\n// }\n\n// export interface Owner extends UserBase {\n\n// }\n\n// export interface Member extends UserBase {\n\n// }\n\n// export interface Admin extends UserBase {\n\n// }\n\nexport enum UserRelationToOrganization {\n    NONE = 0,\n    VIEW,\n    MEMBER_REQUEST_PENDING,\n    MEMBER_INVITATION_PENDING,\n    MEMBER,\n    ADMIN,\n    OWNER\n}\n\nexport interface UserOrgRelation {\n    type: UserRelationToOrganization\n}\n\nexport interface NoRelation extends UserOrgRelation {\n    type: UserRelationToOrganization.NONE\n}\n\nexport interface ViewRelation extends UserOrgRelation {\n    type: UserRelationToOrganization.VIEW\n}\n\nexport interface MembershipRequestPendingRelation extends UserOrgRelation {\n    type: UserRelationToOrganization.MEMBER_REQUEST_PENDING,\n    requestId: string\n}\n\nexport interface MembershipInvitationPendingRelation extends UserOrgRelation {\n    type: UserRelationToOrganization.MEMBER_INVITATION_PENDING,\n    requestId: string\n}\n\nexport interface MemberRelation extends UserOrgRelation {\n    type: UserRelationToOrganization.MEMBER\n}\n\nexport interface AdminRelation extends UserOrgRelation {\n    type: UserRelationToOrganization.ADMIN\n}\n\nexport interface OwnerRelation extends UserOrgRelation {\n    type: UserRelationToOrganization.OWNER\n}\n\nexport interface BriefOrganization {\n    id: string\n    name: string\n    gravatarHash: string | null\n    owner: {\n        username: string\n        realname: string\n    },\n    relation: UserRelationToOrganization,\n    createdAt: Date\n    modifiedAt: Date\n}\n\nexport enum RequestType {\n    REQUEST = 0,\n    INVITATION\n}\n\nexport enum RequestResourceType {\n    USER = 0,\n    WORKSPACE,\n    APP\n}\n\nexport enum RequestStatus {\n    OPEN = 0,\n    CANCELED,\n    EXPIRED,\n    ACCEPTED,\n    DENIED\n}\n\nexport type Username = string\n\nexport interface GroupRequest {\n    id: string\n    groupId: string\n    requester: User\n    type: RequestType\n    status: RequestStatus\n    resourceType: RequestResourceType\n    // subjectUser: User | null,\n    // subjectWorkspaceId: number | null,\n    createdAt: Date\n    expireAt: Date\n    modifiedAt: Date\n}\n\nexport interface UserRequest extends GroupRequest {\n    resourceType: RequestResourceType.USER\n    type: RequestType.REQUEST\n    user: User\n}\n\nexport interface UserInvitation extends GroupRequest {\n    resourceType: RequestResourceType.USER\n    type: RequestType.INVITATION\n    user: User\n}\n\n\nexport interface WorkspaceRequest extends GroupRequest {\n    resourceType: RequestResourceType.WORKSPACE\n    type: RequestType.REQUEST\n    workspace: string\n}\n\nexport interface WorkspaceInvitation extends GroupRequest {\n    resourceType: RequestResourceType.WORKSPACE\n    type: RequestType.INVITATION\n    workspace: string\n}\n\nexport interface AppRequest extends GroupRequest {\n    resourceType: RequestResourceType.APP\n    type: RequestType.REQUEST\n    app: string\n}\n\nexport interface AppInvitation extends GroupRequest {\n    resourceType: RequestResourceType.APP\n    type: RequestType.INVITATION\n    app: string\n}\n\nexport interface Organization {\n    id: string\n    name: string\n    gravatarHash: string | null\n    description: string\n    owner: Member\n    relation: UserOrgRelation\n    createdAt: Date\n    modifiedAt: Date,\n    members: Array<Member>,\n    // admins: Array<Admin>,\n    adminRequests: Array<GroupRequest>\n}\n\nexport interface EditedOrganization {\n    id: {\n        value: string,\n        error?: UIError\n    }\n    name: {\n        value: string,\n        error?: UIError\n    }\n    description: {\n        value: string,\n        error?: UIError\n    }\n}\n\n/*\n    Collection of organizations\n*/\n\nexport type Organizations = Array<Organization>\n\n\n/* REDUX */\n\nexport enum AuthState {\n    NONE = 0,\n    CHECKING,\n    AUTHORIZED,\n    UNAUTHORIZED,\n    ERROR\n}\n\nexport interface UserAuthorization {\n    token: string,\n    username: string,\n    realname: string,\n    roles: Array<string>\n}\n\n\nexport interface Authorization {\n    status: AuthState,\n    message: string,\n    authorization: UserAuthorization\n}\n\n// export enum Filter {\n//     All = 1,\n//     Yours\n// }\n\n\nexport enum EditOrgState {\n    NONE = 0,\n    FETCHING,\n    READY,\n    EDITING_CAN_SAVE,\n    EDITING_ERRORS,\n    SAVING,\n    SAVED,\n    ERROR\n}\n\n// export enum AddOrgState {\n//     NONE = 0,\n//     READY,\n//     UNEDITED_OK,\n//     UNEDITED_\n//     EDITED_OK,\n//     EDITED_ERRORS,\n//     SAVING,\n//     SAVED,\n//     ERROR\n// }\n\nexport enum SyncState {\n    NONE = 'NONE',\n    NEW = 'NEW',\n    DIRTY = 'DIRTY',\n    CLEAN = 'CLEAN'\n}\n\nexport enum EditState {\n    NONE = 'NONE',\n    UNEDITED = 'UNEDITED',\n    EDITED = 'EDITED'\n}\n\n// TODO: or CLEAN to replace new and saved\nexport enum SaveState {\n    NONE = 'NONE',\n    NEW = 'NEW',\n    READY = 'READY',\n    SAVING = 'SAVING',\n    SAVED = 'SAVED',\n    SAVE_ERROR = 'SAVE_ERROR'\n}\n\nexport enum ValidationState {\n    NONE = 'NONE',\n    VALID = 'VALID',\n    INVALID = 'INVALID'\n}\n\nexport enum FieldState {\n    NONE = 0,\n    UNEDITED_OK,\n    UNEDITED_ERROR,\n    EDITED_OK,\n    EDITED_ERROR,\n    EDITED_WARNING\n}\n\nexport enum ViewOrgState {\n    NONE = 0,\n    INITIAL,\n    FETCHING,\n    READY,\n    ERROR\n}\n\nexport enum AppState {\n    NONE = 0,\n    LOADING,\n    READY,\n    ERROR\n}\n\nexport enum SortDirection {\n    ASCENDING = 'asc',\n    DESCENDING = 'desc'\n}\n\nexport enum ComponentLoadingState {\n    NONE = 0,\n    LOADING,\n    SUCCESS,\n    ERROR\n}\n\nexport interface ManageOrganizationRequestsValue {\n    organization: Organization\n    requests: Array<GroupRequest>\n}\nexport interface ManageOrganizationRequestsView {\n    state: ComponentLoadingState\n    viewState: ManageOrganizationRequestsValue | null\n    error: AppError | null\n}\nexport enum ViewMembersViewState {\n    NONE = 0,\n    LOADING,\n    SUCCESS,\n    ERROR\n}\n\nexport interface ViewMembersView {\n    state: ViewMembersViewState,\n    error: AppError | null,\n    view: {\n        organization: Organization\n    } | null\n}\n\nexport enum BrowseOrgsState {\n    NONE = 0,\n    SEARCHING,\n    SUCCESS,\n    ERROR\n}\n\nexport interface BrowseOrgsView {\n    state: BrowseOrgsState,\n    error: AppError | null,\n    view: {\n        rawOrganizations: Array<Organization>\n        organizations: Array<Organization>\n        totalCount: number\n        filteredCount: number\n        sortBy: string\n        sortDirection: SortDirection\n        filter: string\n        searchTerms: Array<string>\n        selectedOrganizationId: string | null,\n        searching: boolean\n    } | null\n}\n\nexport enum InviteUserState {\n    NONE = 0,\n    LOADING,\n    READY,\n    ERROR\n}\n\nexport interface BriefUser {\n    username: string\n    realname: string\n}\n\nexport interface InviteUserValue {\n    organization: Organization,\n    users: Array<BriefUser>\n    selectedUser: User | null\n}\n\nexport interface InviteUserView {\n    state: InviteUserState,\n    viewState: AppError | InviteUserValue | null\n}\n\nexport interface ManageMembershipValue {\n    organization: Organization\n}\n\nexport interface ManageMembershipView {\n    // state: ComponentLoadingState,\n    loading: boolean\n    error: AppError | null\n    value: ManageMembershipValue | null\n    // viewState: AppError | ManageMembershipValue | null\n}\n\nexport interface StoreState {\n    browseOrgs: BrowseOrgsView,\n\n    auth: Authorization\n    error: AppError | null\n\n    app: {\n        status: AppState\n        config: AppConfig\n        error?: AppError\n    }\n    addOrg: {\n        editState: EditState\n        saveState: SaveState\n        validationState: ValidationState\n        newOrganization: EditableOrganization\n        error?: AppError\n    }\n    updateOrg: {\n        pending: boolean\n    }\n    viewOrg: {\n        state: ViewOrgState\n        organization?: Organization\n        error?: AppError\n    }\n    editOrg: {\n        organizationId: string\n        editState: EditState\n        saveState: SaveState\n        validationState: ValidationState\n        editedOrganization: EditableOrganization\n        error?: AppError\n    }\n    manageOrganizationRequestsView: ManageOrganizationRequestsView\n    viewMembersView: ViewMembersView,\n    inviteUserView: InviteUserView,\n    manageMembershipView: ManageMembershipView\n}\n\n/* COMPONENT PROPS */\n\n\n\n\n// ADD ORG\n\n\n\n\n// export interface EditOrganizationProps {\n//     id: string,\n//     state: EditOrgState\n//     organization?: Organization\n//     editedOrganization?: EditedOrganization\n//     error?: AppError\n//     onEditOrg: (id: string) => void\n//     onUpdateOrg: () => void\n//     onUpdateName: (name: string) => void,\n//     onUpdateDescription: (description: string) => void\n// }\n\n\nexport interface AppError {\n    code: string,\n    message: string\n}\n\nexport interface AppConfig {\n    baseUrl: string,\n    services: {\n        Groups: {\n            url: string\n        },\n        UserProfile: {\n            url: string\n        },\n        Workspace: {\n            url: string\n        }\n    }\n}\n\nexport interface AuthProps {\n    authorization: Authorization,\n    // authStatus: AuthState,\n    // token: string | null,\n    // username: string | null,\n    // realname: string | null,\n    hosted: boolean,\n    checkAuth: () => void,\n    onRemoveAuthorization: () => void,\n    onAddAuthorization: (token: string) => void\n}\n\n","export enum ActionFlag {\n    APP = 1,\n    APP_START,\n    APP_SUCCESS,\n    // APP_SUCCESS_IFRAME,\n    // APP_SUCCESS_SOLO,\n    APP_ERROR,\n\n    SORT_ORGS,\n    SORT_ORGS_START,\n\n    FILTER_ORGS,\n    FILTER_ORGS_START,\n\n    SEARCH_ORGS,\n    SEARCH_ORGS_START,\n    SEARCH_ORGS_SUCCESS,\n    SEARCH_ORGS_ERROR,\n\n    UPDATE_ORG,\n    UPDATE_ORG_START,\n    UPDATE_ORG_SUCCESS,\n    UPDATE_ORG_ERROR,\n\n    // viewing org\n    VIEW_ORG_FETCH,\n    VIEW_ORG_FETCH_START,\n    VIEW_ORG_FETCH_SUCCESS,\n    VIEW_ORG_FETCH_ERROR,\n    VIEW_ORG_STOP,\n\n    // Joining and Such\n    VIEW_ORG_JOIN_REQUEST,\n    VIEW_ORG_JOIN_REQUEST_START,\n    VIEW_ORG_JOIN_REQUEST_SUCCESS,\n    VIEW_ORG_JOIN_REQUEST_ERROR,\n\n    VIEW_ORG_CANCEL_JOIN_REQUEST,\n    VIEW_ORG_CANCEL_JOIN_REQUEST_START,\n    VIEW_ORG_CANCEL_JOIN_REQUEST_SUCCESS,\n    VIEW_ORG_CANCEL_JOIN_REQUEST_ERROR,\n\n    VIEW_ORG_ACCEPT_JOIN_INVITATION,\n    VIEW_ORG_ACCEPT_JOIN_INVITATION_START,\n    VIEW_ORG_ACCEPT_JOIN_INVITATION_SUCCESS,\n    VIEW_ORG_ACCEPT_JOIN_INVITATION_ERROR,\n\n\n    VIEW_ORG_REJECT_JOIN_INVITATION,\n    VIEW_ORG_REJECT_JOIN_INVITATION_START,\n    VIEW_ORG_REJECT_JOIN_INVITATION_SUCCESS,\n    VIEW_ORG_REJECT_JOIN_INVITATION_ERROR,\n\n    // add org fields\n    ADD_ORG_EDIT,\n    ADD_ORG_EDIT_START,\n    ADD_ORG_EDIT_FINISH,\n\n    ADD_ORG_UPDATE_NAME,\n    ADD_ORG_UPDATE_NAME_SUCCESS,\n    ADD_ORG_UPDATE_NAME_ERROR,\n\n    ADD_ORG_UPDATE_GRAVATAR_HASH,\n    ADD_ORG_UPDATE_GRAVATAR_HASH_SUCCESS,\n    ADD_ORG_UPDATE_GRAVATAR_HASH_ERROR,\n\n    ADD_ORG_UPDATE_ID,\n    ADD_ORG_UPDATE_ID_SUCCESS,\n    ADD_ORG_UPDATE_ID_ERROR,\n\n    ADD_ORG_UPDATE_DESCRIPTION,\n    ADD_ORG_UPDATE_DESCRIPTION_SUCCESS,\n    ADD_ORG_UPDATE_DESCRIPTION_ERROR,\n\n    ADD_ORG_EVALUATE,\n    ADD_ORG_EVALUATE_OK,\n    ADD_ORG_EVALUATE_ERRORS,\n\n    ADD_ORG,\n    ADD_ORG_START,\n    ADD_ORG_SUCCESS,\n    ADD_ORG_ERROR,\n\n    // editing org\n    EDIT_ORG_EDIT,\n    EDIT_ORG_EDIT_START,\n    EDIT_ORG_EDIT_SUCCESS,\n    EDIT_ORG_EDIT_ERROR,\n\n    EDIT_ORG_SAVE,\n    EDIT_ORG_SAVE_START,\n    EDIT_ORG_SAVE_SUCCESS,\n    EDIT_ORG_SAVE_ERROR,\n\n    // edit org, field level updates\n    EDIT_ORG_UPDATE_NAME,\n    EDIT_ORG_UPDATE_NAME_SUCCESS,\n    EDIT_ORG_UPDATE_NAME_ERROR,\n\n    EDIT_ORG_UPDATE_GRAVATAR_HASH,\n    EDIT_ORG_UPDATE_GRAVATAR_HASH_SUCCESS,\n    EDIT_ORG_UPDATE_GRAVATAR_HASH_ERROR,\n\n    EDIT_ORG_UPDATE_DESCRIPTION,\n    EDIT_ORG_UPDATE_DESCRIPTION_SUCCESS,\n    EDIT_ORG_UPDATE_DESCRIPTION_ERROR,\n\n    EDIT_ORG_EVALUATE,\n    EDIT_ORG_EVALUATE_OK,\n    EDIT_ORG_EVALUATE_ERRORS,\n\n    // Auth\n    AUTH_CHECK,\n    AUTH_CHECK_START,\n    AUTH_CHECK_ERROR,\n    AUTH_AUTHORIZED,\n    AUTH_UNAUTHORIZED,\n    AUTH_REMOVE_AUTHORIZATION,\n    AUTH_ADD_AUTHORIZATION,\n    AUTH_ADD_AUTHORIZATION_ERROR,\n\n    ADMIN_MANAGE_REQUESTS,\n    ADMIN_MANAGE_REQUESTS_START,\n    ADMIN_MANAGE_REQUESTS_SUCCESS,\n    ADMIN_MANAGE_REQUESTS_ERROR,\n\n    ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST,\n    ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_START,\n    ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_SUCCESS,\n    ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_ERROR,\n\n    ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST,\n    ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_START,\n    ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_SUCCESS,\n    ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_ERROR,\n\n    // MEMBERS\n    VIEW_MEMBERS_LOAD,\n    VIEW_MEMBERS_LOAD_START,\n    VIEW_MEMBERS_LOAD_SUCCESS,\n    VIEW_MEMBERS_LOAD_ERROR,\n    VIEW_MEMBERS_UNLOAD,\n\n    VIEW_MEMBERS_REMOVE_MEMBER,\n    VIEW_MEMBERS_REMOVE_MEMBER_START,\n    VIEW_MEMBERS_REMOVE_MEMBER_SUCCESS,\n    VIEW_MEMBERS_REMOVE_MEMBER_ERROR,\n\n    VIEW_MEMBERS_PROMOTE_TO_ADMIN,\n    VIEW_MEMBERS_PROMOTE_TO_ADMIN_START,\n    VIEW_MEMBERS_PROMOTE_TO_ADMIN_SUCCESS,\n    VIEW_MEMBERS_PROMOTE_TO_ADMIN_ERROR,\n\n    VIEW_MEMBERS_DEMOTE_TO_MEMBER,\n    VIEW_MEMBERS_DEMOTE_TO_MEMBER_START,\n    VIEW_MEMBERS_DEMOTE_TO_MEMBER_SUCCESS,\n    VIEW_MEMBERS_DEMOTE_TO_MEMBER_ERROR,\n\n    // INVITE USER\n    INVITE_USER_LOAD,\n    INVITE_USER_LOAD_START,\n    INVITE_USER_LOAD_READY,\n    INVITE_USER_LOAD_ERROR,\n\n    INVITE_USER_SEARCH_USERS,\n    INVITE_USER_SEARCH_USERS_START,\n    INVITE_USER_SEARCH_USERS_SUCCESS,\n    INVITE_USER_SEARCH_USERS_ERROR,\n\n    INVITE_USER_SELECT_USER,\n    INVITE_USER_SELECT_USER_START,\n    INVITE_USER_SELECT_USER_SUCCESS,\n    INVITE_USER_SELECT_USER_ERROR,\n\n    INVITE_USER_SEND_INVITATION,\n    INVITE_USER_SEND_INVITATION_START,\n    INVITE_USER_SEND_INVITATION_SUCCESS,\n    INVITE_USER_SEND_INVITATION_ERROR,\n\n    // Manage Membership\n    MANAGE_MEMBERSHIP_LOAD,\n    MANAGE_MEMBERSHIP_LOAD_START,\n    MANAGE_MEMBERSHIP_LOAD_SUCCESS,\n    MANAGE_MEMBERSHIP_LOAD_ERROR\n}\n\n\n","import { Action } from 'redux'\nimport { StoreState, EditState, SaveState, UIErrorType, FieldState, ValidationState } from '../../types';\nimport { ActionFlag } from '../actions';\nimport {\n    AddOrgEditStart, AddOrgEditFinish,\n    AddOrgUpdateNameSuccess, AddOrgUpdateNameError,\n    AddOrgUpdateIdSuccess, AddOrgUpdateIdError,\n    AddOrgUpdateDescriptionSuccess, AddOrgUpdateDescriptionError,\n    AddOrgError, AddOrgStart, AddOrgSuccess, AddOrgEvaluateOK, AddOrgEvaluateErrors, AddOrgUpdateGravatarHashError, AddOrgUpdateGravatarHashSuccess\n} from '../actions/addOrg'\n\n// ADD ORG\n\nexport function addOrgStart(state: StoreState, action: AddOrgStart): StoreState {\n    return {\n        ...state,\n        addOrg: {\n            ...state.addOrg,\n            saveState: SaveState.SAVING\n        }\n    }\n}\n\nexport function addOrgSuccess(state: StoreState, action: AddOrgSuccess): StoreState {\n    return {\n        ...state,\n        addOrg: {\n            ...state.addOrg,\n            editState: EditState.UNEDITED,\n            saveState: SaveState.SAVED\n        }\n    }\n}\n\nexport function addOrgError(state: StoreState, action: AddOrgError): StoreState {\n    return {\n        ...state,\n        addOrg: {\n            ...state.addOrg,\n            saveState: SaveState.SAVE_ERROR,\n            error: action.error\n        }\n    }\n}\n\nexport function addOrgEvaluateOk(state: StoreState, action: AddOrgEvaluateOK): StoreState {\n    return {\n        ...state,\n        addOrg: {\n            ...state.addOrg,\n            validationState: ValidationState.VALID\n        }\n    }\n}\n\nexport function addOrgEvaluateErrors(state: StoreState, action: AddOrgEvaluateErrors): StoreState {\n    return {\n        ...state,\n        addOrg: {\n            ...state.addOrg,\n            validationState: ValidationState.INVALID\n        }\n    }\n}\n\nexport function addOrgEditStart(state: StoreState, action: AddOrgEditStart) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.UNEDITED,\n            validationState: ValidationState.NONE,\n            saveState: SaveState.NEW,\n            newOrganization: {\n                id: {\n                    value: '',\n                    status: FieldState.NONE,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                },\n                name: {\n                    value: '',\n                    status: FieldState.NONE,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                },\n                gravatarHash: {\n                    value: '',\n                    status: FieldState.NONE,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                },\n                description: {\n                    value: '',\n                    status: FieldState.NONE,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function addOrgEditFinish(state: StoreState, action: AddOrgEditFinish) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.UNEDITED\n        }\n    }\n}\n\n// Name\nexport function addOrgUpdateNameSuccess(state: StoreState, action: AddOrgUpdateNameSuccess) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.EDITED,\n            newOrganization: {\n                ...state.addOrg.newOrganization!,\n                name: {\n                    value: action.name,\n                    status: FieldState.EDITED_OK,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function addOrgUpdateNameError(state: StoreState, action: AddOrgUpdateNameError) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.EDITED,\n            newOrganization: {\n                ...state.addOrg.newOrganization!,\n                name: {\n                    value: action.name,\n                    status: FieldState.EDITED_ERROR,\n                    error: action.error\n                }\n            }\n        }\n    }\n}\n\n// Gravatar hash\nexport function addOrgUpdateGravatarHashSuccess(state: StoreState, action: AddOrgUpdateGravatarHashSuccess) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.EDITED,\n            newOrganization: {\n                ...state.addOrg.newOrganization!,\n                gravatarHash: {\n                    value: action.gravatarHash,\n                    status: FieldState.EDITED_OK,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function addOrgUpdateGravatarHashError(state: StoreState, action: AddOrgUpdateGravatarHashError) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.EDITED,\n            newOrganization: {\n                ...state.addOrg.newOrganization!,\n                gravatarHash: {\n                    value: action.gravatarHash,\n                    status: FieldState.EDITED_ERROR,\n                    error: action.error\n                }\n            }\n        }\n    }\n}\n\n// Id\n\nexport function addOrgUpdateIdSuccess(state: StoreState, action: AddOrgUpdateIdSuccess) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.EDITED,\n            newOrganization: {\n                ...state.addOrg.newOrganization!,\n                id: {\n                    value: action.id,\n                    status: FieldState.EDITED_OK,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function addOrgUpdateIdError(state: StoreState, action: AddOrgUpdateIdError) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.EDITED,\n            newOrganization: {\n                ...state.addOrg.newOrganization!,\n                id: {\n                    value: action.id,\n                    status: FieldState.EDITED_ERROR,\n                    error: action.error\n                }\n            }\n        }\n    }\n}\n\nexport function addOrgUpdateDescriptionSuccess(state: StoreState, action: AddOrgUpdateDescriptionSuccess) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.EDITED,\n            newOrganization: {\n                ...state.addOrg.newOrganization!,\n                description: {\n                    value: action.description,\n                    status: FieldState.EDITED_OK,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function addOrgUpdateDescriptionError(state: StoreState, action: AddOrgUpdateDescriptionError) {\n    return {\n        ...state, addOrg: {\n            ...state.addOrg,\n            editState: EditState.EDITED,\n            newOrganization: {\n                ...state.addOrg.newOrganization!,\n                description: {\n                    value: action.description,\n                    status: FieldState.EDITED_ERROR,\n                    error: action.error\n                }\n            }\n        }\n    }\n}\n\nexport function reducer(state: StoreState, action: Action): StoreState | null {\n    // NB using discriminant union nature of the ActionX types to narrow\n    // the type.\n\n    switch (action.type) {\n        case ActionFlag.ADD_ORG_START:\n            return addOrgStart(state, action as AddOrgStart)\n        case ActionFlag.ADD_ORG_SUCCESS:\n            return addOrgSuccess(state, action as AddOrgSuccess)\n        case ActionFlag.ADD_ORG_ERROR:\n            return addOrgError(state, action as AddOrgError)\n        case ActionFlag.ADD_ORG_EDIT_START:\n            return addOrgEditStart(state, action as AddOrgEditStart)\n        case ActionFlag.ADD_ORG_EDIT_FINISH:\n            return addOrgEditFinish(state, action as AddOrgEditFinish)\n        case ActionFlag.ADD_ORG_UPDATE_NAME_SUCCESS:\n            return addOrgUpdateNameSuccess(state, action as AddOrgUpdateNameSuccess)\n        case ActionFlag.ADD_ORG_UPDATE_NAME_ERROR:\n            return addOrgUpdateNameError(state, action as AddOrgUpdateNameError)\n\n        case ActionFlag.ADD_ORG_UPDATE_GRAVATAR_HASH_SUCCESS:\n            return addOrgUpdateGravatarHashSuccess(state, action as AddOrgUpdateGravatarHashSuccess)\n        case ActionFlag.ADD_ORG_UPDATE_GRAVATAR_HASH_ERROR:\n            return addOrgUpdateGravatarHashError(state, action as AddOrgUpdateGravatarHashError)\n\n        case ActionFlag.ADD_ORG_UPDATE_ID_SUCCESS:\n            return addOrgUpdateIdSuccess(state, action as AddOrgUpdateIdSuccess)\n        case ActionFlag.ADD_ORG_UPDATE_ID_ERROR:\n            return addOrgUpdateIdError(state, action as AddOrgUpdateIdError)\n        case ActionFlag.ADD_ORG_UPDATE_DESCRIPTION_SUCCESS:\n            return addOrgUpdateDescriptionSuccess(state, action as AddOrgUpdateDescriptionSuccess)\n        case ActionFlag.ADD_ORG_UPDATE_DESCRIPTION_ERROR:\n            return addOrgUpdateDescriptionError(state, action as AddOrgUpdateDescriptionError)\n        case ActionFlag.ADD_ORG_EVALUATE_OK:\n            return addOrgEvaluateOk(state, action as AddOrgEvaluateOK)\n        case ActionFlag.ADD_ORG_EVALUATE_ERRORS:\n            return addOrgEvaluateErrors(state, action as AddOrgEvaluateErrors)\n        default:\n            return null\n    }\n}\n\nexport default reducer","import { Action } from 'redux'\nimport { StoreState, EditState, SaveState, UIErrorType, FieldState, ValidationState } from '../../types';\nimport { ActionFlag } from '../actions';\nimport {\n    EditOrgEditStart, EditOrgEditSuccess, EditOrgEditError,\n    EditOrgEvaluateOK, EditOrgEvaluateErrors,\n    EditOrgSave, EditOrgSaveStart, EditOrgSaveError, EditOrgSaveSuccess,\n    EditOrgUpdateNameSuccess, EditOrgUpdateNameError,\n    // EditOrgUpdateIdSuccess, EditOrgUpdateIdError,\n    EditOrgUpdateDescriptionSuccess, EditOrgUpdateDescriptionError,\n    EditOrgUpdateGravatarHashError, EditOrgUpdateGravatarHashSuccess\n} from '../actions/editOrg'\n\n\n\n// EDIT ORG\n\n// Edit session loading\n\nexport function editOrgEditStart(state: StoreState, action: EditOrgEditStart) {\n    return {\n        ...state, editOrg: {\n            ...state.editOrg,\n            editState: EditState.UNEDITED,\n            validationState: ValidationState.NONE,\n            saveState: SaveState.NEW,\n            // TODO: get rid of this...\n            organizationId: action.id,\n            editedOrganization: {\n                id: {\n                    value: '',\n                    status: FieldState.NONE,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                },\n                name: {\n                    value: '',\n                    status: FieldState.NONE,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                },\n                gravatarHash: {\n                    value: '',\n                    status: FieldState.NONE,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                },\n                description: {\n                    value: '',\n                    status: FieldState.NONE,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function editOrgEditSuccess(state: StoreState, action: EditOrgEditSuccess) {\n    return {\n        ...state, editOrg: {\n            ...state.editOrg,\n            editedOrganization: action.editedOrganization,\n            editState: EditState.UNEDITED\n        }\n    }\n}\n\n// save\n\nexport function editOrgSaveStart(state: StoreState, action: EditOrgSaveStart): StoreState {\n    return {\n        ...state,\n        editOrg: {\n            ...state.editOrg,\n            saveState: SaveState.SAVING\n        }\n    }\n}\n\nexport function editOrgSaveSuccess(state: StoreState, action: EditOrgSaveSuccess): StoreState {\n    return {\n        ...state,\n        editOrg: {\n            ...state.editOrg,\n            editState: EditState.UNEDITED,\n            saveState: SaveState.SAVED\n        }\n    }\n}\n\nexport function editOrgSaveError(state: StoreState, action: EditOrgSaveError): StoreState {\n    return {\n        ...state,\n        editOrg: {\n            ...state.editOrg,\n            saveState: SaveState.SAVE_ERROR,\n            error: action.error\n        }\n    }\n}\n\n// Evaluate edit session\n\nexport function editOrgEvaluateOk(state: StoreState, action: EditOrgEvaluateOK): StoreState {\n    return {\n        ...state,\n        editOrg: {\n            ...state.editOrg,\n            validationState: ValidationState.VALID\n        }\n    }\n}\n\nexport function editOrgEvaluateErrors(state: StoreState, action: EditOrgEvaluateErrors): StoreState {\n    return {\n        ...state,\n        editOrg: {\n            ...state.editOrg,\n            validationState: ValidationState.INVALID\n        }\n    }\n}\n\n\n\n// Name\nexport function editOrgUpdateNameSuccess(state: StoreState, action: EditOrgUpdateNameSuccess) {\n    return {\n        ...state, editOrg: {\n            ...state.editOrg,\n            editState: EditState.EDITED,\n            editedOrganization: {\n                ...state.editOrg.editedOrganization,\n                name: {\n                    value: action.name,\n                    status: FieldState.EDITED_OK,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function editOrgUpdateNameError(state: StoreState, action: EditOrgUpdateNameError) {\n    return {\n        ...state, editOrg: {\n            ...state.editOrg,\n            editState: EditState.EDITED,\n            editedOrganization: {\n                ...state.editOrg.editedOrganization,\n                name: {\n                    value: action.name,\n                    status: FieldState.EDITED_ERROR,\n                    error: action.error\n                }\n            }\n        }\n    }\n}\n\n// Gravatar hash\nexport function editOrgUpdateGravatarHashSuccess(state: StoreState, action: EditOrgUpdateGravatarHashSuccess) {\n    return {\n        ...state, editOrg: {\n            ...state.editOrg,\n            editState: EditState.EDITED,\n            editedOrganization: {\n                ...state.editOrg.editedOrganization,\n                gravatarHash: {\n                    value: action.gravatarHash,\n                    status: FieldState.EDITED_OK,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function editOrgUpdateGravatarHashError(state: StoreState, action: EditOrgUpdateGravatarHashError) {\n    return {\n        ...state, editOrg: {\n            ...state.editOrg,\n            editState: EditState.EDITED,\n            editedOrganization: {\n                ...state.editOrg.editedOrganization,\n                gravatarHash: {\n                    value: action.gravatarHash,\n                    status: FieldState.EDITED_ERROR,\n                    error: action.error\n                }\n            }\n        }\n    }\n}\n\n// Id\n\n// export function editOrgUpdateIdSuccess(state: StoreState, action: EditOrgUpdateIdSuccess) {\n//     return {\n//         ...state, editOrg: {\n//             ...state.editOrg,\n//             editState: EditState.EDITED,\n//             editedOrganization: {\n//                 ...state.editOrg.editedOrganization!,\n//                 id: {\n//                     value: action.id,\n//                     status: FieldState.EDITED_OK,\n//                     error: {\n//                         type: UIErrorType.NONE\n//                     }\n//                 }\n//             }\n//         }\n//     }\n// }\n\n// export function editOrgUpdateIdError(state: StoreState, action: EditOrgUpdateIdError) {\n//     return {\n//         ...state, editOrg: {\n//             ...state.editOrg,\n//             editState: EditState.EDITED,\n//             editedOrganization: {\n//                 ...state.editOrg.editedOrganization!,\n//                 id: {\n//                     value: action.id,\n//                     status: FieldState.EDITED_ERROR,\n//                     error: action.error\n//                 }\n//             }\n//         }\n//     }\n// }\n\nexport function editOrgUpdateDescriptionSuccess(state: StoreState, action: EditOrgUpdateDescriptionSuccess) {\n    return {\n        ...state, editOrg: {\n            ...state.editOrg,\n            editState: EditState.EDITED,\n            editedOrganization: {\n                ...state.editOrg.editedOrganization,\n                description: {\n                    value: action.description,\n                    status: FieldState.EDITED_OK,\n                    error: {\n                        type: UIErrorType.NONE\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function editOrgUpdateDescriptionError(state: StoreState, action: EditOrgUpdateDescriptionError) {\n    return {\n        ...state, editOrg: {\n            ...state.editOrg,\n            editState: EditState.EDITED,\n            editedOrganization: {\n                ...state.editOrg.editedOrganization,\n                description: {\n                    value: action.description,\n                    status: FieldState.EDITED_ERROR,\n                    error: action.error\n                }\n            }\n        }\n    }\n}\n\nexport function reducer(state: StoreState, action: Action): StoreState | null {\n    // NB using discriminant union nature of the ActionX types to narrow\n    // the type.\n\n    switch (action.type) {\n        case ActionFlag.EDIT_ORG_EDIT_START:\n            return editOrgEditStart(state, action as EditOrgEditStart)\n        case ActionFlag.EDIT_ORG_EDIT_SUCCESS:\n            return editOrgEditSuccess(state, action as EditOrgEditSuccess)\n        case ActionFlag.EDIT_ORG_SAVE_START:\n            return editOrgSaveStart(state, action as EditOrgSaveStart)\n        case ActionFlag.EDIT_ORG_SAVE_SUCCESS:\n            return editOrgSaveSuccess(state, action as EditOrgSaveSuccess)\n        case ActionFlag.EDIT_ORG_SAVE_ERROR:\n            return editOrgSaveError(state, action as EditOrgSaveError)\n\n        case ActionFlag.EDIT_ORG_UPDATE_NAME_SUCCESS:\n            return editOrgUpdateNameSuccess(state, action as EditOrgUpdateNameSuccess)\n        case ActionFlag.EDIT_ORG_UPDATE_NAME_ERROR:\n            return editOrgUpdateNameError(state, action as EditOrgUpdateNameError)\n\n        case ActionFlag.EDIT_ORG_UPDATE_GRAVATAR_HASH_SUCCESS:\n            return editOrgUpdateGravatarHashSuccess(state, action as EditOrgUpdateGravatarHashSuccess)\n        case ActionFlag.EDIT_ORG_UPDATE_GRAVATAR_HASH_ERROR:\n            return editOrgUpdateGravatarHashError(state, action as EditOrgUpdateGravatarHashError)\n\n        // case ActionFlag.EDIT_ORG_UPDATE_ID_SUCCESS:\n        //     return editOrgUpdateIdSuccess(state, action as EditOrgUpdateIdSuccess)\n        // case ActionFlag.EDIT_ORG_UPDATE_ID_ERROR:\n        //     return editOrgUpdateIdError(state, action as EditOrgUpdateIdError)\n        case ActionFlag.EDIT_ORG_UPDATE_DESCRIPTION_SUCCESS:\n            return editOrgUpdateDescriptionSuccess(state, action as EditOrgUpdateDescriptionSuccess)\n        case ActionFlag.EDIT_ORG_UPDATE_DESCRIPTION_ERROR:\n            return editOrgUpdateDescriptionError(state, action as EditOrgUpdateDescriptionError)\n        case ActionFlag.EDIT_ORG_EVALUATE_OK:\n            return editOrgEvaluateOk(state, action as EditOrgEvaluateOK)\n        case ActionFlag.EDIT_ORG_EVALUATE_ERRORS:\n            return editOrgEvaluateErrors(state, action as EditOrgEvaluateErrors)\n        default:\n            return null\n    }\n}\n\nexport default reducer","import { Action } from 'redux'\nimport * as actions from '../actions/viewOrg'\nimport * as types from '../../types'\nimport { ActionFlag } from '../actions'\n\nexport function viewOrgStart(state: types.StoreState,\n    action: actions.ViewOrgStart): types.StoreState {\n    return {\n        ...state,\n        viewOrg: { ...state.viewOrg, state: types.ViewOrgState.FETCHING }\n    }\n}\n\nexport function viewOrgSuccess(state: types.StoreState,\n    action: actions.ViewOrgSuccess): types.StoreState {\n    return {\n        ...state,\n        viewOrg: {\n            ...state.viewOrg,\n            state: types.ViewOrgState.READY,\n            organization: action.organization\n        }\n    }\n}\n\nexport function viewOrgError(state: types.StoreState,\n    action: actions.ViewOrgError): types.StoreState {\n    return {\n        ...state,\n        viewOrg: {\n            ...state.viewOrg,\n            state: types.ViewOrgState.ERROR,\n            error: action.error\n        }\n    }\n}\n\nexport function viewOrgStop(state: types.StoreState, action: actions.ViewOrgStop): types.StoreState {\n    return {\n        ...state,\n        viewOrg: {\n            state: types.ViewOrgState.NONE\n        }\n    }\n}\n\n\nfunction reducer(state: types.StoreState, action: Action): types.StoreState | null {\n    // NB using discriminant union nature of the ActionX types to narrow\n    // the type.\n\n    switch (action.type) {\n        case ActionFlag.VIEW_ORG_FETCH_START:\n            return viewOrgStart(state, action as actions.ViewOrgStart)\n        case ActionFlag.VIEW_ORG_FETCH_SUCCESS:\n            return viewOrgSuccess(state, action as actions.ViewOrgSuccess)\n        case ActionFlag.VIEW_ORG_FETCH_ERROR:\n            return viewOrgError(state, action as actions.ViewOrgError)\n        case ActionFlag.VIEW_ORG_STOP:\n            return viewOrgStop(state, action as actions.ViewOrgStop)\n        default:\n            return null\n    }\n}\nexport default reducer","import { Action } from 'redux'\nimport * as actions from '../actions/searchOrgs'\nimport * as types from '../../types'\nimport { ActionFlag } from '../actions'\nimport { Organizations, Organization } from '../../types'\nimport { Model } from '../../data/model'\n\nexport function applyOrgSearch(orgs: Organizations, searchTerms: Array<string>) {\n    const filteredOrgs = orgs.filter((org) => {\n        if (searchTerms.length === 0) {\n            return true;\n        }\n        return searchTerms.every((term) => {\n            // todo : make more efficient!!!\n            return (new RegExp(term, 'i').test(org.name));\n        })\n    })\n\n    return {\n        organizations: filteredOrgs,\n        totalCount: orgs.length,\n        filteredCount: filteredOrgs.length\n    }\n}\n\n// TODO:\n// dispatch the start of the request\n// do the request\n// dispatch the success (will be same for all queries?)\n// dispatch the error\n// FOR NOW:\n// do it here...\nexport function searchOrgsStart(state: types.StoreState, action: actions.SearchOrgsStart): types.StoreState {\n    if (state.browseOrgs.view === null) {\n        console.warn('Cannot start browseOrgs view')\n        return state\n    }\n    const { browseOrgs: { view: { filter, sortBy, sortDirection } } } = state\n    const query: Query = {\n        searchTerms: action.searchTerms,\n        filter: filter,\n        sortBy: sortBy,\n        sortDirection: sortDirection,\n        username: state.auth.authorization.username\n    }\n    // const result = queryOrgs(state.rawOrganizations, query)\n    // rawOrganizations: Array<Organization>\n    // organizations: Array<Organization>\n    // totalCount: number\n    // filteredCount: number\n    // sortBy: string\n    // sortDirection: SortDirection\n    // filter: string\n    // searchTerms: Array<string>\n    // selectedOrganizationId: string | null\n    return {\n        ...state,\n        // organizations: result.organizations, \n        // totalCount: result.total, \n        // filteredCount: result.organizations.length,\n        browseOrgs: {\n            ...state.browseOrgs,\n            state: types.BrowseOrgsState.SEARCHING,\n            error: null,\n            view: {\n                ...state.browseOrgs.view,\n                selectedOrganizationId: null,\n                searchTerms: action.searchTerms\n            }\n        }\n    }\n}\n\nexport function searchOrgsSuccess(state: types.StoreState, action: actions.SearchOrgsSuccess): types.StoreState {\n    if (state.browseOrgs.view === null) {\n        console.warn('Cannot start browseOrgs view')\n        return state\n    }\n    return {\n        ...state,\n        browseOrgs: {\n            ...state.browseOrgs,\n            state: types.BrowseOrgsState.SUCCESS,\n            error: null,\n            view: {\n                ...state.browseOrgs.view,\n                organizations: action.organizations,\n                totalCount: action.totalCount,\n                filteredCount: action.organizations.length\n            }\n        }\n    }\n}\n\n// TODO: hmm, uses the global error -- this was early in the development of this (a whole two weeks ago!)\n// and this should now go in the \"browseOrgs\" (or better named \"searchOrgs\") branch.\nexport function searchOrgsError(state: types.StoreState, action: actions.SearchOrgsError): types.StoreState {\n    console.log('error action', action)\n    if (state.browseOrgs.view) {\n        return {\n            ...state,\n            browseOrgs: {\n                ...state.browseOrgs,\n                error: action.error,\n                state: types.BrowseOrgsState.ERROR,\n                view: {\n                    ...state.browseOrgs.view,\n                    searching: false\n                }\n            }\n        }\n    } else {\n        return {\n            ...state,\n            browseOrgs: {\n                ...state.browseOrgs,\n                error: action.error\n            }\n        }\n    }\n}\n\n\nexport function sortOrgsStart(state: types.StoreState, action: actions.SortOrgsStart): types.StoreState {\n    if (state.browseOrgs.view === null) {\n        console.warn('Cannot start browseOrgs view')\n        return state\n    }\n    const {\n        browseOrgs: { view: { searchTerms, filter } },\n        auth: { authorization: { username } }\n    } = state\n    const query: Query = {\n        searchTerms: searchTerms,\n        filter: filter,\n        sortBy: action.sortBy,\n        sortDirection: action.sortDirection,\n        username: username\n    }\n\n    return {\n        ...state,\n        browseOrgs: {\n            ...state.browseOrgs,\n            state: types.BrowseOrgsState.SEARCHING,\n            error: null,\n            view: {\n                ...state.browseOrgs.view,\n                sortBy: action.sortBy,\n                sortDirection: action.sortDirection\n            }\n        }\n    }\n}\n\n\ninterface Query {\n    searchTerms: Array<string>,\n    username: string,\n    sortBy: string,\n    sortDirection: types.SortDirection,\n    filter: string\n}\n\ninterface QueryResults {\n    organizations: Organizations,\n    total: number\n}\n\nexport function filterOrgsStart(state: types.StoreState,\n    action: actions.FilterOrgsStart): types.StoreState {\n    if (state.browseOrgs.view === null) {\n        console.warn('Cannot start browseOrgs view')\n        return state\n    }\n    const { filter } = action\n\n    return {\n        ...state,\n        browseOrgs: {\n            ...state.browseOrgs,\n            state: types.BrowseOrgsState.SEARCHING,\n            error: null,\n            view: {\n                ...state.browseOrgs.view,\n                filter\n            }\n        }\n    }\n}\n\n\nfunction reducer(state: types.StoreState, action: Action): types.StoreState | null {\n    // NB using discriminant union nature of the ActionX types to narrow\n    // the type.\n\n    switch (action.type) {\n        case ActionFlag.SEARCH_ORGS_START:\n            return searchOrgsStart(state, action as actions.SearchOrgsStart)\n        case ActionFlag.SEARCH_ORGS_SUCCESS:\n            return searchOrgsSuccess(state, action as actions.SearchOrgsSuccess)\n        case ActionFlag.SEARCH_ORGS_ERROR:\n            return searchOrgsError(state, action as actions.SearchOrgsError)\n        // case ActionFlag.SORT_ORGS_STAR:\n        //     return sortOrgs(state, action as actions.SortOrgs)\n        case ActionFlag.SORT_ORGS_START:\n            return sortOrgsStart(state, action as actions.SortOrgsStart)\n        case ActionFlag.FILTER_ORGS_START:\n            return filterOrgsStart(state, action as actions.FilterOrgsStart)\n        default:\n            return null\n    }\n}\n\nexport default reducer","import { Action } from 'redux'\n\nimport { ActionFlag } from '../actions'\nimport { StoreState, AuthState } from '../../types'\nimport { AuthCheckStart, AuthAuthorized, AuthUnauthorized, AuthCheckError } from '../actions/auth';\n\nexport function authCheckStart(state: StoreState, action: AuthCheckStart): StoreState {\n    return {\n        ...state,\n        auth: {\n            status: AuthState.CHECKING,\n            message: '',\n            authorization: {\n                token: '',\n                username: '',\n                realname: '',\n                roles: []\n            }\n        }\n    }\n}\n\nexport function authCheckError(state: StoreState, action: AuthCheckError): StoreState {\n    return {\n        ...state,\n        auth: {\n            status: AuthState.ERROR,\n            message: action.error.message,\n            authorization: {\n                token: '',\n                username: '',\n                realname: '',\n                roles: []\n            }\n        }\n    }\n}\n\nexport function authAuthorized(state: StoreState, action: AuthAuthorized): StoreState {\n    return {\n        ...state,\n        auth: {\n            status: AuthState.AUTHORIZED,\n            message: '',\n            authorization: {\n                token: action.token,\n                username: action.username,\n                realname: action.realname,\n                roles: action.roles\n            }\n        }\n    }\n}\n\nexport function authUnauthorized(state: StoreState, action: AuthUnauthorized): StoreState {\n    return {\n        ...state,\n        auth: {\n            status: AuthState.UNAUTHORIZED,\n            message: '',\n            authorization: {\n                token: '',\n                username: '',\n                realname: '',\n                roles: []\n            }\n        }\n    }\n}\n\nfunction reducer(state: StoreState, action: Action): StoreState | null {\n    switch (action.type) {\n        case ActionFlag.AUTH_CHECK_START:\n            return authCheckStart(state, action as AuthCheckStart)\n        case ActionFlag.AUTH_AUTHORIZED:\n            return authAuthorized(state, action as AuthAuthorized)\n        case ActionFlag.AUTH_UNAUTHORIZED:\n            return authUnauthorized(state, action as AuthUnauthorized)\n        case ActionFlag.AUTH_CHECK_ERROR:\n            return authCheckError(state, action as AuthCheckError)\n        default:\n            return null\n    }\n}\n\nexport default reducer","import { Action } from 'redux'\nimport { ActionFlag } from '../actions'\nimport { AppSuccess } from '../actions/app';\nimport { StoreState, AppState } from '../../types';\n\nexport function appSuccess(state: StoreState, action: AppSuccess): StoreState {\n    return {\n        ...state,\n        app: {\n            status: AppState.READY,\n            config: action.config\n        }\n    }\n}\n\nfunction reducer(state: StoreState, action: Action): StoreState | null {\n    switch (action.type) {\n        case ActionFlag.APP_SUCCESS:\n            return appSuccess(state, action as AppSuccess)\n        default:\n            return null\n    }\n}\n\nexport default reducer","import { Action } from 'redux'\nimport * as actions from '../actions/manageOrganizationRequests'\nimport * as types from '../../types'\nimport { ActionFlag } from '../actions'\n\nexport function manageOrganizationRequestsStart(\n    state: types.StoreState,\n    action: actions.ManageOrganizationRequestsStart): types.StoreState {\n    return state\n}\n\nexport function manageOrganizationRequestsSuccess(\n    state: types.StoreState,\n    action: actions.ManageOrganizationRequestsSuccess): types.StoreState {\n    return {\n        ...state,\n        manageOrganizationRequestsView: {\n            viewState: {\n                organization: action.organization,\n                requests: action.requests,\n            },\n            // TODO: wtf\n            state: types.ComponentLoadingState.SUCCESS,\n            error: null\n        }\n    }\n}\n\nexport function manageOrganizationRequestsError(\n    state: types.StoreState,\n    action: actions.ManageOrganizationRequestsError): types.StoreState {\n    return {\n        ...state,\n        manageOrganizationRequestsView: {\n            viewState: null,\n            state: types.ComponentLoadingState.ERROR,\n            error: action.error\n        }\n    }\n}\n\n\nfunction reducer(state: types.StoreState, action: Action): types.StoreState | null {\n    switch (action.type) {\n        case ActionFlag.ADMIN_MANAGE_REQUESTS_START:\n            return manageOrganizationRequestsStart(state, action as actions.ManageOrganizationRequestsStart)\n        case ActionFlag.ADMIN_MANAGE_REQUESTS_SUCCESS:\n            return manageOrganizationRequestsSuccess(state, action as actions.ManageOrganizationRequestsSuccess)\n        case ActionFlag.ADMIN_MANAGE_REQUESTS_ERROR:\n            return manageOrganizationRequestsError(state, action as actions.ManageOrganizationRequestsError)\n        default:\n            return null\n    }\n}\n\nexport default reducer","import { Action } from 'redux'\nimport * as actions from '../actions/viewMembers'\nimport * as types from '../../types'\nimport { ActionFlag } from '../actions'\n\nexport function viewMembersLoadStart(state: types.StoreState, action: actions.ViewMembersLoadStart) {\n    return {\n        ...state,\n        viewMembersView: {\n            ...state.viewMembersView,\n            state: types.ViewMembersViewState.LOADING,\n            view: null,\n            error: null\n        }\n    }\n}\n\nexport function viewMembersUnload(state: types.StoreState, action: actions.ViewMembersUnload) {\n    return {\n        ...state,\n        viewMembersView: {\n            ...state.viewMembersView,\n            state: types.ViewMembersViewState.NONE,\n            view: null,\n            error: null\n        }\n    }\n}\n\nexport function viewMembersLoadSuccess(state: types.StoreState, action: actions.ViewMembersLoadSuccess) {\n    return {\n        ...state,\n        viewMembersView: {\n            ...state.viewMembersView,\n            state: types.ViewMembersViewState.SUCCESS,\n            view: {\n                organization: action.organization\n            },\n            error: null\n        }\n    }\n}\n\nexport function viewMembersLoadError(state: types.StoreState, action: actions.ViewMembersLoadError) {\n    return {\n        ...state,\n        viewMembersView: {\n            ...state.viewMembersView,\n            state: types.ViewMembersViewState.ERROR,\n            view: null,\n            error: action.error\n        }\n    }\n}\n\nexport function viewMembersPromoteToAdminSuccess(state: types.StoreState, action: actions.ViewMembersPromoteToAdminSuccess): types.StoreState {\n\n    if (state.viewMembersView.view === null) {\n        return state\n    }\n\n    // TODO: probably better is to have to have the action handler do a call to get the members\n    // and to populate the orgs membership struct from that...\n    const members = state.viewMembersView.view.organization.members.map((member) => {\n        if (member.user.username === action.memberUsername) {\n            member.type = types.MemberType.ADMIN\n            return member\n        } else {\n            return member\n        }\n    })\n\n    const newState = { ...state }\n    newState.viewMembersView.view!.organization.members = members\n    console.log('new state', newState)\n    return newState\n\n    // return {\n    //     ...state,\n    //     viewMembersView: {\n    //         ...state.viewMembersView,\n    //         view: {\n    //             ...state.viewMembersView.view,\n    //             organization: {\n    //                 ...state.viewMembersView.view.organization,\n    //                 members: members\n    //             }\n    //         }\n    //     }\n    // }\n}\n\nexport function viewMembersDemoteToMemberSuccess(state: types.StoreState, action: actions.ViewMembersDemoteToMemberSuccess): types.StoreState {\n\n    if (state.viewMembersView.view === null) {\n        return state\n    }\n\n    // TODO: probably better is to have to have the action handler do a call to get the members\n    // and to populate the orgs membership struct from that...\n    const members = state.viewMembersView.view.organization.members.map((member) => {\n        if (member.user.username === action.memberUsername) {\n            member.type = types.MemberType.MEMBER\n            return member\n        } else {\n            return member\n        }\n    })\n\n    const newState = { ...state }\n    newState.viewMembersView.view!.organization.members = members\n    console.log('new state', newState)\n    return newState\n}\n\nfunction reducer(state: types.StoreState, action: Action): types.StoreState | null {\n    // NB using discriminant union nature of the ActionX types to narrow\n    // the type.\n\n    switch (action.type) {\n        case ActionFlag.VIEW_MEMBERS_LOAD_START:\n            return viewMembersLoadStart(state, action as actions.ViewMembersLoadStart)\n        case ActionFlag.VIEW_MEMBERS_LOAD_SUCCESS:\n            return viewMembersLoadSuccess(state, action as actions.ViewMembersLoadSuccess)\n        case ActionFlag.VIEW_MEMBERS_LOAD_ERROR:\n            return viewMembersLoadError(state, action as actions.ViewMembersLoadError)\n        case ActionFlag.VIEW_MEMBERS_UNLOAD:\n            return viewMembersUnload(state, action as actions.ViewMembersUnload)\n        case ActionFlag.VIEW_MEMBERS_PROMOTE_TO_ADMIN_SUCCESS:\n            return viewMembersPromoteToAdminSuccess(state, action as actions.ViewMembersPromoteToAdminSuccess)\n        case ActionFlag.VIEW_MEMBERS_DEMOTE_TO_MEMBER_SUCCESS:\n            return viewMembersDemoteToMemberSuccess(state, action as actions.ViewMembersDemoteToMemberSuccess)\n        default:\n            return null\n    }\n}\n\nexport default reducer","import { Action } from 'redux'\nimport * as actions from '../actions/inviteUser'\nimport * as types from '../../types'\nimport { ActionFlag } from '../actions'\n\nexport function inviteUserLoadStart(state: types.StoreState, action: actions.InviteUserLoadStart): types.StoreState {\n    return {\n        ...state,\n        inviteUserView: {\n            ...state.inviteUserView,\n            state: types.InviteUserState.LOADING\n        }\n    }\n}\n\nexport function inviteUserLoadReady(state: types.StoreState, action: actions.InviteUserLoadReady): types.StoreState {\n    return {\n        ...state,\n        inviteUserView: {\n            ...state.inviteUserView,\n            state: types.InviteUserState.READY,\n            viewState: {\n                users: [],\n                organization: action.organization,\n                selectedUser: null\n            }\n        }\n    }\n}\n\nexport function inviteUserLoadError(state: types.StoreState, action: actions.InviteUserLoadError): types.StoreState {\n    return {\n        ...state,\n        inviteUserView: {\n            ...state.inviteUserView,\n            state: types.InviteUserState.ERROR,\n            viewState: action.error\n        }\n    }\n}\n\nexport function searchUsersSuccess(state: types.StoreState, action: actions.SearchUsersSuccess): types.StoreState {\n    return {\n        ...state,\n        inviteUserView: {\n            ...state.inviteUserView,\n            viewState: {\n                ...state.inviteUserView.viewState as types.InviteUserValue,\n                users: action.users\n            }\n        }\n    }\n}\n\nexport function selectUserSuccess(state: types.StoreState, action: actions.SelectUserSuccess): types.StoreState {\n    return {\n        ...state,\n        inviteUserView: {\n            ...state.inviteUserView,\n            viewState: {\n                ...state.inviteUserView.viewState as types.InviteUserValue,\n                selectedUser: action.user\n            }\n        }\n    }\n}\n\n\nfunction reducer(state: types.StoreState, action: Action): types.StoreState | null {\n    switch (action.type) {\n        case ActionFlag.INVITE_USER_LOAD_START:\n            return inviteUserLoadStart(state, action as actions.InviteUserLoadStart)\n        case ActionFlag.INVITE_USER_LOAD_READY:\n            return inviteUserLoadReady(state, action as actions.InviteUserLoadReady)\n        case ActionFlag.INVITE_USER_LOAD_ERROR:\n            return inviteUserLoadError(state, action as actions.InviteUserLoadError)\n        case ActionFlag.INVITE_USER_SEARCH_USERS_SUCCESS:\n            return searchUsersSuccess(state, action as actions.SearchUsersSuccess)\n        case ActionFlag.INVITE_USER_SELECT_USER_SUCCESS:\n            return selectUserSuccess(state, action as actions.SelectUserSuccess)\n        default:\n            return null\n    }\n}\n\nexport default reducer","import { Action } from 'redux'\nimport * as actions from '../actions/manageMembership'\nimport * as types from '../../types'\nimport { ActionFlag } from '../actions'\n\nexport function manageMembershipLoadStart(state: types.StoreState, action: actions.LoadStart): types.StoreState {\n    console.log('start')\n    return {\n        ...state,\n        manageMembershipView: {\n            loading: true,\n            error: null,\n            value: null\n        }\n    }\n}\n\nexport function manageMembershipLoadSuccess(state: types.StoreState, action: actions.LoadSuccess): types.StoreState {\n    console.log('success')\n    return {\n        ...state,\n        manageMembershipView: {\n            loading: false,\n            error: null,\n            value: {\n                organization: action.organization\n            }\n        }\n    }\n}\n\nexport function manageMembershipLoadError(state: types.StoreState, action: actions.LoadError): types.StoreState {\n    console.log('error')\n    return {\n        ...state,\n        manageMembershipView: {\n            loading: false,\n            error: action.error,\n            value: null\n        }\n    }\n}\n\nfunction reducer(state: types.StoreState, action: Action): types.StoreState | null {\n    switch (action.type) {\n        case ActionFlag.MANAGE_MEMBERSHIP_LOAD_START:\n            return manageMembershipLoadStart(state, action as actions.LoadStart)\n        case ActionFlag.MANAGE_MEMBERSHIP_LOAD_SUCCESS:\n            return manageMembershipLoadSuccess(state, action as actions.LoadSuccess)\n        case ActionFlag.MANAGE_MEMBERSHIP_LOAD_ERROR:\n            return manageMembershipLoadError(state, action as actions.LoadError)\n        default:\n            return null\n    }\n}\n\nexport default reducer","import { Action } from 'redux'\nimport { StoreState } from '../../types'\nimport addOrgReducer from './addOrg'\nimport editOrgReducer from './editOrg'\nimport viewOrgReducer from './viewOrg'\nimport searchOrgsReducer from './searchOrgs'\nimport authReducer from './auth'\nimport appReducer from './app'\nimport manageOrganizatiopRequests from './manageOrganizationRequests';\nimport viewMembers from './viewMembers';\nimport inviteUser from './inviteUser';\nimport manageMembership from './manageMembership'\n\n\nexport function reducer(state: StoreState, action: Action): StoreState {\n    return addOrgReducer(state, action) ||\n        editOrgReducer(state, action) ||\n        searchOrgsReducer(state, action) ||\n        viewOrgReducer(state, action) ||\n        authReducer(state, action) ||\n        appReducer(state, action) ||\n        manageOrganizatiopRequests(state, action) ||\n        viewMembers(state, action) ||\n        inviteUser(state, action) ||\n        manageMembership(state, action) ||\n        state;\n}\n\nexport default reducer","import { string, number } from \"prop-types\";\n\nexport interface GroupsServiceInfo {\n    servname: string;\n    version: string;\n    servertime: number;\n    gitcommithash: string\n}\n\nexport interface BriefGroup {\n    id: string;\n    name: string;\n    custom: {\n        gravatarhash?: string\n    }\n    owner: string;\n    type: string;\n    // createdAt: number;\n    // modifiedAt: number\n}\n\nexport type GroupList = Array<BriefGroup>\n\nexport type Username = string;\n\nexport interface WorkspaceInfo {\n    wsid: number\n    name: string\n    narrname: string\n    public: boolean\n    admin: boolean\n}\n\nexport interface Group {\n    id: string\n    name: string\n    owner: Username\n    type: string\n    admins: Array<Username>\n    members: Array<Username>\n    description: string\n    createdate: number\n    moddate: number\n    workspaces: Array<WorkspaceInfo>\n    custom: {\n        gravatarhash?: string\n    }\n}\n\nexport interface NewGroup {\n    id: string\n    name: string\n    gravatarhash: string | null\n    type: string\n    description: string\n}\n\nexport interface GroupUpdate {\n    name: string\n    gravatarhash: string | null\n    description: string\n}\n\nexport interface Request {\n    id: string\n    groupid: string\n    requester: Username\n    type: string\n    status: string\n    resource: string\n    resourcetype: string\n    createdate: number\n    expiredate: number\n    moddate: number\n}\n\nexport interface ErrorInfo {\n    appcode: number\n    apperror: string\n    callid: string\n    httpcode: number\n    httpstatus: string\n    message: string\n    time: number\n}\n\nexport interface ErrorResult {\n    error: ErrorInfo\n}\n\n// Error types: (appcode)\n// 10000\tAuthentication failed\n// 10010\tNo authentication token\n// 10020\tInvalid token\n// 20000\tUnauthorized\n// 30000\tMissing input parameter\n// 30001\tIllegal input parameter\n// 30010\tIllegal user name\n// 40000\tGroup already exists\n// 40010\tRequest already exists\n// 40020\tUser already group member\n// 40030\tWorkspace already in group\n// 50000\tNo such group\n// 50010\tNo such request\n// 50020\tNo such user\n// 50030\tNo such workspace\n// 60000\tUnsupported operation\n\nexport interface GroupExists {\n    exists: boolean\n}\n\n// export interface GroupRequest {\n//     id: string,\n//     groupid: string,\n//     requester: Username,\n//     type: string,\n//     status: string,\n//     resource: string\n//     resourcetype: string\n//     createdate: number,\n//     expiredate: number,\n//     moddate: number\n// }\n\nexport enum SortDirection {\n    ASCENDING = 0,\n    DESCENDING\n}\n\nexport interface GetRequestsParams {\n    includeClosed?: boolean,\n    sortDirection?: SortDirection,\n    startAt?: Date\n}\n\nexport interface RequestMemebershipParams {\n    groupId: string\n}\n\nexport class GroupsClient {\n    token: string;\n    url: string;\n\n    constructor({ token, url }: { token: string, url: string }) {\n        this.token = token\n        this.url = url\n    }\n\n    getInfo(): Promise<GroupsServiceInfo> {\n        return fetch(this.url + '/', {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json'\n            },\n            mode: 'cors'\n        })\n            .then((response) => {\n                return response.json();\n            })\n            .then((result) => {\n                return result as GroupsServiceInfo;\n            });\n    }\n\n    groupExists(id: string): Promise<GroupExists> {\n        return fetch(this.url + '/group/' + id + '/exists')\n            .then((response) => {\n                return response.json()\n            })\n            .then((exists) => {\n                return exists as GroupExists\n            })\n    }\n\n    // getGroups(): Promise<GroupList> {\n    //     return fetch(this.url + '/group', {\n    //         headers: {\n    //             Authorization: this.token,\n    //             Accept: 'application/json'\n    //         },\n    //         mode: 'cors'\n    //     })\n    //         .then((response) => {\n    //             return response.json()\n    //         })\n    //         .then((result: GroupList) => {\n    //             return result.filter(({ type }) => type === 'Organization')\n    //         })\n    // }\n\n\n    getGroups(): Promise<Array<Group>> {\n        let start = new Date().getTime()\n        return fetch(this.url + '/group', {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json'\n            },\n            mode: 'cors'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    console.error('error fetching groups', response)\n                    throw new Error('Error fetching groups')\n                }\n                return response.json()\n            })\n            .then((result: GroupList) => {\n                const orgs = result.filter(({ type }) => type === 'Organization')\n                return Promise.all(orgs.map((group) => (this.getGroupById(group.id))))\n            })\n            .then((result) => {\n                return result;\n            })\n    }\n\n    getGroupById(id: string): Promise<Group> {\n        return fetch(this.url + '/group/' + id, {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json'\n            },\n            mode: 'cors'\n        })\n            .then((response) => {\n                if (response.status === 404) {\n                    return null\n                }\n                return response.json()\n            })\n            .then((result) => {\n                console.log('got group', result)\n                return result as Group\n            })\n    }\n\n    createGroup(newGroup: NewGroup): Promise<Group> {\n        return fetch(this.url + '/group/' + newGroup.id, {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            mode: 'cors',\n            method: 'PUT',\n            body: JSON.stringify({\n                name: newGroup.name,\n                custom: {\n                    gravatarhash: newGroup.gravatarhash\n                },\n                type: newGroup.type,\n                description: newGroup.description\n            })\n        })\n            .then((response) => {\n                return response.json()\n            })\n            .then((result) => {\n                return result as Group\n            })\n    }\n\n    updateGroup(id: string, groupUpdate: GroupUpdate): Promise<void> {\n        return fetch(this.url + '/group/' + id + '/update', {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            mode: 'cors',\n            method: 'PUT',\n\n            // TODO: build more intelligently\n            body: JSON.stringify({\n                name: groupUpdate.name,\n                custom: {\n                    gravatarhash: groupUpdate.gravatarhash\n                },\n                type: 'Organization',\n                description: groupUpdate.description\n            })\n        })\n            .then((response) => {\n                // response is an empty body.\n                if (response.status === 204) {\n                    return\n                }\n                throw new Error('Unexpected response: ' + response.status + ' : ' + response.statusText)\n            })\n    }\n\n    getGroupRequests(groupId: string, params: GetRequestsParams): Promise<Array<Request>> {\n        const query = new URLSearchParams()\n        if (params.includeClosed) {\n            query.append('closed', 'closed')\n        }\n        if (params.sortDirection) {\n            if (params.sortDirection === SortDirection.DESCENDING) {\n                query.append('order', 'desc')\n            } else {\n                query.append('order', 'asc')\n            }\n        }\n        if (params.startAt) {\n            query.append('excludeupto', String(params.startAt.getTime()))\n        }\n        return fetch(this.url + '/group/' + groupId + '/requests?' + params.toString(), {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            mode: 'cors',\n            method: 'GET'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('Unexpected response: ' + response.status + ' : ' + response.statusText)\n                }\n                return response.json()\n            })\n    }\n\n    getTargetedRequests(params: GetRequestsParams): Promise<Array<Request>> {\n        const query = new URLSearchParams()\n        if (params.includeClosed) {\n            query.append('closed', 'closed')\n        }\n        if (params.sortDirection) {\n            if (params.sortDirection === SortDirection.DESCENDING) {\n                query.append('order', 'desc')\n            } else {\n                query.append('order', 'asc')\n            }\n        }\n        if (params.startAt) {\n            query.append('excludeupto', String(params.startAt.getTime()))\n        }\n        return fetch(this.url + '/request/targeted?' + params.toString(), {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            mode: 'cors',\n            method: 'GET'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('Unexpected response: ' + response.status + ' : ' + response.statusText)\n                }\n                return response.json()\n            })\n    }\n    getCreatedRequests(params: GetRequestsParams): Promise<Array<Request>> {\n        const query = new URLSearchParams()\n        if (params.includeClosed) {\n            query.append('closed', 'closed')\n        }\n        if (params.sortDirection) {\n            if (params.sortDirection === SortDirection.DESCENDING) {\n                query.append('order', 'desc')\n            } else {\n                query.append('order', 'asc')\n            }\n        }\n        if (params.startAt) {\n            query.append('excludeupto', String(params.startAt.getTime()))\n        }\n        return fetch(this.url + '/request/created?' + params.toString(), {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json',\n                'Content-Type': 'appcliation/json'\n            },\n            mode: 'cors',\n            method: 'GET'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('Unexpected response: ' + response.status + ' : ' + response.statusText)\n                }\n                return response.json()\n            })\n    }\n\n    requestMembership(params: RequestMemebershipParams): Promise<Request> {\n        return fetch(this.url + '/group/' + params.groupId + '/requestmembership', {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json',\n                'Content-Type': 'application/json',\n            },\n            mode: 'cors',\n            method: 'POST'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('Unexpected response: ' + response.status + ' : ' + response.statusText)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                return result as Request\n            })\n    }\n\n    cancelRequest({ requestId }: { requestId: string }): Promise<Request> {\n        return fetch(this.url + '/request/id/' + requestId + '/cancel', {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            mode: 'cors',\n            method: 'PUT'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('Unexpected response: ' + response.status)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                return result as Request\n            })\n    }\n\n    acceptRequest({ requestId }: { requestId: string }): Promise<Request> {\n        return fetch(this.url + '/request/id/' + requestId + '/accept', {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            mode: 'cors',\n            method: 'PUT'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('Unexpected response: ' + response.status)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                return result as Request\n            })\n    }\n\n    denyRequest({ requestId }: { requestId: string }): Promise<Request> {\n        return fetch(this.url + '/request/id/' + requestId + '/deny', {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            mode: 'cors',\n            method: 'PUT'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('Unexpected response: ' + response.status)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                return result as Request\n            })\n    }\n\n    memberToAdmin({ groupId, member }: { groupId: string, member: string }): Promise<void> {\n        const url = [\n            this.url, 'group', groupId, 'user', member, 'admin'\n        ].join('/')\n        return fetch(url, {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json'\n            },\n            mode: 'cors',\n            method: 'PUT'\n        })\n            .then((response) => {\n                if (response.status !== 204) {\n                    throw new Error('Unexpected response: ' + response.status + ':' + response.statusText)\n                }\n\n            })\n    }\n\n    adminToMember({ groupId, member }: { groupId: string, member: string }): Promise<void> {\n        const url = [\n            this.url, 'group', groupId, 'user', member, 'admin'\n        ].join('/')\n        return fetch(url, {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json'\n            },\n            mode: 'cors',\n            method: 'DELETE'\n        })\n            .then((response) => {\n                if (response.status !== 204) {\n                    throw new Error('Unexpected response: ' + response.status + ':' + response.statusText)\n                }\n\n            })\n    }\n\n    removeMember({ groupId, member }: { groupId: string, member: string }): Promise<void> {\n        const url = [\n            this.url, 'group', groupId, 'user', member\n        ].join('/')\n        return fetch(url, {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json'\n            },\n            mode: 'cors',\n            method: 'DELETE'\n        })\n            .then((response) => {\n                if (response.status !== 204) {\n                    throw new Error('Unexpected response: ' + response.status + ':' + response.statusText)\n                }\n\n            })\n    }\n\n    requestJoinGroup({ groupId, username }: { groupId: string, username: string }): Promise<Request> {\n        const url = [\n            this.url, 'group', groupId, 'user', username\n        ].join('/')\n        return fetch(url, {\n            headers: {\n                Authorization: this.token,\n                Accept: 'application/json'\n            },\n            mode: 'cors',\n            method: 'POST'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('Unexpected response: ' + response.status + ':' + response.statusText)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                return result as Request\n            })\n    }\n}","import * as React from 'react'\nimport { NavLink } from 'react-router-dom'\nimport './Header.css'\nimport { FaUsers, FaChevronRight } from 'react-icons/fa'\n\nexport interface HeaderProps {\n}\n\nclass Header extends React.Component<HeaderProps, object> {\n\n    buildSeparator() {\n        if (this.props.children) {\n            return (\n                <FaChevronRight style={{ verticalAlign: 'middle', marginLeft: '4px', marginRight: '4px' }} />\n            )\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"Header\">\n                <div style={{ flex: '0 0 auto' }}>\n                    <NavLink to=\"/organizations\">\n                        <FaUsers style={{ verticalAlign: 'middle' }} />\n                        {' '}\n                        <span data-test=\"orgs-label\">Orgs</span>\n                    </NavLink>\n                </div>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    {this.buildSeparator()}\n                    {this.props.children}\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Header;","import * as React from 'react';\nimport { NavLink } from 'react-router-dom'\n\nimport Organizations from './OrganizationsContainer';\nimport { SortDirection, AppError } from '../../types';\n\nimport './OrganizationsBrowser.css';\nimport { Button, Icon, Radio, Select, Modal, Alert } from 'antd'\nimport Header from '../Header';\nimport { RadioChangeEvent } from 'antd/lib/radio';\n\nexport interface OrganizationsBrowserProps {\n    totalCount: number;\n    filteredCount: number;\n    sortBy: string;\n    sortDirection: SortDirection;\n    filter: string;\n    searching: boolean;\n    error: AppError | null;\n    onSearchOrgs: (searchTerms: Array<string>) => void;\n    onSortOrgs: (sortBy: string, sortDirection: SortDirection) => void;\n    onFilterOrgs: (filter: string) => void;\n}\n\nexport interface OrganizationsBrowserState {\n    searchInput: string\n    showInfo: boolean\n}\nclass OrganizationsBrowser extends React.Component<OrganizationsBrowserProps, OrganizationsBrowserState> {\n\n    searchInput: React.RefObject<HTMLInputElement>;\n    searchButton: React.RefObject<Button>;\n\n    constructor(props: OrganizationsBrowserProps) {\n        super(props)\n\n        this.searchInput = React.createRef()\n        this.searchButton = React.createRef()\n\n        this.state = {\n            searchInput: '',\n            showInfo: false\n        }\n\n        this.props.onSearchOrgs([])\n    }\n\n    onShowInfo() {\n        Modal.info({\n            title: 'Organizations Browser Help',\n            width: '50em',\n            content: (\n                <div>\n                    <p>This is the organizations browser...</p>\n                </div>\n            )\n        })\n    }\n\n    doSearch() {\n        if (this.searchInput.current === null) {\n            return\n        }\n        const searchTerms = this.searchInput.current.value.split(/[\\s+]/)\n        // dispatch the search event\n        this.props.onSearchOrgs(searchTerms);\n    }\n\n    haveSearchInput() {\n        if (this.state.searchInput && this.state.searchInput.length > 0) {\n            return true\n        }\n        return false\n    }\n\n    onSearchInputChange() {\n        let currentSearchInputValue;\n        if (this.searchInput.current) {\n            currentSearchInputValue = this.searchInput.current.value\n        } else {\n            currentSearchInputValue = ''\n        }\n        this.setState({ searchInput: currentSearchInputValue })\n    }\n\n    onSubmit(e: React.FormEvent<HTMLFormElement>) {\n        e.preventDefault()\n        this.doSearch()\n    }\n\n    onSortByChange(e: RadioChangeEvent) {\n        this.props.onSortOrgs(e.target.value, this.props.sortDirection)\n    }\n\n    onSortByChange2(value: string) {\n        this.props.onSortOrgs(value, this.props.sortDirection)\n    }\n\n\n    onSortDirectionChange(e: RadioChangeEvent) {\n        this.props.onSortOrgs(this.props.sortBy, e.target.value)\n    }\n\n    onSortDirectionChange2(value: string) {\n        this.props.onSortOrgs(this.props.sortBy, value as SortDirection)\n    }\n\n    onFilterChange(e: RadioChangeEvent) {\n        this.props.onFilterOrgs(e.target.value)\n    }\n\n    onFilterChange2(value: string) {\n        this.props.onFilterOrgs(value)\n    }\n\n    onClearSearch() {\n        if (this.searchInput.current === null) {\n            return\n        }\n        this.searchInput.current.value = ''\n        this.onSearchInputChange()\n        // this.searchButton.current!.handleClick(new MouseEvent<HTMLButtonElement>('click'))\n        // const event = new Event('change', { bubbles: true })\n        // this.searchInput.current.dispatchEvent(event)\n        this.doSearch()\n    }\n\n    renderSearchFeedback() {\n        if (this.props.totalCount === 0) {\n            return (\n                <span>\n                    No organizations in the system\n                </span>\n            )\n        }\n        if (this.props.filteredCount === 0) {\n            return (\n                <span>\n                    No organizations found out of\n                    {' '}\n                    {this.props.totalCount}\n                    {' '}\n                    available.\n                </span>\n            )\n\n        }\n        if (this.props.totalCount === this.props.filteredCount) {\n            return (\n                <span>\n                    Showing all\n                {' '}\n                    {this.props.totalCount}\n                    {' '}\n                    organizations\n                </span>\n            )\n        }\n\n        return (\n            <span>\n                Showing\n                {' '}\n                {this.props.filteredCount}\n                {' '}\n                out of\n                {' '}\n                {this.props.totalCount}\n                {' '}\n                organizations\n            </span>\n        )\n    }\n\n    renderSearchIcon() {\n        if (this.props.searching) {\n            return (<Icon type=\"loading\" />)\n        }\n        return (<Icon type=\"search\" />)\n    }\n\n    renderSearchBar() {\n        return (\n            <form id=\"searchForm\" className=\"OrganizationsBrowser-searchBar\" onSubmit={this.onSubmit.bind(this)}>\n                <input\n                    placeholder=\"Search Organizations\"\n                    onChange={this.onSearchInputChange.bind(this)}\n                    autoFocus\n                    ref={this.searchInput}></input>\n                {/* <Tooltip\n                    title=\"Enter one or more words to search organizations by name or owner\">\n                    <Icon type=\"info-circle\" theme=\"twoTone\" style={{ alignSelf: 'end' }} />\n                </Tooltip> */}\n                <Button\n                    disabled={!this.haveSearchInput()}\n                    ref={this.searchButton}\n                    form=\"searchForm\"\n                    key=\"submit\"\n                    htmlType=\"submit\">\n                    {this.renderSearchIcon()}\n                    {/* Search */}\n                </Button>\n                <Button\n                    onClick={this.onClearSearch.bind(this)}\n                    disabled={!this.haveSearchInput()}\n                    icon=\"close\"\n                >\n\n                    {/* Show all */}\n                </Button>\n                {/* <div className=\"message\">\n                    {this.renderSearchFeedback()}\n                </div> */}\n            </form>\n        )\n    }\n\n    renderHeader() {\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            Browse and Search Organizations\n                        </span>\n                        <Icon type=\"right\" style={{ margin: '0 4px' }} />\n                        <span style={{ fontWeight: 'normal', fontStyle: 'italic' }}>\n                            {this.renderSearchFeedback()}\n                        </span>\n                    </div>\n                    <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', justifyContent: 'flex-end' }}>\n                        <NavLink to=\"/newOrganization\"><Button icon=\"plus-circle\">Create Organization</Button></NavLink>\n                        <Button shape=\"circle\" icon=\"info\" onClick={this.onShowInfo.bind(this)}></Button>\n                    </div>\n\n                </div>\n            </Header>\n        )\n    }\n\n    renderSearchFilter() {\n        return (\n            <div>\n                <span className=\"field-label\">sort by</span>\n                <Select onChange={this.onSortByChange2.bind(this)}\n                    defaultValue={this.props.sortBy}\n                    style={{ width: '8em' }}\n                    dropdownMatchSelectWidth={true}>\n                    <Select.Option value=\"name\" key=\"name\">Org name</Select.Option>\n                    <Select.Option value=\"owner\" key=\"owner\">Owner</Select.Option>\n                    <Select.Option value=\"created\" key=\"created\">Date created</Select.Option>\n                </Select>\n                <Select onChange={this.onSortDirectionChange2.bind(this)}\n                    style={{ width: '10em' }}\n                    dropdownMatchSelectWidth={true}\n                    defaultValue={this.props.sortDirection}>\n                    <Select.Option value={SortDirection.ASCENDING} key=\"name\"><Icon type=\"sort-ascending\" />Ascending</Select.Option>\n                    <Select.Option value={SortDirection.DESCENDING} key=\"owner\"><Icon type=\"sort-descending\" />Descending</Select.Option>\n                </Select>\n                <span className=\"field-label\" style={{ marginLeft: '10px' }}>filter</span>\n                <Select onChange={this.onFilterChange2.bind(this)}\n                    defaultValue={this.props.filter}\n                    style={{ width: '16em' }}\n                    dropdownMatchSelectWidth={true}>\n                    <Select.Option value=\"all\" key=\"all\">All</Select.Option>\n                    <Select.Option value=\"memberOf\" key=\"memberOf\">You are a member of</Select.Option>\n                    <Select.Option value=\"owned\" key=\"owned\">Owned by you</Select.Option>\n                    <Select.Option value=\"notOwned\" key=\"notOwned\">Not owned by you</Select.Option>\n                    <Select.Option value=\"pending\" key=\"pending\">Pending request or invitation</Select.Option>\n                    <Select.Option value=\"groupPending\" key=\"groupPending\">Pending group requests</Select.Option>\n                </Select>\n            </div>\n        )\n    }\n\n    renderOrganizations() {\n        console.log('props...', this.props)\n        if (this.props.error) {\n            return (\n                <Alert\n                    type=\"error\"\n                    message={this.props.error.code}\n                    description={this.props.error.message} />\n            )\n        } else {\n            return (\n                <Organizations />\n            )\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"OrganizationsBrowser\">\n                {this.renderHeader()}\n                <div className=\"searchBarRow\">\n                    <div className=\"searchBarCol\">\n                        {this.renderSearchBar()}\n                    </div>\n                    <div className=\"sortCol\">\n                        {this.renderSearchFilter()}\n                    </div>\n                </div>\n                <div className=\"bodyRow\">\n\n                    <div className=\"col2\">\n                        {this.renderOrganizations()}\n                    </div>\n                    {/* <div className=\"col1\">\n                        {this.renderControlArea()}\n                    </div> */}\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default OrganizationsBrowser","export interface User {\n    username: string,\n    realname: string,\n    thumbnail: string\n}\n\nexport interface UserProfile {\n    user: User,\n    profile: {\n        synced: {\n            gravatarHash: string\n        },\n        userdata: {\n            jobTitle: string,\n            jobTitleOther: string,\n            organization: string\n            city: string\n            state: string\n            country: string\n            avatarOption: string\n            gravatarDefault: string\n        }\n    }\n}\n\nexport interface JSONPayload {\n    version: string,\n    method: string,\n    id: string,\n    params: any\n}\n\nexport class UserProfileClient {\n    url: string;\n    token: string\n\n    constructor({ url, token }: { url: string, token: string }) {\n        this.url = url\n        this.token = token\n    }\n\n    makePayload(method: string, param: any): JSONPayload {\n        return {\n            version: '1.1',\n            method: 'UserProfile.' + method,\n            id: String(Math.random()).slice(2),\n            params: [param]\n        }\n    }\n\n    makeEmptyPayload(method: string): JSONPayload {\n        return {\n            version: '1.1',\n            method: 'UserProfile.' + method,\n            id: String(Math.random()).slice(2),\n            params: []\n        }\n    }\n\n    getVersion(): Promise<any> {\n        return fetch(this.url, {\n            method: 'POST',\n            mode: 'cors',\n            cache: 'no-store',\n            headers: {\n                Authorization: this.token,\n                'Content-Type': 'application/json',\n                Accept: 'application/json'\n            },\n            body: JSON.stringify(this.makeEmptyPayload('version'))\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('User profile request error: ' + response.status + ', ' + response.statusText)\n                }\n                return response.json()\n            })\n    }\n\n    getUserProfile(username: string): Promise<UserProfile> {\n        return fetch(this.url, {\n            method: 'POST',\n            mode: 'cors',\n            cache: 'no-store',\n            headers: {\n                Authorization: this.token,\n                'Content-Type': 'application/json',\n                Accept: 'application/json'\n            },\n            body: JSON.stringify(this.makePayload('get_user_profile', [username]))\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('User profile request error: ' + response.status + ', ' + response.statusText)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                return result.result[0][0] as UserProfile\n            })\n    }\n\n    getUserProfiles(usernames: Array<string>): Promise<Array<UserProfile>> {\n        return fetch(this.url, {\n            method: 'POST',\n            mode: 'cors',\n            cache: 'no-store',\n            headers: {\n                Authorization: this.token,\n                'Content-Type': 'application/json',\n                Accept: 'application/json'\n            },\n            body: JSON.stringify(this.makePayload('get_user_profile', usernames))\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('User profile request error: ' + response.status + ', ' + response.statusText)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                console.log('profiles', result.result[0])\n                return result.result[0] as Array<UserProfile>\n            })\n    }\n\n    getAllUsers(): Promise<Array<User>> {\n        return fetch(this.url, {\n            method: 'POST',\n            mode: 'cors',\n            cache: 'no-store',\n            headers: {\n                Authorization: this.token,\n                'Content-Type': 'application/json',\n                Accept: 'application/json'\n            },\n            body: JSON.stringify(this.makePayload('filter_users', { filter: '' }))\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('User profile request error: ' + response.status + ', ' + response.statusText)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                console.log('profiles', result.result[0])\n                return result.result[0] as Array<User>\n            })\n    }\n\n    searchUsers(query: string): Promise<Array<User>> {\n        let start = new Date()\n        return fetch(this.url, {\n            method: 'POST',\n            mode: 'cors',\n            cache: 'no-store',\n            headers: {\n                Authorization: this.token,\n                'Content-Type': 'application/json',\n                Accept: 'application/json'\n            },\n            body: JSON.stringify(this.makePayload('filter_users', { filter: query }))\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error('User profile request error: ' + response.status + ', ' + response.statusText)\n                }\n                console.log('user profile 1', new Date().getTime() - start.getTime())\n                start = new Date()\n                return response.json()\n            })\n            .then((result) => {\n                console.log('user profile 2', new Date().getTime() - start.getTime())\n                return result.result[0] as Array<User>\n            })\n    }\n}","import {\n    Organization, OrganizationUpdate,\n    UIError,\n    UIErrorType,\n    SortDirection,\n    FieldState,\n    EditableOrganization,\n    UserRelationToOrganization,\n    User,\n    Member,\n    GroupRequest,\n    RequestType,\n    RequestStatus,\n    OwnerRelation,\n    UserOrgRelation,\n    AdminRelation,\n    MemberRelation,\n    MembershipRequestPendingRelation,\n    MembershipInvitationPendingRelation,\n    ViewRelation,\n    MemberType,\n    BriefUser,\n    UserRequest,\n    RequestResourceType,\n    WorkspaceRequest,\n    AppRequest,\n    UserInvitation,\n    WorkspaceInvitation,\n    AppInvitation\n} from '../types';\n// import { organizations } from './data';\nimport * as userProfile from './userProfile'\nimport { GroupsClient, Group } from './groups'\nimport * as groups from './groups'\n\nfunction stringToRequestType(type: string): RequestType {\n    switch (type) {\n        case 'Invite':\n            return RequestType.INVITATION\n        case 'Request':\n            return RequestType.REQUEST\n        default:\n            throw new Error('unknown request type: ' + type)\n    }\n}\n\nfunction stringToResourceType(type: string) {\n    switch (type) {\n        case 'user':\n            return RequestResourceType.USER\n        case 'workspace':\n            return RequestResourceType.WORKSPACE\n        case 'catalogmethod':\n            return RequestResourceType.APP\n        default:\n            throw new Error('unknown resource type: ' + type)\n    }\n}\n\nfunction stringToRequestStatus(status: string): RequestStatus {\n    return RequestStatus.OPEN\n}\n\nexport function applyOrgSearch(orgs: Array<Organization>, searchTerms: Array<string>): Array<Organization> {\n    const searchTermsRe = searchTerms.map((term) => {\n        return new RegExp(term, 'i')\n    })\n    const filteredOrgs = orgs.filter((org) => {\n        if (searchTerms.length === 0) {\n            return true;\n        }\n        return searchTermsRe.every((termRe) => {\n            return termRe.test(org.name) ||\n                termRe.test(org.owner.user.username) ||\n                termRe.test(org.owner.user.realname)\n        })\n    })\n\n    return filteredOrgs\n}\n\nfunction applySort(organizations: Array<Organization>, sortBy: string, sortDirection: SortDirection): Array<Organization> {\n    const direction = sortDirection === SortDirection.ASCENDING ? 1 : -1\n    switch (sortBy) {\n        case 'created':\n            return organizations.slice().sort((a, b) => {\n                return direction * (a.createdAt.getTime() - b.createdAt.getTime())\n            })\n        // case 'modifiedAt':\n        //     return organizations.slice().sort((a, b) => {\n        //         return direction * (a.modifiedAt.getTime() - b.modifiedAt.getTime())\n        //     })\n        case 'name':\n            return organizations.slice().sort((a, b) => {\n                return direction * a.name.localeCompare(b.name)\n            })\n        case 'owner':\n            return organizations.slice().sort((a, b) => {\n                return direction * a.owner.user.username.localeCompare(b.owner.user.username)\n            })\n        default:\n            console.warn('unimplemented sort field: ' + sortBy)\n            return organizations;\n    }\n}\n\nfunction applyFilter(organizations: Array<Organization>, filter: string, username: string): Array<Organization> {\n    switch (filter) {\n        case 'all':\n            return organizations\n        case 'memberOf':\n            return organizations.filter((org) => (\n                (org.members.findIndex((member) => (member.user.username === username)) >= 0)\n            ))\n        case 'owned':\n            return organizations.filter((org) => (org.owner.user.username === username))\n        case 'notOwned':\n            return organizations.filter((org) => (org.owner.user.username !== username))\n        case 'pending':\n            return organizations.filter((org) => (\n                org.relation.type === UserRelationToOrganization.MEMBER_INVITATION_PENDING ||\n                org.relation.type === UserRelationToOrganization.MEMBER_REQUEST_PENDING\n            ))\n        case 'groupPending':\n            return organizations.filter((org) => (\n                (org.relation.type === UserRelationToOrganization.ADMIN ||\n                    org.relation.type === UserRelationToOrganization.OWNER) &&\n                (org.adminRequests && org.adminRequests.length > 0)\n            ))\n        default:\n            console.warn('unknown filter : ' + filter)\n            return organizations\n    }\n}\n\nexport interface Query {\n    searchTerms: Array<string>\n    username: string\n    sortBy: string\n    sortDirection: SortDirection\n    filter: string\n}\n\nexport interface QueryResults {\n    organizations: Array<Organization>\n    total: number\n}\n\nfunction wait(timeout: number) {\n    return new Promise((resolve) => {\n        window.setTimeout(() => {\n            resolve(true)\n        }, timeout)\n    })\n}\n\n// export function newOrg(state: StoreState, action: actions.AddOrg): StoreState {\n//     const {organizations, auth:{username}} = state;\n//     const org: Organization = {\n//         ...action.newOrg,\n//         createdAt: new Date(),\n//         modifiedAt: new Date(),\n//         owner: username\n//     }\n//     organizations.push(org)\n//     return {...state, organizations}\n// }\n\ninterface ModelParams {\n    token: string,\n    username: string,\n    groupsServiceURL: string,\n    userProfileServiceURL: string,\n    workspaceServiceURL: string\n}\n\nfunction promiseTry<T>(fun: () => Promise<T>) {\n    return new Promise<T>((resolve, reject) => {\n        try {\n            return resolve(fun())\n        } catch (ex) {\n            reject(ex)\n        }\n    })\n}\n\nexport class Model {\n    // organizations: Organizations\n    // token: string\n    // groupsServiceURL: string\n    // userProfileServiceURL: string\n    // workspaceServiceURL: string\n    params: ModelParams\n    cachedOrgs: Array<Organization> | null\n\n\n    constructor(params: ModelParams) {\n        // this.organizations = organizations;\n        this.params = params\n        this.cachedOrgs = null\n    }\n\n    getPendingRequests(): Promise<{ requests: Array<groups.Request>, invitations: Array<groups.Request> }> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return Promise.all([\n            groupsClient.getCreatedRequests({\n                includeClosed: false,\n                sortDirection: groups.SortDirection.DESCENDING,\n                startAt: new Date(0)\n            })\n                .then((requests) => {\n                    return requests\n                }),\n            groupsClient.getTargetedRequests({\n                includeClosed: false,\n                sortDirection: groups.SortDirection.DESCENDING,\n                startAt: new Date(0)\n            })\n                .then((requests) => {\n                    return requests\n                })\n        ])\n            .then(([createdRequests, targetedRequests]) => {\n                // here we just want to know ... does this user have any\n                // pending requests with this group!\n                return {\n                    requests: createdRequests,\n                    invitations: targetedRequests\n                }\n            })\n    }\n\n    groupRequestToOrgRequest(request: groups.Request): Promise<UserRequest | UserInvitation | WorkspaceRequest | WorkspaceInvitation | AppRequest | AppInvitation> {\n        const userProfileClient = new userProfile.UserProfileClient({\n            url: this.params.userProfileServiceURL,\n            token: this.params.token\n        })\n\n        const usernames = [request.requester]\n        if (request.resourcetype === 'user') {\n            usernames.push(request.resource)\n        }\n\n        // TODO: make different types of requests based on the resource type...\n        switch (request.resourcetype) {\n            case 'user':\n        }\n\n        return userProfileClient.getUserProfiles(usernames)\n            .then((profiles) => {\n\n                const requestType = stringToRequestType(request.type);\n                const resourceType = stringToResourceType(request.resourcetype)\n                const requestStatus = stringToRequestStatus(request.status)\n\n                switch (resourceType) {\n                    case RequestResourceType.USER:\n                        if (requestType === RequestType.REQUEST) {\n                            return {\n                                id: request.id,\n                                groupId: request.groupid,\n                                resourceType: resourceType,\n                                requester: this.profileToUser(profiles[0]),\n                                type: requestType,\n                                status: requestStatus,\n                                user: this.profileToUser(profiles[1]),\n                                createdAt: new Date(request.createdate),\n                                expireAt: new Date(request.expiredate),\n                                modifiedAt: new Date(request.moddate)\n                            } as UserRequest\n                        } else {\n                            return {\n                                id: request.id,\n                                groupId: request.groupid,\n                                resourceType: resourceType,\n                                requester: this.profileToUser(profiles[0]),\n                                type: requestType,\n                                status: requestStatus,\n                                user: this.profileToUser(profiles[1]),\n                                createdAt: new Date(request.createdate),\n                                expireAt: new Date(request.expiredate),\n                                modifiedAt: new Date(request.moddate)\n                            } as UserInvitation\n                        }\n\n                    case RequestResourceType.WORKSPACE:\n                        if (requestType === RequestType.REQUEST) {\n                            return {\n                                id: request.id,\n                                groupId: request.groupid,\n                                resourceType: resourceType,\n                                requester: this.profileToUser(profiles[0]),\n                                type: requestType,\n                                status: requestStatus,\n                                workspace: request.resource,\n                                createdAt: new Date(request.createdate),\n                                expireAt: new Date(request.expiredate),\n                                modifiedAt: new Date(request.moddate)\n                            } as WorkspaceRequest\n                        } else {\n                            return {\n                                id: request.id,\n                                groupId: request.groupid,\n                                resourceType: resourceType,\n                                requester: this.profileToUser(profiles[0]),\n                                type: requestType,\n                                status: requestStatus,\n                                workspace: request.resource,\n                                createdAt: new Date(request.createdate),\n                                expireAt: new Date(request.expiredate),\n                                modifiedAt: new Date(request.moddate)\n                            } as WorkspaceInvitation\n                        }\n                    case RequestResourceType.APP:\n                        if (requestType === RequestType.REQUEST) {\n                            return {\n                                id: request.id,\n                                groupId: request.groupid,\n                                resourceType: resourceType,\n                                requester: this.profileToUser(profiles[0]),\n                                type: requestType,\n                                status: requestStatus,\n                                app: request.resource,\n                                createdAt: new Date(request.createdate),\n                                expireAt: new Date(request.expiredate),\n                                modifiedAt: new Date(request.moddate)\n                            } as AppRequest\n                        } else {\n                            return {\n                                id: request.id,\n                                groupId: request.groupid,\n                                resourceType: resourceType,\n                                requester: this.profileToUser(profiles[0]),\n                                type: requestType,\n                                status: requestStatus,\n                                app: request.resource,\n                                createdAt: new Date(request.createdate),\n                                expireAt: new Date(request.expiredate),\n                                modifiedAt: new Date(request.moddate)\n                            } as AppInvitation\n                        }\n                    default:\n                        throw new Error('resource type not handled yet: ' + request.resourcetype)\n                }\n\n\n            })\n    }\n\n\n    getPendingOrganizationRequests(groupId: string): Promise<Array<GroupRequest>> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.getGroupRequests(groupId, {\n            includeClosed: false,\n            sortDirection: groups.SortDirection.DESCENDING,\n            startAt: new Date(0)\n        })\n            .then((requests) => {\n                return Promise.all(requests.map((request) => {\n                    return this.groupRequestToOrgRequest(request)\n                }))\n            })\n    }\n\n    membersAndAdminsToMembers(memberUsernames: Array<string>, adminUsernames: Array<string>, userProfileMap: Map<string, userProfile.UserProfile>): Array<Member> {\n        return memberUsernames.map((member) => {\n            const p = userProfileMap.get(member)\n            if (typeof p === 'undefined') {\n                throw new Error('Member without profile!')\n            }\n            return {\n                type: MemberType.MEMBER,\n                user: this.profileToUser(p)\n            }\n        }).concat(adminUsernames.map((admin) => {\n            const p = userProfileMap.get(admin)\n            if (typeof p === 'undefined') {\n                throw new Error('Admin without profile')\n            }\n            return {\n                type: MemberType.ADMIN,\n                user: this.profileToUser(p)\n            }\n        }))\n            .sort((a, b) => {\n                return a.user.realname.localeCompare(b.user.realname);\n            })\n\n        // return members\n    }\n\n    getGroupMembers(group: Group, userProfileMap: Map<string, userProfile.UserProfile>): Array<Member> {\n        return group.members.map((member) => {\n            const p = userProfileMap.get(member)\n            if (typeof p === 'undefined') {\n                throw new Error('Member without profile!')\n            }\n            return {\n                type: MemberType.MEMBER,\n                user: this.profileToUser(p)\n            }\n        }).concat(group.admins.map((admin) => {\n            const p = userProfileMap.get(admin)\n            if (typeof p === 'undefined') {\n                throw new Error('Admin without profile')\n            }\n            return {\n                type: MemberType.ADMIN,\n                user: this.profileToUser(p)\n            }\n        }))\n            // .concat([\n            //     {\n            //         type: MemberType.OWNER,\n            //         user: this.profileToUser(userProfileMap.get(group.owner)!)\n            //     }\n            // ])\n            .sort((a, b) => {\n                return a.user.realname.localeCompare(b.user.realname);\n            })\n\n        // return members\n    }\n\n    groupToOrg(group: Group, username: string): Promise<Organization> {\n        const { id, name, owner, description, createdate, moddate } = group\n        let relation: UserRelationToOrganization\n        // TODO: when we have access to members, admins, and group publication status, we can \n        // flesh out all user relations.\n        if (username === group.owner) {\n            relation = UserRelationToOrganization.OWNER\n        } else {\n            relation = UserRelationToOrganization.VIEW\n        }\n        const userProfileClient = new userProfile.UserProfileClient({\n            url: this.params.userProfileServiceURL,\n            token: this.params.token\n        })\n        let allUsers: Array<string> = []\n        if (group.members) {\n            allUsers = group.members.slice()\n        }\n        if (group.admins) {\n            allUsers = allUsers.concat(group.admins)\n        }\n        allUsers.push(group.owner)\n\n        return this.getPendingRequests()\n            .then(({ requests, invitations }) => {\n                // pending join requests\n                const pendingRequests = new Map<string, groups.Request>()\n                requests.forEach((req) => {\n                    if (req.type === 'Request' && req.resourcetype === 'user' && req.requester === username) {\n                        pendingRequests.set(req.groupid, req)\n                    }\n                })\n\n                // pending invitations to join\n                const pendingInvites = new Map<string, groups.Request>()\n                invitations.forEach((req) => {\n                    if (req.type === 'Invite' && req.resourcetype === 'user' && req.resource === username) {\n                        pendingInvites.set(req.groupid, req)\n                    }\n                })\n\n                return userProfileClient.getUserProfiles(allUsers)\n                    .then((userProfiles) => {\n                        const userProfileMap = userProfiles.reduce((map, profile) => {\n                            map.set(profile.user.username, profile)\n                            return map\n                        }, new Map<string, userProfile.UserProfile>())\n\n                        const ownerProfile = userProfileMap.get(group.owner)\n                        if (!ownerProfile) {\n                            throw new Error('No profile for owner!')\n                        }\n                        // TODO: if members really is always an array, we can skip this defaulting behavior\n                        // const memberUsernames = group.members || []\n                        // const adminUsernames = group.admins || []\n\n                        // TODO: the user profile map needs to be cached, etc.\n                        // const members = this.membersAndAdminsToMembers(memberUsernames, adminUsernames, userProfileMap).sort((a, b) => {\n                        //     return a.user.realname.localeCompare(b.user.realname);\n                        // })\n\n                        const members = this.getGroupMembers(group, userProfileMap).sort((a, b) => {\n                            return a.user.realname.localeCompare(b.user.realname);\n                        })\n\n                        let relation: UserOrgRelation\n                        // TODO: when we have access to members, admins, and group publication status, we can \n                        // flesh out all user relations.\n                        if (this.params.username === group.owner) {\n                            relation = {\n                                type: UserRelationToOrganization.OWNER\n                            } as OwnerRelation\n                        } else if (group.admins.indexOf(this.params.username) >= 0) {\n                            relation = {\n                                type: UserRelationToOrganization.ADMIN\n                            } as AdminRelation\n                        } else if (group.members.indexOf(this.params.username) >= 0) {\n                            relation = {\n                                type: UserRelationToOrganization.MEMBER\n                            } as MemberRelation\n                        } else if (pendingRequests.has(group.id)) {\n                            relation = {\n                                type: UserRelationToOrganization.MEMBER_REQUEST_PENDING,\n                                requestId: pendingRequests.get(group.id)!.id\n                            } as MembershipRequestPendingRelation\n                        } else if (pendingInvites.has(group.id)) {\n                            relation = {\n                                type: UserRelationToOrganization.MEMBER_INVITATION_PENDING,\n                                requestId: pendingInvites.get(group.id)!.id\n                            } as MembershipInvitationPendingRelation\n                        } else {\n                            relation = {\n                                type: UserRelationToOrganization.VIEW\n                            } as ViewRelation\n                        }\n\n                        // perhaps get the pending admin requests\n                        return promiseTry<Organization>((): Promise<Organization> => {\n                            if (relation.type === UserRelationToOrganization.ADMIN ||\n                                relation.type === UserRelationToOrganization.OWNER) {\n                                return this.getPendingOrganizationRequests(group.id)\n                                    .then((requests) => {\n                                        return {\n                                            id: group.id,\n                                            name: group.name,\n                                            gravatarHash: group.custom ? (group.custom.gravatarhash || null) : null,\n                                            description: group.description,\n                                            createdAt: new Date(group.createdate),\n                                            modifiedAt: new Date(group.moddate),\n                                            owner: {\n                                                type: MemberType.OWNER,\n                                                user: this.profileToUser(ownerProfile)\n                                            },\n                                            relation: relation,\n                                            members: members,\n                                            // admins: admins,\n                                            adminRequests: requests\n                                        }\n                                    })\n                            } else {\n                                return Promise.resolve({\n                                    id: group.id,\n                                    name: group.name,\n                                    gravatarHash: group.custom ? (group.custom.gravatarhash || null) : null,\n                                    description: group.description,\n                                    createdAt: new Date(group.createdate),\n                                    modifiedAt: new Date(group.moddate),\n                                    owner: {\n                                        type: MemberType.OWNER,\n                                        user: this.profileToUser(ownerProfile)\n                                    },\n                                    relation: relation,\n                                    members: members,\n                                    // admins: admins,\n                                    adminRequests: []\n                                })\n                            }\n                        })\n\n                    })\n            })\n    }\n\n    getPendingAdminRequests(groupIds: Array<string>): Promise<Map<string, Array<GroupRequest>>> {\n        return Promise.all(groupIds.map((id) => {\n            return this.getPendingOrganizationRequests(id)\n                .then((requests) => {\n                    return {\n                        groupId: id,\n                        requests: requests\n                    }\n                })\n        }))\n            .then((allRequests) => {\n                const pendingRequests = new Map<string, Array<GroupRequest>>()\n                allRequests.forEach(({ groupId, requests }) => {\n                    pendingRequests.set(groupId, requests)\n                })\n                return pendingRequests\n            })\n    }\n\n    groupsToOrgs(groups: Array<Group>, username: string): Promise<Array<Organization>> {\n        const userProfileClient = new userProfile.UserProfileClient({\n            url: this.params.userProfileServiceURL,\n            token: this.params.token\n        })\n\n        const allUsers = groups.reduce((allUsers, group) => {\n            allUsers.set(group.owner, true)\n            group.members.forEach((member) => allUsers.set(member, true))\n            group.admins.forEach((admin) => allUsers.set(admin, true))\n            return allUsers;\n        }, new Map<string, boolean>()).keys()\n\n        const adminGroupIds = groups\n            .filter(({ owner, admins }) => (owner === username || admins.indexOf(username) >= 0))\n            .map(({ id }) => id)\n\n        return Promise.all([\n            userProfileClient.getUserProfiles(Array.from(allUsers)),\n            this.getPendingRequests(),\n            this.getPendingAdminRequests(adminGroupIds)\n        ])\n            .then(([profiles, { requests, invitations }, pendingAdminRequests]) => {\n                const profileMap = profiles.reduce((profileMap, profile) => {\n                    profileMap.set(profile.user.username, profile)\n                    return profileMap\n                }, new Map<string, userProfile.UserProfile>())\n\n                // now make a per-group map out of this...\n                const pendingRequests = new Map<string, groups.Request>()\n                requests.forEach((req) => {\n                    if (req.type === 'Request' && req.resourcetype === 'user' && req.requester === username) {\n                        pendingRequests.set(req.groupid, req)\n                    }\n                })\n\n                const pendingInvites = new Map<string, groups.Request>()\n                invitations.forEach((req) => {\n                    if (req.type === 'Invite' && req.resourcetype === 'user' && req.resource === username) {\n                        pendingInvites.set(req.groupid, req)\n                    }\n                })\n\n                return Promise.all(groups.map((group) => {\n                    const { id, name, description, createdate, moddate, owner, members, admins, custom: { gravatarhash } } = group\n                    let relation: UserOrgRelation\n                    // TODO: when we have access to members, admins, and group publication status, we can \n                    // flesh out all user relations.\n                    const orgMembers: Array<Member> = this.membersAndAdminsToMembers(members, admins, profileMap)\n\n                    if (this.params.username === group.owner) {\n                        relation = {\n                            type: UserRelationToOrganization.OWNER\n                        } as OwnerRelation\n                    } else if (group.admins.indexOf(this.params.username) >= 0) {\n                        relation = {\n                            type: UserRelationToOrganization.ADMIN\n                        } as AdminRelation\n                    } else if (group.members.indexOf(this.params.username) >= 0) {\n                        relation = {\n                            type: UserRelationToOrganization.MEMBER\n                        } as MemberRelation\n                    } else if (pendingRequests.has(group.id)) {\n                        relation = {\n                            type: UserRelationToOrganization.MEMBER_REQUEST_PENDING,\n                            requestId: pendingRequests.get(group.id)!.id\n                        } as MembershipRequestPendingRelation\n                    } else if (pendingInvites.has(group.id)) {\n                        relation = {\n                            type: UserRelationToOrganization.MEMBER_INVITATION_PENDING,\n                            requestId: pendingInvites.get(group.id)!.id\n                        } as MembershipInvitationPendingRelation\n                    } else {\n                        relation = {\n                            type: UserRelationToOrganization.VIEW\n                        } as ViewRelation\n                    }\n\n                    return {\n                        id, name, description,\n                        gravatarHash: gravatarhash || null,\n                        owner: {\n                            type: MemberType.OWNER,\n                            user: this.profileToUser(profileMap.get(group.owner)!)\n                        },\n                        createdAt: new Date(createdate),\n                        modifiedAt: new Date(moddate),\n                        relation: relation,\n                        members: orgMembers,\n                        // admins: admins.map((username) => this.profileToUser(profileMap.get(username)!)),\n                        adminRequests: (pendingAdminRequests.has(id) ? pendingAdminRequests.get(id)! : [])\n                    }\n                }))\n            })\n    }\n\n    getOrgs(username: string): Promise<Array<Organization>> {\n        if (this.cachedOrgs) {\n            return Promise.resolve(this.cachedOrgs)\n        }\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n        return groupsClient.getGroups()\n            .then((groups) => {\n                return this.groupsToOrgs(groups, username)\n            })\n    }\n\n    queryOrgs(query: Query): Promise<QueryResults> {\n\n        let start = new Date().getTime()\n        return this.getOrgs(query.username)\n            .then((orgs) => {\n                const filtered = applyFilter(orgs, query.filter, query.username)\n                const searched = applyOrgSearch(filtered, query.searchTerms)\n                const sorted = applySort(searched, query.sortBy, query.sortDirection)\n\n                return {\n                    organizations: sorted,\n                    total: orgs.length\n                }\n            })\n    }\n\n    profileToUser(profile: userProfile.UserProfile): User {\n        let jobTitle\n        if (profile.profile.userdata.jobTitle === 'Other') {\n            jobTitle = profile.profile.userdata.jobTitleOther\n        } else {\n            jobTitle = profile.profile.userdata.jobTitle\n        }\n        return {\n            username: profile.user.username,\n            realname: profile.user.realname,\n            city: profile.profile.userdata.city,\n            state: profile.profile.userdata.state,\n            country: profile.profile.userdata.country,\n            title: jobTitle,\n            organization: profile.profile.userdata.organization,\n            avatarOption: profile.profile.userdata.avatarOption,\n            gravatarHash: profile.profile.synced.gravatarHash,\n            gravatarDefault: profile.profile.userdata.gravatarDefault\n        }\n    }\n\n    getOrg(id: string): Promise<Organization> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n        return groupsClient.getGroupById(id)\n            .then((group) => {\n                return this.groupToOrg(group, this.params.username)\n            })\n    }\n\n    getGroup(id: string): Promise<Group> {\n        if (id.length === 0) {\n            return Promise.reject(new Error('Group id may not be an empty string'))\n        }\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n        return groupsClient.getGroupById(id)\n            .then((group) => {\n                return group\n            })\n    }\n\n    groupExists(id: string): Promise<boolean> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n        return groupsClient.groupExists(id)\n            .then(({ exists }) => {\n                return exists\n            })\n    }\n\n    addOrg(newOrg: EditableOrganization, username: string): Promise<Organization> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        // do record-level validation\n        if ((newOrg.id.error && newOrg.id.error.type === UIErrorType.ERROR) ||\n            (newOrg.name.error && newOrg.name.error.type === UIErrorType.ERROR) ||\n            (newOrg.gravatarHash.error && newOrg.gravatarHash.error.type === UIErrorType.ERROR) ||\n            (newOrg.description.error && newOrg.description.error.type === UIErrorType.ERROR)) {\n            return Promise.reject(new Error('One or more fields are invalid'))\n        }\n\n        return groupsClient.createGroup({\n            id: newOrg.id.value,\n            name: newOrg.name.value,\n            gravatarhash: newOrg.gravatarHash.value,\n            description: newOrg.description.value,\n            type: 'Organization'\n        })\n            .then((group) => {\n                return this.groupToOrg(group, username)\n            })\n    }\n\n    // TODO this is fake until update is implemented on the back end\n    updateOrg(id: string, orgUpdate: OrganizationUpdate): Promise<void> {\n\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        // do record-level validation\n\n\n        return groupsClient.updateGroup(id, {\n            name: orgUpdate.name,\n            gravatarhash: orgUpdate.gravatarHash,\n            description: orgUpdate.description\n        })\n    }\n\n    requestMembershipToGroup(id: string): Promise<GroupRequest> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.requestMembership({\n            groupId: id\n        })\n            .then((request: groups.Request) => {\n                return this.groupRequestToOrgRequest(request)\n            })\n            .catch((err) => {\n                throw err;\n            })\n    }\n\n    cancelRequest(requestId: string): Promise<GroupRequest> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.cancelRequest({\n            requestId\n        })\n            .then((request: groups.Request) => {\n                return this.groupRequestToOrgRequest(request)\n            })\n    }\n\n    acceptRequest(requestId: string): Promise<GroupRequest> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.acceptRequest({\n            requestId\n        })\n            .then((request: groups.Request) => {\n                return this.groupRequestToOrgRequest(request)\n            })\n    }\n\n    denyRequest(requestId: string): Promise<GroupRequest> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.denyRequest({\n            requestId\n        })\n            .then((request: groups.Request) => {\n                return this.groupRequestToOrgRequest(request)\n            })\n    }\n\n    acceptJoinInvitation(requestId: string): Promise<GroupRequest> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.acceptRequest({\n            requestId\n        })\n            .then((request: groups.Request) => {\n                return this.groupRequestToOrgRequest(request)\n            })\n    }\n\n    rejectJoinInvitation(requestId: string): Promise<GroupRequest> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.denyRequest({\n            requestId\n        })\n            .then((request: groups.Request) => {\n                return this.groupRequestToOrgRequest(request)\n            })\n    }\n\n    memberToAdmin(groupId: string, member: string): Promise<void> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.memberToAdmin({\n            groupId,\n            member\n        })\n    }\n\n    adminToMember(groupId: string, member: string): Promise<void> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.adminToMember({\n            groupId,\n            member\n        })\n    }\n    removeMember(groupId: string, member: string): Promise<void> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.removeMember({\n            groupId,\n            member\n        })\n    }\n\n    requestJoinGroup(groupId: string, username: string): Promise<GroupRequest> {\n        const groupsClient = new GroupsClient({\n            url: this.params.groupsServiceURL,\n            token: this.params.token\n        })\n\n        return groupsClient.requestJoinGroup({\n            groupId,\n            username\n        })\n            .then((request) => {\n                return this.groupRequestToOrgRequest(request)\n            })\n    }\n\n    // Validation \n\n    validateOrgId(id: string): [string, UIError] {\n        return Validation.validateOrgId(id);\n    }\n\n    validateOrgName(name: string): [string, UIError] {\n        return Validation.validateOrgName(name)\n    }\n\n    validateOrgDescription(description: string): [string, UIError] {\n        return Validation.validateOrgDescription(description);\n    }\n\n    // Users\n\n    searchUsers(query: string): Promise<Array<BriefUser>> {\n        const userProfileClient = new userProfile.UserProfileClient({\n            url: this.params.userProfileServiceURL,\n            token: this.params.token\n        })\n\n        return userProfileClient.searchUsers(query)\n            .then((users) => {\n                return users.map(({ username, realname }) => {\n                    return {\n                        username, realname\n                    }\n                })\n            })\n\n    }\n\n    getUser(username: string): Promise<User> {\n        const userProfileClient = new userProfile.UserProfileClient({\n            url: this.params.userProfileServiceURL,\n            token: this.params.token\n        })\n\n        return userProfileClient.getUserProfile(username)\n            .then((userProfile) => {\n                return this.profileToUser(userProfile)\n            })\n    }\n}\n\nexport class Validation {\n    static validateOrgId(id: string): [string, UIError] {\n        // May not be empty\n        if (id.length === 0) {\n            return [\n                id, {\n                    type: UIErrorType.ERROR,\n                    message: 'Organization id may not be empty'\n                }]\n        }\n        // No spaces\n        if (id.match(/\\s/)) {\n            return [\n                id, {\n                    type: UIErrorType.ERROR,\n                    message: 'Organization id may not contain a space'\n                }]\n        }\n        // May not exceed maximum size\n        // todo: what is the real limit?\n        if (id.length > 100) {\n            return [\n                id, {\n                    type: UIErrorType.ERROR,\n                    message: 'Organization id may not be longer than 100 characters'\n                }]\n        }\n\n        // May not contain non-alphanumeric and underscore\n        const alphaRe = /^[a-zA-Z0-9_]+$/\n        if (!id.match(alphaRe)) {\n            return [\n                id, {\n                    type: UIErrorType.ERROR,\n                    message: 'Organization id may only contain alphanumeric (a-z, A-Z, 0-9) and underscore (_)'\n                }\n            ]\n        }\n\n        return [id, {\n            type: UIErrorType.NONE\n        }]\n    }\n\n    static validateOrgName(name: string): [string, UIError] {\n        if (name.length === 0) {\n            return [\n                name, {\n                    type: UIErrorType.ERROR,\n                    message: 'Organization name may not be empty'\n                }]\n        }\n        if (name.length > 256) {\n            return [\n                name, {\n                    type: UIErrorType.ERROR,\n                    message: 'Organization name may not be longer than 256 characters'\n                }]\n        }\n        return [\n            name, {\n                type: UIErrorType.NONE\n            }]\n    }\n\n    static validateOrgGravatarHash(gravatarHash: string): [string, UIError] {\n        if (gravatarHash.length === 0) {\n            return [\n                gravatarHash, {\n                    type: UIErrorType.NONE\n                }]\n        }\n        if (gravatarHash.length > 32) {\n            return [\n                gravatarHash, {\n                    type: UIErrorType.ERROR,\n                    message: 'Organization gravatar hash may not be longer than 32 characters'\n                }]\n        }\n        return [\n            gravatarHash, {\n                type: UIErrorType.NONE\n            }]\n    }\n\n    static validateOrgDescription(name: string): [string, UIError] {\n        if (name.length === 0) {\n            return [\n                name, {\n                    type: UIErrorType.ERROR,\n                    message: 'Organization description may not be empty'\n                }]\n        }\n        // TODO: Is there really a limit?\n        if (name.length > 4096) {\n            return [\n                name, {\n                    type: UIErrorType.ERROR,\n                    message: 'Organization name may not be longer than 4,096 characters'\n                }]\n        }\n        return [\n            name, {\n                type: UIErrorType.NONE\n            }]\n    }\n}\n\nexport class StaticData {\n    static makeEmptyEditableOrganization(): EditableOrganization {\n        return {\n            id: {\n                value: '',\n                status: FieldState.NONE,\n                error: {\n                    type: UIErrorType.NONE\n                }\n            },\n            name: {\n                value: '',\n                status: FieldState.NONE,\n                error: {\n                    type: UIErrorType.NONE\n                }\n            },\n            gravatarHash: {\n                value: '',\n                status: FieldState.NONE,\n                error: {\n                    type: UIErrorType.NONE\n                }\n            },\n            description: {\n                value: '',\n                status: FieldState.NONE,\n                error: {\n                    type: UIErrorType.NONE\n                }\n            }\n        }\n    }\n\n}","import { Action } from 'redux'\nimport { ThunkDispatch } from 'redux-thunk'\n\nimport { ActionFlag } from './index'\nimport {\n    StoreState, Organization,\n    AppError, SortDirection, UIError, UIErrorType\n} from '../../types'\nimport { Model } from '../../data/model'\n\n\n// Action Types\n\nexport interface ViewOrgStart extends Action {\n    type: ActionFlag.VIEW_ORG_FETCH_START\n}\n\nexport interface ViewOrgStop extends Action {\n    type: ActionFlag.VIEW_ORG_STOP\n}\n\nexport interface ViewOrgSuccess extends Action {\n    type: ActionFlag.VIEW_ORG_FETCH_SUCCESS,\n    organization: Organization\n}\n\nexport interface ViewOrgError extends Action {\n    type: ActionFlag.VIEW_ORG_FETCH_ERROR,\n    error: AppError\n}\n\nexport interface ViewOrgFetch extends Action {\n    type: ActionFlag.VIEW_ORG_FETCH,\n    id: string\n}\n\n// Join Requests\n\nexport interface ViewOrgJoinRequest extends Action {\n    type: ActionFlag.VIEW_ORG_JOIN_REQUEST,\n    requestId: string\n}\n\nexport interface ViewOrgJoinRequestStart extends Action {\n    type: ActionFlag.VIEW_ORG_JOIN_REQUEST_START\n}\n\nexport interface ViewOrgJoinRequestSuccess extends Action {\n    type: ActionFlag.VIEW_ORG_JOIN_REQUEST_SUCCESS\n}\n\nexport interface ViewOrgJoinRequestError extends Action {\n    type: ActionFlag.VIEW_ORG_JOIN_REQUEST_ERROR,\n    error: UIError\n}\n\n// Join Request cancellation\n\nexport interface ViewOrgCancelJoinRequest extends Action {\n    type: ActionFlag.VIEW_ORG_CANCEL_JOIN_REQUEST\n}\n\nexport interface ViewOrgCancelJoinRequestStart extends Action {\n    type: ActionFlag.VIEW_ORG_CANCEL_JOIN_REQUEST_START\n}\n\nexport interface ViewOrgCancelJoinRequestSuccess extends Action {\n    type: ActionFlag.VIEW_ORG_CANCEL_JOIN_REQUEST_SUCCESS\n}\n\nexport interface ViewOrgCancelJoinRequestError extends Action {\n    type: ActionFlag.VIEW_ORG_CANCEL_JOIN_REQUEST_ERROR,\n    error: UIError\n}\n\n// Join Invitation Acceptance\n\nexport interface AcceptJoinInvitation extends Action {\n    type: ActionFlag.VIEW_ORG_ACCEPT_JOIN_INVITATION\n}\n\nexport interface AcceptJoinInvitationStart extends Action {\n    type: ActionFlag.VIEW_ORG_ACCEPT_JOIN_INVITATION_START\n}\n\nexport interface AcceptJoinInvitationSuccess extends Action {\n    type: ActionFlag.VIEW_ORG_ACCEPT_JOIN_INVITATION_SUCCESS\n}\n\nexport interface AcceptJoinInvitationError extends Action {\n    type: ActionFlag.VIEW_ORG_ACCEPT_JOIN_INVITATION_ERROR,\n    error: AppError\n}\n\n// Join Invitation Denial\n\nexport interface RejectJoinInvitation extends Action {\n    type: ActionFlag.VIEW_ORG_REJECT_JOIN_INVITATION\n}\n\nexport interface RejectJoinInvitationStart extends Action {\n    type: ActionFlag.VIEW_ORG_REJECT_JOIN_INVITATION_START\n}\n\nexport interface RejectJoinInvitationSuccess extends Action {\n    type: ActionFlag.VIEW_ORG_REJECT_JOIN_INVITATION_SUCCESS\n}\n\nexport interface RejectJoinInvitationError extends Action {\n    type: ActionFlag.VIEW_ORG_REJECT_JOIN_INVITATION_ERROR,\n    error: AppError\n}\n\n\n// Generators\n\nexport function viewOrgStart() {\n    return {\n        type: ActionFlag.VIEW_ORG_FETCH_START\n    }\n}\n\nexport function viewOrgStop(): ViewOrgStop {\n    return {\n        type: ActionFlag.VIEW_ORG_STOP\n    }\n}\n\nexport function viewOrgSuccess(org: Organization): ViewOrgSuccess {\n    return {\n        type: ActionFlag.VIEW_ORG_FETCH_SUCCESS,\n        organization: org\n    }\n}\n\n\nexport function viewOrgError(error: AppError): ViewOrgError {\n    return {\n        type: ActionFlag.VIEW_ORG_FETCH_ERROR,\n        error: error\n    }\n}\n\n// Join requests\n\nexport function viewOrgJoinRequestStart(): ViewOrgJoinRequestStart {\n    return {\n        type: ActionFlag.VIEW_ORG_JOIN_REQUEST_START\n    }\n}\n\nexport function viewOrgJoinRequestSuccess(): ViewOrgJoinRequestSuccess {\n    return {\n        type: ActionFlag.VIEW_ORG_JOIN_REQUEST_SUCCESS\n    }\n}\n\nexport function viewOrgJoinRequestError(error: UIError): ViewOrgJoinRequestError {\n    return {\n        type: ActionFlag.VIEW_ORG_JOIN_REQUEST_ERROR,\n        error: error\n    }\n}\n\n// Join Request Cancellation\n\nexport function viewOrgCancelJoinRequestStart(): ViewOrgCancelJoinRequestStart {\n    return {\n        type: ActionFlag.VIEW_ORG_CANCEL_JOIN_REQUEST_START\n    }\n}\n\nexport function viewOrgCancelJoinRequestSuccess(): ViewOrgCancelJoinRequestSuccess {\n    return {\n        type: ActionFlag.VIEW_ORG_CANCEL_JOIN_REQUEST_SUCCESS\n    }\n}\n\nexport function viewOrgCancelJoinRequestError(error: UIError): ViewOrgCancelJoinRequestError {\n    return {\n        type: ActionFlag.VIEW_ORG_CANCEL_JOIN_REQUEST_ERROR,\n        error: error\n    }\n}\n\n// Invitation Acceptance\n\nexport function acceptJoinInvitationStart(): AcceptJoinInvitationStart {\n    return {\n        type: ActionFlag.VIEW_ORG_ACCEPT_JOIN_INVITATION_START\n    }\n}\n\nexport function acceptJoinInvitationSuccess(): AcceptJoinInvitationSuccess {\n    return {\n        type: ActionFlag.VIEW_ORG_ACCEPT_JOIN_INVITATION_SUCCESS\n    }\n}\n\nexport function acceptJoinInvitationError(error: AppError): AcceptJoinInvitationError {\n    return {\n        type: ActionFlag.VIEW_ORG_ACCEPT_JOIN_INVITATION_ERROR,\n        error: error\n    }\n}\n\n// Invitation Rejection \n\nexport function rejectJoinInvitationStart(): RejectJoinInvitationStart {\n    return {\n        type: ActionFlag.VIEW_ORG_REJECT_JOIN_INVITATION_START\n    }\n}\n\nexport function rejectJoinInvitationSuccess(): RejectJoinInvitationSuccess {\n    return {\n        type: ActionFlag.VIEW_ORG_REJECT_JOIN_INVITATION_SUCCESS\n    }\n}\n\nexport function rejectJoinInvitationError(error: AppError): RejectJoinInvitationError {\n    return {\n        type: ActionFlag.VIEW_ORG_REJECT_JOIN_INVITATION_ERROR,\n        error: error\n    }\n}\n\n\n// Join invitation acceptance\n\n// TODO\n\n// Thunks\n\nexport function viewOrgFetch(id: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(viewOrgStart())\n\n        const { auth: { authorization: { token, username } },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        model.getOrg(id)\n            .then((org) => {\n                dispatch(viewOrgSuccess(org))\n            })\n            .catch((err) => {\n                dispatch(viewOrgError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}\n\nexport function viewOrgJoinRequest() {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        //TODO: could do a start here...\n\n        const { auth: { authorization: { token, username } },\n            app: { config },\n            viewOrg: { organization } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        if (typeof organization === 'undefined') {\n            dispatch(viewOrgJoinRequestError({\n                type: UIErrorType.ERROR,\n                message: 'Org not currently defined'\n            }))\n            return\n        }\n\n        model.requestMembershipToGroup(organization.id)\n            .then(() => {\n                dispatch(viewOrgJoinRequestSuccess())\n                // quick 'n easy\n                dispatch(viewOrgFetch((organization.id)))\n            })\n            .catch((err) => {\n                dispatch(viewOrgJoinRequestError({\n                    type: UIErrorType.ERROR,\n                    message: err.message\n                }))\n            })\n    }\n}\n\nexport function viewOrgCancelJoinRequest(requestId: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(viewOrgJoinRequestStart())\n\n        const { auth: { authorization: { token, username } },\n            app: { config },\n            viewOrg: { organization } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n        if (typeof organization === 'undefined') {\n            dispatch(viewOrgCancelJoinRequestError({\n                type: UIErrorType.ERROR,\n                message: 'Org not currently defined'\n            }))\n            return\n        }\n\n        model.cancelRequest(requestId)\n            .then((newRequest) => {\n                dispatch(viewOrgCancelJoinRequestSuccess())\n                // quick 'n easy\n                dispatch(viewOrgFetch(newRequest.groupId))\n            })\n            .catch((err) => {\n                dispatch(viewOrgCancelJoinRequestError({\n                    type: UIErrorType.ERROR,\n                    message: err.message\n                }))\n            })\n\n    }\n}\n\nexport function acceptJoinInvitation(requestId: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(acceptJoinInvitationStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config },\n            viewOrg: { organization } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n        if (typeof organization === 'undefined') {\n            dispatch(acceptJoinInvitationError({\n                code: 'undefined',\n                message: 'Org not currently defined'\n            }))\n            return\n        }\n\n        model.acceptJoinInvitation(requestId)\n            .then((newRequest) => {\n                dispatch(acceptJoinInvitationSuccess())\n                // quick 'n easy\n                dispatch(viewOrgFetch(newRequest.groupId))\n            })\n            .catch((err) => {\n                dispatch(acceptJoinInvitationError(err))\n            })\n\n    }\n}\n\n\nexport function rejectJoinInvitation(requestId: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(acceptJoinInvitationStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config },\n            viewOrg: { organization } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n        if (typeof organization === 'undefined') {\n            dispatch(acceptJoinInvitationError({\n                code: 'undefined',\n                message: 'Org not currently defined'\n            }))\n            return\n        }\n\n        model.rejectJoinInvitation(requestId)\n            .then((newRequest) => {\n                dispatch(rejectJoinInvitationSuccess())\n                // quick 'n easy\n                dispatch(viewOrgFetch(newRequest.groupId))\n            })\n            .catch((err) => {\n                dispatch(rejectJoinInvitationError(err))\n            })\n\n    }\n}\n","import { Action } from 'redux'\nimport { ThunkDispatch } from 'redux-thunk'\n\nimport { ActionFlag } from './index'\nimport {\n    StoreState, Organization,\n    AppError, SortDirection\n} from '../../types'\nimport { Model } from '../../data/model'\nimport { viewOrgStop } from './viewOrg'\n\n\nexport interface SortOrgs extends Action<ActionFlag.SORT_ORGS> {\n    type: ActionFlag.SORT_ORGS,\n    sortBy: string,\n    sortDirection: SortDirection\n}\n\nexport interface SortOrgsStart extends Action<ActionFlag.SORT_ORGS_START> {\n    type: ActionFlag.SORT_ORGS_START,\n    sortBy: string,\n    sortDirection: SortDirection\n}\n\nexport function sortOrgsStart(sortBy: string, sortDirection: SortDirection): SortOrgsStart {\n    return {\n        type: ActionFlag.SORT_ORGS_START,\n        sortBy: sortBy,\n        sortDirection: sortDirection\n    }\n}\n\n// SEARCH (FETCH) ORGS\n\n\n\n// Called upon the start of a search call\n// Sets the ui state to enable a spinner\n// and also search query data to be reflected in the ui\nexport interface SearchOrgsStart extends Action<ActionFlag.SEARCH_ORGS_START> {\n    type: ActionFlag.SEARCH_ORGS_START,\n    searchTerms: Array<string>\n}\n\nexport function searchOrgsStart(searchTerms: Array<string>): SearchOrgsStart {\n    return {\n        type: ActionFlag.SEARCH_ORGS_START,\n        searchTerms: searchTerms\n    }\n}\n\n// Called upon successful completion of a search\n// Sets the organizations found\nexport interface SearchOrgsSuccess extends Action<ActionFlag.SEARCH_ORGS_SUCCESS> {\n    type: ActionFlag.SEARCH_ORGS_SUCCESS,\n    organizations: Array<Organization>,\n    totalCount: number\n}\n\nexport function searchOrgsSuccess(organizations: Array<Organization>, totalCount: number): SearchOrgsSuccess {\n    return {\n        type: ActionFlag.SEARCH_ORGS_SUCCESS,\n        organizations: organizations,\n        totalCount: totalCount\n    }\n}\n\n// Called upon a search error\n// Sets error state\nexport interface SearchOrgsError extends Action<ActionFlag.SEARCH_ORGS_ERROR> {\n    type: ActionFlag.SEARCH_ORGS_ERROR,\n    error: AppError\n}\n\nexport function searchOrgsError(error: AppError): SearchOrgsError {\n    return {\n        type: ActionFlag.SEARCH_ORGS_ERROR,\n        error: error\n    }\n}\n\n\nexport interface SearchOrgs extends Action<ActionFlag.SEARCH_ORGS> {\n    type: ActionFlag.SEARCH_ORGS,\n    searchTerms: Array<string>\n}\n\n// TODO: proper typing here \nexport function searchOrgs(searchTerms: Array<string>) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(searchOrgsStart(searchTerms))\n        dispatch(viewOrgStop())\n\n        const {\n            browseOrgs: browseOrgs,\n            auth: { authorization: { token, username } },\n            app: { config } } = getState()\n\n        if (browseOrgs.view === null) {\n            dispatch(searchOrgsError({\n                code: 'invalid-state',\n                message: 'Search orgs may not be called without a defined view'\n            }))\n            return\n        }\n\n        const { view: { sortBy, sortDirection, filter } } = browseOrgs\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        return model.queryOrgs({\n            searchTerms: searchTerms,\n            sortBy, sortDirection, filter, username\n        })\n            .then(({ organizations, total }) => {\n                // TODO: also total.\n                dispatch(searchOrgsSuccess(organizations, total))\n            })\n            .catch((error) => {\n                console.error('Error querying orgs', error.name, error.message)\n                dispatch(searchOrgsError({\n                    code: error.name,\n                    message: error.message\n                }))\n            })\n    }\n}\n\nexport function sortOrgs(sortBy: string, sortDirection: SortDirection) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(sortOrgsStart(sortBy, sortDirection))\n\n        const {\n            browseOrgs: browseOrgs,\n            auth: { authorization: { token, username } },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        if (browseOrgs.view === null) {\n            dispatch(searchOrgsError({\n                code: 'invalid-state',\n                message: 'Search orgs may not be called without a defined view'\n            }))\n            return\n        }\n\n        const { view: { searchTerms, filter } } = browseOrgs\n\n        return model.queryOrgs({\n            searchTerms,\n            sortBy, sortDirection, filter, username\n        })\n            .then(({ organizations, total }) => {\n                // TODO: also total.\n                dispatch(searchOrgsSuccess(organizations, total))\n            })\n            .catch((error) => {\n                dispatch(searchOrgsError({\n                    code: error.name,\n                    message: error.message\n                }))\n            })\n    }\n}\n\nexport function filterOrgs(filter: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(filterOrgsStart(filter))\n\n        const {\n            browseOrgs: browseOrgs,\n            auth: { authorization: { token, username } },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        if (browseOrgs.view === null) {\n            dispatch(searchOrgsError({\n                code: 'invalid-state',\n                message: 'Search orgs may not be called without a defined view'\n            }))\n            return\n        }\n\n        const { view: { searchTerms, sortBy, sortDirection } } = browseOrgs\n\n        return model.queryOrgs({\n            searchTerms,\n            sortBy, sortDirection, filter, username\n        })\n            .then(({ organizations, total }) => {\n                // TODO: also total.\n                dispatch(searchOrgsSuccess(organizations, total))\n            })\n            .catch((error) => {\n                dispatch(searchOrgsError({\n                    code: error.name,\n                    message: error.message\n                }))\n            })\n    }\n}\n\n\n\n\n// Filter orgs\nexport interface FilterOrgs extends Action<ActionFlag.FILTER_ORGS> {\n    type: ActionFlag.FILTER_ORGS,\n    filter: string\n}\n\nexport interface FilterOrgsStart extends Action<ActionFlag.FILTER_ORGS_START> {\n    type: ActionFlag.FILTER_ORGS_START,\n    filter: string\n}\n\nexport function filterOrgsStart(filter: string): FilterOrgsStart {\n    return {\n        type: ActionFlag.FILTER_ORGS_START,\n        filter: filter\n    }\n}\n\n","import OrganizationsBrowser from './OrganizationsBrowser'\nimport { StoreState, SortDirection, BrowseOrgsState, AppError } from '../../types'\nimport * as actions from '../../redux/actions/searchOrgs'\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\n//\n// Typing for the mapState and mapDispatch\n//\nexport interface LinkStateProps {\n    totalCount: number,\n    filteredCount: number\n    sortBy: string,\n    sortDirection: SortDirection,\n    filter: string,\n    searching: boolean,\n    error: AppError | null\n}\n\nexport interface LinkDispatchProps {\n    onSearchOrgs: (searchTerms: Array<string>) => void,\n    onSortOrgs: (sortBy: string, sortDirection: SortDirection) => void,\n    onFilterOrgs: (filter: string) => void\n}\n\n\n// note second arg is the component props, but we don't have any component props to merge in.\nexport function mapStateToProps(storeState: StoreState): LinkStateProps {\n    // TODO: more insanity we must find a way of working around\n    if (storeState.browseOrgs.view) {\n        const {\n            browseOrgs: {\n                state,\n                error,\n                view: { totalCount, filteredCount, sortBy, sortDirection, filter } } } = storeState\n        return {\n            totalCount,\n            filteredCount,\n            sortBy,\n            sortDirection,\n            filter,\n            error,\n            searching: (state === BrowseOrgsState.SEARCHING)\n        }\n    } else {\n        return {\n            totalCount: 0,\n            filteredCount: 0,\n            sortBy: '',\n            sortDirection: SortDirection.ASCENDING,\n            filter: '',\n            error: null,\n            searching: (storeState.browseOrgs.state === BrowseOrgsState.SEARCHING)\n        }\n    }\n}\n\n// function onSortOrgs(sortBy: string, sortDescending: boolean) : Dispatch<actions.SortOrgs> {\n//     dispatch(actions.sortOrgs(sortBy, sortDescending))\n// }\n\n// note second arg is the component props, but we don't have any to merge in.\n// export function mapDispatchToProps(dispatch: actions.SearchOrgs | Dispatch<actions.SortOrgs> | Dispatch<actions.FilterOrgs>) : LinkDispatchProps {\n//     return {\n//         onSearchOrgs: (searchTerms) => {\n\n//             dispatch(actions.searchOrgs(searchTerms))\n\n\n\n//         },\n//         onSortOrgs: (sortBy, sortDescending) => {\n//             dispatch(actions.sortOrgs(sortBy, sortDescending))\n//         },\n//         onFilterOrgs: (filter) => {\n//             dispatch(actions.filterOrgs(filter))\n//         }\n//     }\n// }\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.SearchOrgs | actions.SortOrgs | actions.FilterOrgs>): LinkDispatchProps {\n    return {\n        onSearchOrgs: (searchTerms: Array<string>) => {\n            // TODO proper typing here\n            dispatch(actions.searchOrgs(searchTerms) as any)\n        },\n        onSortOrgs: (sortBy: string, sortDirection: SortDirection) => {\n            // TODO proper typing here\n            dispatch(actions.sortOrgs(sortBy, sortDirection) as any)\n        },\n        onFilterOrgs: (filter: string) => {\n            dispatch(actions.filterOrgs(filter) as any)\n        }\n    }\n}\n\n// export function mapDispatchToProps(dispatch: Dispatch<any>) : LinkDispatchProps {\n//     return {\n//         onSearchOrgs: (searchTerms) => {\n//             dispatch(actions.searchOrgs(searchTerms))\n//         },\n//         onSortOrgs: (sortBy, sortDescending) => {\n//             dispatch(actions.sortOrgs(sortBy, sortDescending))\n//         }\n//     }\n// }\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OrganizationsBrowser)","import { Action } from 'redux'\nimport { ThunkDispatch } from 'redux-thunk'\n\nimport { ActionFlag } from './index'\nimport { StoreState, Organization, AppError, UIError, UIErrorType, FieldState } from '../../types'\nimport { Model, Validation } from '../../data/model'\n\n// ACTIONS\n\nexport interface AddOrg extends Action {\n    type: ActionFlag.ADD_ORG\n}\n\nexport interface AddOrgStart extends Action {\n    type: ActionFlag.ADD_ORG_START\n}\n\nexport interface AddOrgSuccess extends Action {\n    type: ActionFlag.ADD_ORG_SUCCESS,\n    organization: Organization\n}\n\nexport interface AddOrgError extends Action<ActionFlag.ADD_ORG_ERROR> {\n    type: ActionFlag.ADD_ORG_ERROR,\n    error: AppError\n}\n\n// Editing\n\nexport interface AddOrgEdit extends Action<ActionFlag.ADD_ORG_EDIT> {\n    type: ActionFlag.ADD_ORG_EDIT;\n}\n\nexport interface AddOrgEditStart {\n    type: ActionFlag.ADD_ORG_EDIT_START\n}\n\nexport interface AddOrgEditFinish {\n    type: ActionFlag.ADD_ORG_EDIT_FINISH\n}\n\n// Evaluating state of form \n\nexport interface AddOrgEvaluate extends Action<ActionFlag.ADD_ORG_EVALUATE> {\n    type: ActionFlag.ADD_ORG_EVALUATE\n}\n\nexport interface AddOrgEvaluateOK extends Action<ActionFlag.ADD_ORG_EVALUATE_OK> {\n    type: ActionFlag.ADD_ORG_EVALUATE_OK\n}\n\nexport interface AddOrgEvaluateErrors extends Action<ActionFlag.ADD_ORG_EVALUATE_ERRORS> {\n    type: ActionFlag.ADD_ORG_EVALUATE_ERRORS\n}\n\n// Updating name field\n\nexport interface AddOrgUpdateName extends Action {\n    type: ActionFlag.ADD_ORG_UPDATE_NAME,\n    name: string\n}\n\nexport interface AddOrgUpdateNameSuccess {\n    type: ActionFlag.ADD_ORG_UPDATE_NAME_SUCCESS,\n    name: string\n}\n\nexport interface AddOrgUpdateNameError extends Action {\n    type: ActionFlag.ADD_ORG_UPDATE_NAME_ERROR,\n    name: string,\n    error: UIError\n}\n\n// Updating gravatar hash field\n\nexport interface AddOrgUpdateGravatarHash extends Action {\n    type: ActionFlag.ADD_ORG_UPDATE_GRAVATAR_HASH,\n    name: string\n}\n\nexport interface AddOrgUpdateGravatarHashSuccess {\n    type: ActionFlag.ADD_ORG_UPDATE_GRAVATAR_HASH_SUCCESS,\n    gravatarHash: string\n}\n\nexport interface AddOrgUpdateGravatarHashError extends Action {\n    type: ActionFlag.ADD_ORG_UPDATE_GRAVATAR_HASH_ERROR,\n    gravatarHash: string,\n    error: UIError\n}\n\n// Updating id Field\n\nexport interface AddOrgUpdateId extends Action {\n    type: ActionFlag.ADD_ORG_UPDATE_ID,\n    id: string\n}\n\nexport interface AddOrgUpdateIdSuccess {\n    type: ActionFlag.ADD_ORG_UPDATE_ID_SUCCESS,\n    id: string\n}\n\nexport interface AddOrgUpdateIdError extends Action {\n    type: ActionFlag.ADD_ORG_UPDATE_ID_ERROR,\n    id: string,\n    error: UIError\n}\n\n// Updating description field\n\nexport interface AddOrgUpdateDescription extends Action {\n    type: ActionFlag.ADD_ORG_UPDATE_DESCRIPTION,\n    description: string\n}\n\nexport interface AddOrgUpdateDescriptionSuccess {\n    type: ActionFlag.ADD_ORG_UPDATE_DESCRIPTION_SUCCESS,\n    description: string\n}\n\nexport interface AddOrgUpdateDescriptionError extends Action {\n    type: ActionFlag.ADD_ORG_UPDATE_DESCRIPTION_ERROR,\n    description: string,\n    error: UIError\n}\n\n\n// ACTION CREATORS\n\nexport function addOrgStart(): AddOrgStart {\n    return {\n        type: ActionFlag.ADD_ORG_START\n    }\n}\n\nexport function addOrgSuccess(org: Organization): AddOrgSuccess {\n    return {\n        type: ActionFlag.ADD_ORG_SUCCESS,\n        organization: org\n    }\n}\n\nexport function addOrgError(error: AppError): AddOrgError {\n    return {\n        type: ActionFlag.ADD_ORG_ERROR,\n        error: error\n    }\n}\n\nexport function addOrgEditStart() {\n    return {\n        type: ActionFlag.ADD_ORG_EDIT_START\n    }\n}\n\nexport function addOrgEditFinish() {\n    return {\n        type: ActionFlag.ADD_ORG_EDIT_FINISH\n    }\n}\n\n// Evaluate\n\nexport function addOrgEvaluateOk(): AddOrgEvaluateOK {\n    return {\n        type: ActionFlag.ADD_ORG_EVALUATE_OK\n    }\n}\n\nexport function AddOrgEvaluateErrors(): AddOrgEvaluateErrors {\n    return {\n        type: ActionFlag.ADD_ORG_EVALUATE_ERRORS\n    }\n}\n\n// Update Name\n\nexport function addOrgUpdateNameSuccess(name: string): AddOrgUpdateNameSuccess {\n    return {\n        type: ActionFlag.ADD_ORG_UPDATE_NAME_SUCCESS,\n        name: name\n    }\n}\n\nexport function addOrgUpdateNameError(name: string, error: UIError): AddOrgUpdateNameError {\n    return {\n        type: ActionFlag.ADD_ORG_UPDATE_NAME_ERROR,\n        name: name,\n        error: error\n    }\n}\n\nexport function addOrgUpdateIdSuccess(id: string): AddOrgUpdateIdSuccess {\n    return {\n        type: ActionFlag.ADD_ORG_UPDATE_ID_SUCCESS,\n        id: id\n    }\n}\n\n// Update Gravatar Hash\n\nexport function addOrgUpdateGravatarHashSuccess(gravatarHash: string): AddOrgUpdateGravatarHashSuccess {\n    return {\n        type: ActionFlag.ADD_ORG_UPDATE_GRAVATAR_HASH_SUCCESS,\n        gravatarHash: gravatarHash\n    }\n}\n\nexport function addOrgUpdateGravatarHashError(gravatarHash: string, error: UIError): AddOrgUpdateGravatarHashError {\n    return {\n        type: ActionFlag.ADD_ORG_UPDATE_GRAVATAR_HASH_ERROR,\n        gravatarHash: gravatarHash,\n        error: error\n    }\n}\n\n\n// Update Id\n\nexport function addOrgUpdateIdError(id: string, error: UIError): AddOrgUpdateIdError {\n    return {\n        type: ActionFlag.ADD_ORG_UPDATE_ID_ERROR,\n        id: id,\n        error: error\n    }\n}\n\nexport function addOrgUpdateDescriptionSuccess(description: string): AddOrgUpdateDescriptionSuccess {\n    return {\n        type: ActionFlag.ADD_ORG_UPDATE_DESCRIPTION_SUCCESS,\n        description: description\n    }\n}\n\nexport function addOrgUpdateDescriptionError(description: string, error: UIError): AddOrgUpdateDescriptionError {\n    return {\n        type: ActionFlag.ADD_ORG_UPDATE_DESCRIPTION_ERROR,\n        description: description,\n        error: error\n    }\n}\n\n// ACTION THUNKS\n\nexport function addOrgEdit() {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(addOrgEditStart())\n        dispatch(addOrgEvaluate())\n    }\n}\n\nexport function addOrg() {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(addOrgStart())\n\n        const { auth: { authorization: { token, username } },\n            addOrg: { newOrganization },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        if (!newOrganization) {\n            dispatch(addOrgError({\n                code: 'app',\n                message: 'The new organization data does not yet exist'\n            }))\n            return;\n        }\n\n        model.addOrg(newOrganization, username)\n            .then((org: Organization) => {\n                dispatch(addOrgSuccess(org))\n            })\n            .catch((error) => {\n                console.error('error adding', newOrganization, error)\n                dispatch(addOrgError({\n                    code: 'invalid',\n                    message: error.message\n                }))\n            })\n    }\n}\n\nexport function addOrgEvaluate() {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        const { addOrg: { newOrganization } } = getState()\n\n        const { addOrg: editState } = getState()\n\n        if (!newOrganization) {\n            dispatch(AddOrgEvaluateErrors())\n            return\n        }\n\n        if (newOrganization.name.status !== FieldState.EDITED_OK) {\n            dispatch(AddOrgEvaluateErrors())\n            return\n        }\n\n        if (newOrganization.id.status !== FieldState.EDITED_OK) {\n            dispatch(AddOrgEvaluateErrors())\n            return\n        }\n\n        if (newOrganization.gravatarHash.status !== FieldState.EDITED_OK) {\n            dispatch(AddOrgEvaluateErrors())\n            return\n        }\n\n        if (newOrganization.description.status !== FieldState.EDITED_OK) {\n            dispatch(AddOrgEvaluateErrors())\n            return\n        }\n\n        dispatch(addOrgEvaluateOk())\n    }\n}\n\nfunction newModelFromState(state: StoreState) {\n    const { auth: { authorization: { token, username } },\n        app: { config } } = state\n    return new Model({\n        token, username,\n        groupsServiceURL: config.services.Groups.url,\n        userProfileServiceURL: config.services.UserProfile.url,\n        workspaceServiceURL: config.services.Workspace.url\n    })\n}\n\nexport function addOrgUpdateName(name: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>) => {\n        const [validatedName, error] = Validation.validateOrgName(name)\n\n        if (error.type === UIErrorType.ERROR) {\n            dispatch(addOrgUpdateNameError(validatedName, error))\n        } else {\n            dispatch(addOrgUpdateNameSuccess(validatedName))\n        }\n        dispatch(addOrgEvaluate())\n    }\n}\n\nexport function addOrgUpdateGravatarHash(name: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>) => {\n        const [validateGravatarHash, error] = Validation.validateOrgGravatarHash(name)\n\n        if (error.type === UIErrorType.ERROR) {\n            dispatch(addOrgUpdateGravatarHashError(validateGravatarHash, error))\n        } else {\n            dispatch(addOrgUpdateGravatarHashSuccess(validateGravatarHash))\n        }\n        dispatch(addOrgEvaluate())\n    }\n}\n\nexport function addOrgUpdateId(id: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        const [validatedId, error] = Validation.validateOrgId(id)\n        if (error.type === UIErrorType.ERROR) {\n            dispatch(addOrgUpdateIdError(validatedId, error))\n            dispatch(addOrgEvaluate())\n            return\n        }\n        const model = newModelFromState(getState())\n        model.groupExists(validatedId)\n            .then((exists) => {\n                if (exists) {\n                    dispatch(addOrgUpdateIdError(validatedId, {\n                        type: UIErrorType.ERROR,\n                        message: 'This org id is already in use'\n                    }))\n                } else {\n                    dispatch(addOrgUpdateIdSuccess(validatedId))\n                }\n\n                dispatch(addOrgEvaluate())\n            })\n    }\n}\n\nexport function addOrgUpdateDescription(description: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>,\n        getState: () => StoreState) => {\n        const { auth: { authorization: { token, username } },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n        const [validatedDescription, error] = model.validateOrgDescription(description)\n\n        if (error.type === UIErrorType.ERROR) {\n            dispatch(addOrgUpdateDescriptionError(validatedDescription, error))\n        } else {\n            dispatch(addOrgUpdateDescriptionSuccess(validatedDescription))\n        }\n        dispatch(addOrgEvaluate())\n    }\n}","import * as React from 'react'\nimport { Redirect } from 'react-router-dom';\nimport marked from 'marked';\nimport { Button, Icon, Modal } from 'antd';\nimport md5 from 'md5'\n\nimport { EditableOrganization, SaveState, ValidationState, EditState } from '../../types';\n\nimport './NewOrganization.css'\n\n\nimport Header from '../Header';\n\nexport interface NewOrganizationProps {\n    editState: EditState,\n    saveState: SaveState,\n    validationState: ValidationState,\n    newOrganization: EditableOrganization,\n    onAddOrgEdit: () => void,\n    onAddOrg: () => void,\n    onUpdateName: (name: string) => void,\n    onUpdateGravatarHash: (gravatarHash: string) => void;\n    onUpdateId: (id: string) => void,\n    onUpdateDescription: (description: string) => void\n}\n\n\nexport interface NewOrganizationState {\n    cancelToBrowser: boolean;\n}\n\nclass NewOrganization extends React.Component<NewOrganizationProps, NewOrganizationState> {\n\n    origin: string;\n    gravatarEmail: React.RefObject<HTMLInputElement>\n\n    constructor(props: NewOrganizationProps) {\n        super(props)\n\n        this.state = {\n            cancelToBrowser: false\n        }\n\n        this.gravatarEmail = React.createRef()\n\n        this.origin = document.location!.origin\n\n        this.props.onAddOrgEdit()\n    }\n\n    onShowInfo() {\n        Modal.info({\n            title: 'New Organization Help',\n            width: '50em',\n            content: (\n                <div>\n                    <p>\n                        As a KBase user, you may create your own organizations.\n                    </p>\n                    <p>\n                        Once you have created an Organization, you will be the sole owner of it, forever.\n                    </p>\n                    <p>\n                        In order to create an Org, you need to complete the following fields.\n                    </p>\n                    <dl>\n                        <dt>\n                            name\n                        </dt>\n                        <dd>\n                            The organization <i>name</i> is whatever you wish to have your Org known as. It may be\n                            composed of any text (including unicode characters) up to 200 characters in length. You\n                            may also change it at any time.\n                        </dd>\n                        <dt>\n                            gravatar\n                        </dt>\n                        <dd>\n                            You should associate your Organization with an avatar hosted with the Gravatar service. To do so,\n                            simply enter the email address associated with your gravatar into the first\n                        </dd>\n                        <dt>\n                            id\n                        </dt>\n                        <dd>\n                            <p>\n                                Your Org <i>id</i> forms a url endpoint for your org as well as the identifier used throughout\n                            KBase to, well, identify your organization uniquely among all current and future organizations.\n                            As such, the Org ID may not be changed once created.\n                            </p>\n                            <p>\n                                The id may only be composed of the restricted characters a-Z, A-Z, 0-9 and _, and is also\n                                restricted to 100 characters in length.\n                            </p>\n\n                        </dd>\n                        <dt>\n                            description\n                        </dt>\n                        <dd>\n                            <p>\n                                Up to 4000 characters, a description allows you to express to other KBase users the purpose,\n                            history, associations, and science domain of your Org.</p>\n                            <p>\n                                The description is in \"markdown\" format, and the editor will show you a preview of the\n                                rendered description.\n                            </p>\n                        </dd>\n                    </dl>\n                </div>\n            )\n        })\n    }\n\n    onGravatarEmailSync() {\n        let email;\n        if (this.gravatarEmail.current) {\n            email = this.gravatarEmail.current.value\n        } else {\n            email = 'n/a'\n        }\n        const hashed = md5(email)\n        this.props.onUpdateGravatarHash(hashed);\n    }\n\n    onClickCancelToBrowser() {\n        if (!this.isModified()) {\n            this.setState({ cancelToBrowser: true })\n            return\n        }\n\n        const confirm = () => {\n            this.setState({ cancelToBrowser: true })\n        }\n        const cancel = () => {\n        }\n        Modal.confirm({\n            title: 'Leave the editor?',\n            content: (\n                <div>\n                    <p>You have entered information for this new organization.</p>\n\n                    <p>If you leave the editor without first saving, the new organization <i>will not be created</i>.</p>\n\n                    <p><b>Continue to leave the editor?</b></p>\n                </div>\n            ),\n            onOk: confirm,\n            onCancel: cancel,\n            okText: 'Yes',\n            cancelText: 'No'\n        })\n    }\n\n    onSubmit(e: React.FormEvent<HTMLFormElement>) {\n        e.preventDefault();\n        this.props.onAddOrg();\n    }\n\n    onNameChange(e: React.ChangeEvent<HTMLInputElement>) {\n        e.persist();\n        this.props.onUpdateName(e.target.value);\n    }\n\n    onGravatarHashChange(e: React.ChangeEvent<HTMLInputElement>) {\n        e.persist();\n        this.props.onUpdateGravatarHash(e.target.value);\n    }\n\n    onDescriptionChange(e: React.ChangeEvent<HTMLTextAreaElement>): void {\n        e.persist()\n        this.props.onUpdateDescription(e.target.value);\n    }\n\n    onIdChange(e: React.ChangeEvent<HTMLInputElement>) {\n        e.persist();\n        this.props.onUpdateId(e.target.value);\n    }\n\n    canSave() {\n        return (\n            this.props.editState === EditState.EDITED &&\n            this.props.validationState === ValidationState.VALID &&\n            (this.props.saveState === SaveState.NEW ||\n                this.props.saveState === SaveState.READY ||\n                this.props.saveState === SaveState.SAVED)\n        )\n    }\n\n    isModified() {\n        return (\n            this.props.editState === EditState.EDITED &&\n            this.props.saveState === SaveState.NEW\n        )\n    }\n\n    renderForm() {\n        return (\n            <form id=\"newOrganizationForm\" className=\"editor\" onSubmit={this.onSubmit.bind(this)}>\n                <div className=\"row\">\n                    <div className=\"col1 field-label\">name</div>\n                    <div className=\"col2\">\n                        <input value={this.props.newOrganization.name.value || ''}\n                            onChange={this.onNameChange.bind(this)} />\n                        {this.props.newOrganization.name.error ? (<span style={{ color: 'red' }}>{this.props.newOrganization.name.error.message}</span>) : ''}\n                    </div>\n                </div>\n                <div className=\"row gravatarHash\">\n                    <div className=\"col1 field-label\">gravatar hash</div>\n                    <div className=\"col2\">\n                        <div style={{ display: 'flex', flexDirection: 'row', marginBottom: '4px' }}>\n                            <div style={{ flex: '1 1 0px' }}>\n                                <input ref={this.gravatarEmail} placeholder=\"Provide your gravatar-linked email address, if any\" />\n                            </div>\n                            <div style={{ flex: '0 0 auto' }}>\n                                <Button\n                                    icon=\"arrow-down\"\n                                    style={{ height: '100%' }}\n                                    onClick={this.onGravatarEmailSync.bind(this)} />\n                            </div>\n                        </div>\n                        <input value={this.props.newOrganization.gravatarHash.value || ''}\n                            onChange={this.onGravatarHashChange.bind(this)} />\n                        {this.props.newOrganization.gravatarHash.error ? (<span style={{ color: 'red' }}>{this.props.newOrganization.gravatarHash.error.message}</span>) : ''}\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col1 field-label\">id</div>\n                    <div className=\"col2\">\n                        <input value={this.props.newOrganization.id.value || ''}\n                            onChange={this.onIdChange.bind(this)} />\n                        {this.props.newOrganization.id.error ? (<span style={{ color: 'red' }}>{this.props.newOrganization.id.error.message}</span>) : ''}\n                    </div>\n                </div>\n                <div className=\"row\" style={{ flex: '1 1 0px', minHeight: '30em', maxHeight: '60em' }}>\n                    <div className=\"col1 field-label\">description</div>\n                    <div className=\"col2\">\n                        <textarea value={this.props.newOrganization.description.value || ''}\n                            onChange={this.onDescriptionChange.bind(this)} />\n                        {this.props.newOrganization.description.error ? (<div style={{ color: 'red' }}>{this.props.newOrganization.description.error.message}</div>) : ''}\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col1\"></div>\n                    <div className=\"col2\">\n                        {/* <div className=\"footer\">\n                            <Button form=\"newOrganizationForm\"\n                                key=\"submit\"\n                                htmlType=\"submit\">Save</Button>\n                            <Button type=\"danger\"\n                                onClick={this.onClickCancel.bind(this)}>Cancel</Button>\n                        </div> */}\n                    </div>\n                </div>\n            </form>\n        )\n    }\n\n    getOrgAvatarUrl(org: EditableOrganization) {\n        // const defaultImages = [\n        //     'orgs-64.png',\n        //     'unicorn-64.png'\n        // ]\n        // if (!org.gravatarHash.value) {\n        //     return defaultImages[Math.floor(Math.random() * 2)]\n        // }\n        if (!org.gravatarHash.value) {\n            return 'unicorn-64.png'\n        }\n        const gravatarDefault = 'identicon';\n\n        return 'https://www.gravatar.com/avatar/' + org.gravatarHash.value + '?s=64&amp;r=pg&d=' + gravatarDefault;\n    }\n\n    renderOrgAvatar(org: EditableOrganization) {\n        return (\n            <img style={{ width: 64, height: 64 }}\n                src={this.getOrgAvatarUrl(org)} />\n        )\n    }\n\n    renderPreview() {\n        return <form className=\"preview\">\n            <div className=\"row\">\n                <div className=\"col2\">\n                    <div className=\"name\">\n                        {this.props.newOrganization.name.value || ''}\n                    </div>\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"col2\">\n                    <div className=\"gravatarHash\">\n                        {this.renderOrgAvatar(this.props.newOrganization)}\n                    </div>\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"col2\">\n                    <div className=\"id\">\n                        <span style={{ color: 'silver' }}>{this.origin}/#orgs/organizations/</span>\n                        {this.props.newOrganization.id.value || (<span style={{ fontStyle: 'italic' }}>organization id here</span>)}\n                    </div>\n                </div>\n            </div>\n            <div className=\"row\" style={{ flex: '1 1 0px' }}>\n                <div className=\"col2\">\n                    <div className=\"description\"\n                        dangerouslySetInnerHTML={({ __html: marked(this.props.newOrganization.description.value || '') })}\n                    />\n                </div>\n            </div>\n        </form>\n    }\n\n    renderState() {\n        const { editState, validationState, saveState } = this.props;\n        const label = 'edit: ' + editState + ', valid: ' + validationState + ', save: ' + saveState\n        return (\n            <span style={{ marginRight: '10px' }}>{label}</span>\n        )\n    }\n\n    renderHeader() {\n        const orgName = this.props.newOrganization!.name.value || (<span style={{ fontStyle: 'italic', color: 'gray' }}>org name will appear here when you edit the name field</span>)\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            {/* <FaPlusCircle style={{ verticalAlign: 'middle' }} /> */}\n                            <Icon type=\"plus-circle\" />\n                            {' '}\n                            Adding a New Org \"\n                            {orgName}\n                            \"\n                        </span>\n                    </div>\n                    <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', justifyContent: 'flex-end', alignItems: 'center' }}>\n                        {/* {this.renderState()} */}\n                        <Button icon=\"save\"\n                            form=\"newOrganizationForm\"\n                            key=\"submit\"\n                            disabled={!this.canSave.call(this)}\n                            htmlType=\"submit\">\n                            {/* <Icon type=\"save\" /> */}\n                            {/* <FaSave style={{ verticalAlign: 'center' }} /> */}\n                            Save\n                        </Button>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToBrowser.bind(this)}>\n                            {/* <FaUndo style={{ verticalAlign: 'center' }} />  */}\n                            Return to Orgs Browser\n                        </Button>\n                        <Button shape=\"circle\" icon=\"info\" onClick={this.onShowInfo.bind(this)}></Button>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    renderLoadingHeader() {\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            Loading New Org Editor...\n                        </span>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    render() {\n        if (this.state.cancelToBrowser) {\n            return <Redirect push to=\"/organizations\" />\n        }\n\n        // TODO: this is just a prop for today.\n        if (this.props.saveState === SaveState.SAVED) {\n            return <Redirect push to={\"/editOrganization/\" + this.props.newOrganization.id.value} />\n        }\n\n        if (!this.props.newOrganization) {\n            return (\n                <div className=\"NewOrganization\">\n                    {this.renderLoadingHeader()}\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"NewOrganization\">\n                {this.renderHeader()}\n                <div className=\"mainRow\">\n                    <div className=\"editorColumn\">\n                        <h3>Editor</h3>\n                        {this.renderForm()}\n                    </div>\n                    <div className=\"previewColumn\">\n                        <h3>Preview</h3>\n                        {this.renderPreview()}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default NewOrganization","import { Dispatch } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { StoreState } from '../../types';\nimport {\n    AddOrg, addOrg,\n    addOrgUpdateName, addOrgUpdateId, addOrgUpdateDescription, addOrgEdit, addOrgUpdateGravatarHash\n} from '../../redux/actions/addOrg';\n\nimport NewOrganization from './NewOrganization';\n\ninterface OwnProps {\n}\n\nexport interface StateProps {\n}\n\nexport interface DispatchProps {\n    onAddOrg: () => void,\n    onAddOrgEdit: () => void,\n    onUpdateName: (name: string) => void,\n    onUpdateGravatarHash: (gravatarHash: string) => void,\n    onUpdateId: (id: string) => void,\n    onUpdateDescription: (description: string) => void\n}\n\nexport function mapStateToProps({ addOrg: { editState, saveState, validationState, newOrganization } }: StoreState): StateProps {\n    return {\n        editState,\n        saveState,\n        validationState,\n        newOrganization\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<AddOrg>): DispatchProps {\n    return {\n        onAddOrgEdit: () => {\n            dispatch(addOrgEdit() as any)\n        },\n        onAddOrg: () => {\n            dispatch(addOrg() as any)\n        },\n        onUpdateName: (name) => {\n            dispatch(addOrgUpdateName(name) as any)\n        },\n        onUpdateGravatarHash: (gravatarHash: string) => {\n            dispatch(addOrgUpdateGravatarHash(gravatarHash) as any)\n        },\n        onUpdateId: (id) => {\n            dispatch(addOrgUpdateId(id) as any)\n        },\n        onUpdateDescription: (description) => {\n            dispatch(addOrgUpdateDescription(description) as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(mapStateToProps, mapDispatchToProps)(NewOrganization)","import * as React from 'react'\nimport { Organization, UserRelationToOrganization, MembershipRequestPendingRelation } from '../../types';\nimport { Avatar } from '../Avatar';\nimport { Icon, Tooltip, Button, message, Menu, Dropdown } from 'antd';\n\nimport './style.css'\nimport { NavLink, Redirect } from 'react-router-dom';\n\nexport interface OrganizationHeaderProps {\n    organization: Organization\n    onCancelJoinRequest: (requestId: string) => void\n    onAcceptInvitation: (requestId: string) => void\n    onRejectInvitation: (requestId: string) => void\n    onJoinOrg: () => void\n}\n\ninterface OrganizationHeaderState {\n    navigateTo: NavigateTo\n}\n\nenum NavigateTo {\n    NONE = 0,\n    MANAGE_MEMBERSHIP,\n    VIEW_MEMBERS,\n    MANAGE_REQUESTS,\n    VIEW_ORGANIZATION,\n    EDIT_ORGANIZATION\n}\n\nexport class OrganizationHeader extends React.Component<OrganizationHeaderProps, OrganizationHeaderState> {\n    constructor(props: OrganizationHeaderProps) {\n        super(props)\n\n        this.state = {\n            navigateTo: NavigateTo.NONE\n        }\n    }\n\n    onJoinClick() {\n        this.props.onJoinOrg()\n        message.success('Join request has been submitted')\n    }\n\n    onCancelJoinRequest() {\n        const relation = this.props.organization.relation as MembershipRequestPendingRelation\n        this.props.onCancelJoinRequest(relation.requestId)\n        message.success('Submitted cancellation request')\n    }\n\n    onAcceptInvitation() {\n        const relation = this.props.organization.relation as MembershipRequestPendingRelation\n        this.props.onAcceptInvitation(relation.requestId)\n        message.success('Invitation acceptance has been sent')\n    }\n\n    onRejectInvitation() {\n        const relation = this.props.organization.relation as MembershipRequestPendingRelation\n        this.props.onRejectInvitation(relation.requestId)\n        message.success('Invitation rejection has been sent')\n    }\n\n    onNavigateToMembership() {\n        this.setState({ navigateTo: NavigateTo.MANAGE_MEMBERSHIP })\n    }\n\n    onNavigateToViewMembers() {\n        this.setState({ navigateTo: NavigateTo.VIEW_MEMBERS })\n    }\n\n    onNavigateToManageRequests() {\n        this.setState({ navigateTo: NavigateTo.MANAGE_REQUESTS })\n    }\n\n    onNavigateToEditOrganization() {\n        this.setState({ navigateTo: NavigateTo.EDIT_ORGANIZATION })\n    }\n\n    renderOwnerInfo() {\n        const org = this.props.organization\n        return (\n            <div className=\"ownerTable\">\n                <div className=\"avatarCol\">\n                    <Avatar user={org.owner.user} size={60} />\n                </div>\n                <div className=\"proprietorCol\">\n\n                    <div className=\"owner\">\n                        <a href={\"#people/\" + org.owner.user.username} target=\"_blank\">{org.owner.user.realname}</a>\n                        {' '}\n                        {org.owner.user.username}\n                    </div>\n                    <div className=\"profileOrganization\">\n                        {org.owner.user.organization}\n                    </div>\n                    <div className=\"profileOrganization\">\n                        {org.owner.user.city}, {org.owner.user.state}, {org.owner.user.country}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    getOrgAvatarUrl(org: Organization) {\n        // const defaultImages = [\n        //     'orgs-64.png',\n        //     'unicorn-64.png'\n        // ]\n        // if (!org.gravatarHash) {\n        //     return defaultImages[Math.floor(Math.random() * 2)]\n        // }\n        if (!org.gravatarHash) {\n            return 'unicorn-64.png'\n        }\n        const gravatarDefault = 'identicon';\n\n        return 'https://www.gravatar.com/avatar/' + org.gravatarHash + '?s=64&amp;r=pg&d=' + gravatarDefault;\n    }\n\n    renderOrgAvatar(org: Organization) {\n        return (\n            <img style={{ width: 64, height: 64 }}\n                src={this.getOrgAvatarUrl(this.props.organization)} />\n        )\n    }\n\n    renderRelation() {\n        const org = this.props.organization\n        switch (org.relation.type) {\n            case (UserRelationToOrganization.NONE):\n                return (\n                    <span><Icon type=\"stop\" />None</span>\n                )\n            case (UserRelationToOrganization.VIEW):\n                return (\n                    <div>\n                        <Tooltip\n                            placement=\"bottomRight\"\n                            mouseEnterDelay={0.5}\n                            title=\"You are not a member of this org, but you may access it, you may request membership\"\n                        >\n                            <div style={{ textAlign: 'center' }}>\n                                <Icon type=\"eye\" style={{ marginRight: '4px' }} />You are not a member of this Organization\n                        </div>\n                        </Tooltip>\n                        <div style={{ textAlign: 'center' }}>\n                            <Button\n                                type=\"primary\"\n                                onClick={this.onJoinClick.bind(this)}>\n                                Join this Organization\n                            </Button>\n                        </div>\n                    </div>\n\n                )\n            case (UserRelationToOrganization.MEMBER_REQUEST_PENDING):\n                return (\n                    <div>\n                        <Tooltip\n                            placement=\"bottomRight\"\n                            mouseEnterDelay={0.5}\n                            title=\"You have requested membership in this Organization\"\n                        ><div>\n                                <Icon type=\"user\" style={{ color: 'orange' }} spin={true} />\n                                Your membership <b>request</b> is pending\n                    {' '}\n                                <Icon type=\"question-circle\" />\n                            </div>\n                        </Tooltip>\n                        <div style={{ textAlign: 'center' }}>\n                            <Button icon=\"delete\" type=\"danger\" onClick={this.onCancelJoinRequest.bind(this)}>Cancel Request</Button>\n                        </div>\n                    </div>\n\n                )\n            case (UserRelationToOrganization.MEMBER_INVITATION_PENDING):\n                return (\n                    <Tooltip\n                        placement=\"bottomRight\"\n                        mouseEnterDelay={0.5}\n                        title=\"You have been invited to join this Organization\"\n                    >\n                        <div><Icon type=\"user\" style={{ color: 'blue' }} />You have been <b>invited</b> to join this Organization</div>\n                        <div style={{ textAlign: 'center' }}>\n                            <Button icon=\"check\" type=\"default\" onClick={this.onAcceptInvitation.bind(this)}>Accept Invitation</Button>\n                            <Button icon=\"stop\" type=\"danger\" onClick={this.onRejectInvitation.bind(this)}>Reject Invitation</Button>\n                        </div>\n                    </Tooltip>\n                )\n            case (UserRelationToOrganization.MEMBER):\n                const menu = (\n                    <Menu>\n                        <Menu.Item key=\"manageMyMembership\" onClick={this.onNavigateToMembership.bind(this)}>\n                            Manage My Membership\n                        </Menu.Item>\n                    </Menu>\n                )\n                return (\n                    <div className=\"relationRow\">\n                        <div className=\"relationLabel\">\n                            <Tooltip\n                                placement=\"bottomRight\"\n                                mouseEnterDelay={0.5}\n                                title=\"You are a member of this organization\"\n                            >\n                                <div><Icon type=\"user\" />You are a <b>member</b> of this Organization</div>\n                            </Tooltip>\n                        </div>\n                        <div className=\"relationMenu\">\n                            <div>\n                                <Dropdown overlay={menu} trigger={['click']}>\n                                    <Button shape=\"circle\">\n                                        <Icon type=\"setting\" theme=\"filled\" style={{ fontSize: '120%' }} />\n                                    </Button>\n                                </Dropdown>\n                            </div>\n                        </div>\n                        {/* <div style={{ textAlign: 'center' }}>\n                            <Button type=\"default\">Manage your Profile</Button>\n                        </div> */}\n                    </div>\n                )\n            case (UserRelationToOrganization.ADMIN):\n                const adminMenu = (\n                    <Menu>\n                        <Menu.Item key=\"manageMyMembership\" onClick={this.onNavigateToMembership.bind(this)}>\n                            Manage My Membership\n                        </Menu.Item>\n                        <Menu.Item key=\"viewMembers\" onClick={this.onNavigateToViewMembers.bind(this)}>\n                            Members\n                        </Menu.Item>\n                        <Menu.Item key=\"manageRequests\" onClick={this.onNavigateToManageRequests.bind(this)}>\n                            Requests and Invitations\n                        </Menu.Item>\n                        <Menu.Item key=\"editOrg\" onClick={this.onNavigateToEditOrganization.bind(this)}>\n                            Edit this Org\n                        </Menu.Item>\n                    </Menu>\n                )\n                return (\n                    <div className=\"relationRow\">\n                        <div className=\"relationLabel\">\n                            <Tooltip\n                                placement=\"bottomRight\"\n                                mouseEnterDelay={0.5}\n                                title=\"You are and Administrator for this group\"\n                            >\n                                <div><Icon type=\"unlock\" />You are a <b>administrator</b> of this Organization</div>\n                            </Tooltip>\n                        </div>\n                        <div className=\"relationMenu\">\n                            <div>\n                                <Dropdown overlay={adminMenu} trigger={['click']}>\n                                    <Button shape=\"circle\">\n                                        <Icon type=\"setting\" theme=\"filled\" style={{ fontSize: '120%' }} />\n                                    </Button>\n                                </Dropdown>\n                            </div>\n                        </div>\n                        {/* <div style={{ textAlign: 'center' }}>\n                            <Button type=\"default\">Manage your Profile</Button>\n                        </div> */}\n                    </div>\n                )\n            case (UserRelationToOrganization.OWNER):\n                const ownerMenu = (\n                    <Menu>\n                        <Menu.Item key=\"viewMembers\" onClick={this.onNavigateToViewMembers.bind(this)}>\n                            Members\n                        </Menu.Item>\n                        <Menu.Item key=\"manageRequests\" onClick={this.onNavigateToManageRequests.bind(this)}>\n                            Requests and Invitations\n                        </Menu.Item>\n                        <Menu.Item key=\"editOrg\" onClick={this.onNavigateToEditOrganization.bind(this)}>\n                            Edit this Org\n                        </Menu.Item>\n                    </Menu>\n                )\n                return (\n                    <div className=\"relationRow\">\n                        <div className=\"relationLabel\">\n                            <Tooltip\n                                placement=\"bottomRight\"\n                                mouseEnterDelay={0.5}\n                                title=\"You own this group\"\n                            >\n                                <div>\n                                    <Icon type=\"crown\" style={{ color: 'gold' }} />\n                                    {' '}\n                                    You <b>own</b> this Organization\n                                    </div>\n                            </Tooltip>\n                        </div>\n                        <div className=\"relationMenu\">\n                            <div>\n                                <Dropdown overlay={ownerMenu} trigger={['click']}>\n                                    <Button shape=\"circle\">\n                                        <Icon type=\"setting\" theme=\"filled\" style={{ fontSize: '120%' }} />\n                                    </Button>\n                                </Dropdown>\n                            </div>\n                        </div>\n                        {/* <div style={{ textAlign: 'center' }}>\n                        <Button type=\"default\">Manage your Profile</Button>\n                    </div> */}\n                    </div>\n                )\n        }\n    }\n\n    renderOrgInfo() {\n        const org = this.props.organization\n        return (\n            <div>\n                <div className=\"name\">\n                    {org.name}\n                </div>\n                {/* <div className=\"id\">\n                    <span className=\"label\">permalink</span>{' '}\n                    <span className=\"permalinkBase\">https://narrative.kbase.us#orgs/</span>{org.id}\n                </div> */}\n                <div className=\"owner\">\n                    <span className=\"field-label\">owner</span>\n                    <a href={\"#people/\" + org.owner.user.username} target=\"_blank\">{org.owner.user.realname}</a>\n                    {' '}\n                    {org.owner.user.username}\n                                </div>\n            </div>\n        )\n    }\n\n    getRelationClass(org: Organization) {\n        switch (org.relation.type) {\n            case (UserRelationToOrganization.NONE):\n                return 'relationRequest'\n            case (UserRelationToOrganization.VIEW):\n                return 'relationRequest relationNonMember'\n            case (UserRelationToOrganization.MEMBER_REQUEST_PENDING):\n                return 'relationRequest relationRequestPending'\n            case (UserRelationToOrganization.MEMBER_INVITATION_PENDING):\n                return 'relationRequest relationInvitationPending'\n            case (UserRelationToOrganization.MEMBER):\n                return 'relationRequest relationMember'\n            case (UserRelationToOrganization.ADMIN):\n                return 'relationRequest relationAdmin'\n            case (UserRelationToOrganization.OWNER):\n                return 'relationRequest relationOwner'\n        }\n    }\n\n    render() {\n        // apparently TS is not smart enough to know this from the conditional branch in render()!\n        switch (this.state.navigateTo) {\n            case NavigateTo.MANAGE_MEMBERSHIP:\n                return <Redirect push to={\"/membership/\" + this.props.organization.id} />\n            case NavigateTo.VIEW_MEMBERS:\n                return <Redirect push to={\"/viewMembers/\" + this.props.organization.id} />\n            case NavigateTo.EDIT_ORGANIZATION:\n                return <Redirect push to={\"/editOrganization/\" + this.props.organization.id} />\n            case NavigateTo.MANAGE_REQUESTS:\n                return <Redirect push to={\"/manageOrganizationRequests/\" + this.props.organization.id} />\n            default:\n            // nothing, fall through\n        }\n\n        return (\n            <div className=\"OrganizationHeader\">\n                <div className=\"avatar\">\n                    {this.renderOrgAvatar(this.props.organization)}\n                </div>\n                <div className=\"orgInfo\">\n                    {this.renderOrgInfo()}\n                </div>\n                {/* <div className=\"ownerInfo\">\n                    {this.renderOwnerInfo()}\n                </div> */}\n                <div className={\"yourRelation \" + this.getRelationClass(this.props.organization)}>\n                    {this.renderRelation()}\n                </div>\n\n            </div>\n        )\n    }\n}\n\nexport default OrganizationHeader","import * as React from 'react'\nimport './Avatar.css'\n\nimport { User } from '../types'\n\nexport interface AvatarProps {\n    user: User,\n    size: number\n}\n\ninterface AvatarState {\n\n}\n\nexport class Avatar extends React.Component<AvatarProps, AvatarState> {\n    constructor(props: AvatarProps) {\n        super(props)\n    }\n\n    getAvatarUrl(user: User) {\n        switch (user.avatarOption || 'gravatar') {\n            case 'gravatar':\n                const gravatarDefault = user.gravatarDefault || 'identicon';\n                const gravatarHash = user.gravatarHash;\n                if (gravatarHash) {\n                    return 'https://www.gravatar.com/avatar/' + gravatarHash + '?s=60&amp;r=pg&d=' + gravatarDefault;\n                } else {\n                    return './nouserpic.png';\n                }\n            case 'silhouette':\n            case 'mysteryman':\n            default:\n                return './nouserpic.png';\n        }\n    }\n\n    render() {\n        const avatarUrl = this.getAvatarUrl(this.props.user)\n        return (\n            <img\n                src={avatarUrl}\n                style={{ width: this.props.size }}\n            />\n        )\n    }\n\n}\n\nexport default Avatar","import * as React from 'react'\nimport './Member.css'\n\nimport Avatar from './Avatar'\nimport * as types from '../types';\nimport { Icon } from 'antd';\n\nexport interface MemberProps {\n    member: types.Member\n    avatarSize?: number\n    key: string\n}\n\ninterface MemberState {\n\n}\n\nclass Member extends React.Component<MemberProps, MemberState> {\n    constructor(props: MemberProps) {\n        super(props)\n    }\n\n    renderRole() {\n        switch (this.props.member.type) {\n            case types.MemberType.OWNER:\n                return (\n                    <span>\n                        <Icon type=\"crown\" /> owner\n                </span>\n                )\n            case types.MemberType.ADMIN:\n                return (\n                    <span>\n                        <Icon type=\"unlock\" /> admin\n                </span>\n                )\n            case types.MemberType.MEMBER:\n                return (\n                    <span>\n                        <Icon type=\"user\" /> member\n                </span>\n                )\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"Member\" key={this.props.key}>\n                <div className=\"avatarCol\">\n                    <Avatar user={this.props.member.user} size={this.props.avatarSize || 30} />\n                </div>\n                <div className=\"infoCol\">\n                    <div className=\"name\">\n                        <a href={\"#people/\" + this.props.member.user.username} target=\"_blank\">{this.props.member.user.realname}</a>\n                        {' '}\n                        {this.props.member.user.username}\n                    </div>\n                    <div className=\"role\">\n                        {this.renderRole()}\n                    </div>\n                    <div className=\"title\">\n                        {this.props.member.user.title || <i>no title in user profile</i>}\n                    </div>\n                    <div className=\"organization\">\n                        {this.props.member.user.organization || <i>no organization in user profile</i>}\n                    </div>\n                    <div className=\"location\">\n                        {[this.props.member.user.city, this.props.member.user.state, this.props.member.user.country].filter(x => x).join(', ') || <i>no location information in user profile</i>}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Member","import { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\n\nimport * as types from '../../types'\n// we steal the view org actions...\nimport * as actions from '../../redux/actions/viewOrg'\n\nimport OrganizationHeader from './component'\n\n// Props for this component\n\n// The interface for this container component\nexport interface OwnProps {\n}\n\n// the interface for mapStateTo props\ninterface StateProps {\n}\n\n// the interface for mapDispatchToProps\ninterface DispatchProps {\n    onJoinOrg: () => void\n    onCancelJoinRequest: (requestId: string) => void\n    onAcceptInvitation: (requestId: string) => void\n    onRejectInvitation: (requestId: string) => void\n}\n\nfunction mapStateToProps(state: types.StoreState, props: OwnProps): StateProps {\n    return {}\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.ViewOrgFetch>): DispatchProps {\n    return {\n        onJoinOrg: () => {\n            dispatch(actions.viewOrgJoinRequest() as any)\n        },\n        onCancelJoinRequest: (requestId: string) => {\n            dispatch(actions.viewOrgCancelJoinRequest(requestId) as any)\n        },\n        onAcceptInvitation: (requestId: string) => {\n            dispatch(actions.acceptJoinInvitation(requestId) as any)\n        },\n        onRejectInvitation: (requestId: string) => {\n            dispatch(actions.rejectJoinInvitation(requestId) as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, types.StoreState>(mapStateToProps, mapDispatchToProps)(OrganizationHeader)\n","import * as React from 'react'\nimport marked from 'marked'\nimport { NavLink } from 'react-router-dom'\n\nimport './ViewOrganization.css'\n\nimport { ViewOrgState, Organization, AppError, UserRelationToOrganization, MembershipRequestPendingRelation } from '../../types'\nimport { Button, Modal, Icon, Tooltip, Card } from 'antd'\nimport Header from '../Header'\nimport Avatar from '../Avatar'\nimport Member from '../Member';\nimport OrganizationHeader from '../organizationHeader/container'\n\nexport interface ViewOrganizationState {\n    showInfo: boolean\n}\n\nexport interface ViewOrganizationProps {\n    state: ViewOrgState\n    id: string\n    organization?: Organization\n    error?: AppError\n    username: string\n    onViewOrg: (id: string) => void\n    onJoinOrg: () => void\n    onCancelJoinRequest: (requestId: string) => void\n    onAcceptInvitation: (requestId: string) => void\n    onRejectInvitation: (requestId: string) => void\n}\n\nclass ViewOrganization extends React.Component<ViewOrganizationProps, ViewOrganizationState> {\n    constructor(props: ViewOrganizationProps) {\n        super(props)\n\n        this.state = {\n            showInfo: false\n        }\n\n        this.props.onViewOrg(this.props.id)\n    }\n\n    onViewMembers() {\n\n    }\n\n    onJoinClick() {\n        this.props.onJoinOrg()\n    }\n\n    onCancelJoinRequest() {\n        if (!this.props.organization) {\n            return\n        }\n        const relation = this.props.organization.relation as MembershipRequestPendingRelation\n        this.props.onCancelJoinRequest(relation.requestId)\n    }\n\n    onAcceptInvitation() {\n        if (!this.props.organization) {\n            return\n        }\n        const relation = this.props.organization.relation as MembershipRequestPendingRelation\n        this.props.onAcceptInvitation(relation.requestId)\n        // console.log('accepting invitation request', relation.requestId)\n    }\n\n    onRejectInvitation() {\n        if (!this.props.organization) {\n            return\n        }\n        const relation = this.props.organization.relation as MembershipRequestPendingRelation\n        this.props.onRejectInvitation(relation.requestId)\n    }\n\n    onShowInfo() {\n        // this.setState({ showInfo: true })\n        Modal.info({\n            title: 'View Organization Help',\n            width: '50em',\n            content: (\n                <div>\n                    <p>This is the organizations viewer...</p>\n                </div>\n            )\n        })\n    }\n\n    buildFooter() {\n        return (\n            <div>\n                {this.renderEditRow()}\n                {/* <p style={{ textAlign: 'center' }}>\n                    You may also  <NavLink to={`/organizations`}><Button type=\"danger\" icon=\"undo\">Return to Orgs</Button></NavLink> to the organizations browser.\n                </p> */}\n            </div>\n        )\n    }\n\n    renderEditRow() {\n        if (this.props.organization!.owner.user.username === this.props.username) {\n            return (\n                <p style={{ textAlign: 'center' }}>\n                    As the owner of this group, you may <NavLink to={`/editOrganization/${this.props.organization!.id}`}><Button icon=\"edit\">Edit</Button></NavLink> it.\n                </p>\n            )\n        }\n    }\n\n    renderEditButton() {\n        if (this.props.organization!.owner.user.username === this.props.username) {\n            return (\n                <NavLink to={`/editOrganization/${this.props.organization!.id}`}><Button icon=\"edit\">Edit</Button></NavLink>\n            )\n        }\n    }\n\n    renderOrg() {\n        // apparently TS is not smart enough to know this from the conditional branch in render()!\n        if (!this.props.organization) {\n            return\n        }\n        return (\n            <div className=\"org\">\n                {/* <div className=\"nameAndLogo\">\n                    <div className=\"avatar\">\n                        {this.renderOrgAvatar(this.props.organization)}\n                    </div>\n                    <div className=\"nameAndLink\">\n                        <div className=\"name\">\n                            {this.props.organization.name}\n                        </div>\n                        <div className=\"id\">\n                            <span className=\"label\">permalink</span>{' '}\n                            <span className=\"permalinkBase\">https://narrative.kbase.us#orgs/</span>{this.props.organization.id}\n                        </div>\n                    </div>\n                </div> */}\n                <div className=\"description\"\n                    dangerouslySetInnerHTML={({ __html: marked(this.props.organization.description || '') })}\n                />\n\n            </div>\n        )\n    }\n\n    renderOwnerInfo(org: Organization) {\n        return (\n            <div className=\"ownerTable\">\n                <div className=\"avatarCol\">\n                    <Avatar user={org.owner.user} size={60} />\n                </div>\n                <div className=\"proprietorCol\">\n\n                    <div className=\"owner\">\n                        <a href={\"#people/\" + org.owner.user.username} target=\"_blank\">{org.owner.user.realname}</a>\n                        {' '}\n                        {org.owner.user.username}\n                                </div>\n                    <div className=\"profileOrganization\">\n                        {org.owner.user.organization}\n                    </div>\n                    <div className=\"profileOrganization\">\n                        {org.owner.user.city}, {org.owner.user.state}, {org.owner.user.country}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    renderOrgHeader() {\n        // apparently TS is not smart enough to know this from the conditional branch in render()!\n        if (!this.props.organization) {\n            return\n        }\n        return (\n            <OrganizationHeader organization={this.props.organization} />\n        )\n        // return (\n        //     <div className=\"orgHeader\">\n        //         <div className=\"avatar\">\n        //             {this.renderOrgAvatar(this.props.organization)}\n        //         </div>\n        //         <div className=\"orgInfo\">\n        //             <div className=\"name\">\n        //                 {this.props.organization.name}\n        //             </div>\n        //             <div className=\"id\">\n        //                 <span className=\"label\">permalink</span>{' '}\n        //                 <span className=\"permalinkBase\">https://narrative.kbase.us#orgs/</span>{this.props.organization.id}\n        //             </div>\n        //         </div>\n        //         <div className=\"ownerInfo\">\n        //             {this.renderOwnerInfo(this.props.organization)}\n        //         </div>\n        //         <div className=\"yourRelation\">\n        //             {this.renderRelation(this.props.organization)}\n        //         </div>\n\n        //     </div>\n        // )\n    }\n\n    getOrgAvatarUrl(org: Organization) {\n        // const defaultImages = [\n        //     'orgs-64.png',\n        //     'unicorn-64.png'\n        // ]\n        // if (!org.gravatarHash) {\n        //     return defaultImages[Math.floor(Math.random() * 2)]\n        // }\n        if (!org.gravatarHash) {\n            return 'unicorn-64.png'\n        }\n        const gravatarDefault = 'identicon';\n\n        return 'https://www.gravatar.com/avatar/' + org.gravatarHash + '?s=64&amp;r=pg&d=' + gravatarDefault;\n    }\n\n    renderOrgAvatar(org: Organization) {\n        return (\n            <img style={{ width: 64, height: 64 }}\n                src={this.getOrgAvatarUrl(org)} />\n        )\n    }\n\n\n    renderRelation(org: Organization) {\n        switch (org.relation.type) {\n            case (UserRelationToOrganization.NONE):\n                return (\n                    <span><Icon type=\"stop\" />None</span>\n                )\n            case (UserRelationToOrganization.VIEW):\n                return (\n                    <Tooltip\n                        placement=\"bottomRight\"\n                        mouseEnterDelay={0.5}\n                        title=\"You are not a member of this org, but you may access it; you may request membership\"\n                    >\n                        <div><Icon type=\"eye\" style={{ marginRight: '4px' }} />You are not a member of this Organization</div>\n                        <div style={{ marginTop: '10px' }}>\n                            <Button\n                                onClick={this.onJoinClick.bind(this)}>\n                                Join this Organization\n                            </Button>\n                        </div>\n                    </Tooltip>\n                )\n            case (UserRelationToOrganization.MEMBER_REQUEST_PENDING):\n                return (\n                    <div>\n                        <div><Icon type=\"user\" style={{ color: 'orange' }} spin={true} />Your membership <b>request</b> is pending</div>\n                        <div><Button icon=\"delete\" type=\"danger\" onClick={this.onCancelJoinRequest.bind(this)}>Cancel Request</Button></div>\n                    </div>\n                )\n            case (UserRelationToOrganization.MEMBER_INVITATION_PENDING):\n                return (\n                    <div>\n                        <div><Icon type=\"user\" style={{ color: 'blue' }} />You have been <b>invited</b> to join this Organization</div>\n                        <div style={{ marginTop: '10px' }}>\n                            <Button icon=\"check\" type=\"default\" onClick={this.onAcceptInvitation.bind(this)}>Accept Invitation</Button>\n                            <Button icon=\"stop\" type=\"danger\" onClick={this.onRejectInvitation.bind(this)}>Reject Invitation</Button>\n                        </div>\n                    </div>\n                )\n            case (UserRelationToOrganization.MEMBER):\n                return (<span><Icon type=\"user\" />Member</span>)\n            case (UserRelationToOrganization.ADMIN):\n                return (<span><Icon type=\"unlock\" />Admin</span>)\n            case (UserRelationToOrganization.OWNER):\n                return (\n                    <Tooltip\n                        placement=\"bottomRight\"\n                        mouseEnterDelay={0.5}\n                        title=\"You own this org\"\n                    >\n                        <span><Icon type=\"unlock\" theme=\"filled\" style={{ marginRight: '4px' }} />You own this organization</span>\n                    </Tooltip>\n                )\n        }\n    }\n\n    isMember(): boolean {\n        if (!this.props.organization) {\n            return false\n        }\n        if (this.props.organization.relation.type === UserRelationToOrganization.OWNER ||\n            this.props.organization.relation.type === UserRelationToOrganization.ADMIN ||\n            this.props.organization.relation.type === UserRelationToOrganization.MEMBER) {\n            return true\n        }\n        return false\n    }\n\n    renderMembers() {\n        if (!this.props.organization) {\n            return\n        }\n        let members;\n        if (!this.isMember()) {\n            return (\n                <i>Sorry, group membership restricted to members only</i>\n            )\n        }\n        if (this.props.organization.members.length === 0) {\n            members = (\n                <p style={{ fontStyle: 'italic', textAlign: 'center' }}>\n                    This organization has no members\n                </p>\n            )\n        } else {\n            members = this.props.organization.members.map((member) => {\n                return (\n                    <Member member={member} avatarSize={50} key={member.user.username} />\n                )\n            })\n        }\n        return (\n            <div className=\"table infoTable\">\n                <div className=\"row\">\n                    <div className=\"col0\">\n                        {members}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    renderInfo() {\n        // apparently TS is not smart enough to know this from the conditional branch in render()!\n        if (!this.props.organization) {\n            return\n        }\n        return (\n            <Card\n                title={<span><Icon type=\"info-circle\"></Icon> info</span>}\n                className=\"slimCard\">\n                <div>\n                    <div>\n                        <div className=\"label\">owner</div>\n                    </div>\n                    <div className=\"ownerTable\">\n                        <div className=\"avatarCol\">\n                            <Avatar user={this.props.organization.owner.user} size={60} />\n                        </div>\n                        <div className=\"proprietorCol\">\n                            <div className=\"owner\">\n                                <a href={\"#people/\" + this.props.organization.owner.user.username} target=\"_blank\">{this.props.organization.owner.user.realname}</a>\n                                {' '}\n                                {this.props.organization.owner.user.username}\n                                        </div>\n                            <div className=\"profileOrganization\">\n                                {this.props.organization.owner.user.organization}\n                            </div>\n                            <div className=\"profileOrganization\">\n                                {this.props.organization.owner.user.city}, {this.props.organization.owner.user.state}, {this.props.organization.owner.user.country}\n                            </div>\n                        </div>\n                    </div>\n                    <div className='infoTable'>\n                        <div className=\"row\">\n                            <div className=\"col1\">\n                                <span className=\"label\">established</span>\n                            </div>\n                            <div className=\"col2\">\n                                <div className=\"createdAt\">\n                                    {Intl.DateTimeFormat('en-US', {\n                                        month: 'long',\n                                        day: 'numeric',\n                                        year: 'numeric'\n                                    }).format(this.props.organization.createdAt)}\n                                </div>\n                            </div>\n                        </div>\n\n                        <div className=\"row\">\n                            <div className=\"col1\">\n                                <span className=\"label\">last updated</span>\n                            </div>\n                            <div className=\"col2\">\n                                <div className=\"modifiedAt\">\n                                    {Intl.DateTimeFormat('en-US', {\n                                        month: 'long',\n                                        day: 'numeric',\n                                        year: 'numeric'\n                                    }).format(this.props.organization.modifiedAt)}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </Card>\n        )\n    }\n\n    renderAdminRequestsRow(org: Organization) {\n        if (!org) {\n            return\n        }\n        if (!org.relation) {\n            return\n        }\n        if (!(org.relation.type === UserRelationToOrganization.ADMIN ||\n            org.relation.type === UserRelationToOrganization.OWNER)) {\n            return\n        }\n        return (\n            <div className=\"row\">\n                <div className=\"col1\">\n                    <span className=\"label\">admin</span>\n                </div>\n                <div className=\"col2\">\n                    <div className=\"relation\">\n                        <div>\n                            <div>\n                                <Icon type=\"exclamation-circle\" theme=\"twoTone\" twoToneColor=\"orange\" /> group has\n                    {' '}\n                                <span style={{ fontWeight: 'bold' }}>{org.adminRequests.length}</span>\n                                {' '}\n                                pending request{org.adminRequests.length > 1 ? 's' : ''}\n                            </div>\n                            <div>\n                                <NavLink to={\"/manageOrganizationRequests/\" + this.props.organization!.id}>\n                                    <Button>Manage Requests</Button>\n                                </NavLink>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        )\n    }\n\n    renderAdminRequests(org: Organization) {\n        return (\n            <div>\n                <div>\n                    <Icon type=\"exclamation-circle\" theme=\"twoTone\" twoToneColor=\"orange\" /> group has\n                    {' '}\n                    <span style={{ fontWeight: 'bold' }}>{org.adminRequests.length}</span>\n                    {' '}\n                    pending request{org.adminRequests.length > 1 ? 's' : ''}\n                </div>\n                <div>\n                    <NavLink to={\"/manageOrganizationRequests/\" + this.props.organization!.id}>\n                        <Button>Manage Requests</Button>\n                    </NavLink>\n                </div>\n            </div>\n        )\n    }\n\n    renderRelationClass(org: Organization) {\n        switch (org.relation.type) {\n            case (UserRelationToOrganization.NONE):\n                return 'infoBox'\n            case (UserRelationToOrganization.VIEW):\n                return 'infoBox'\n            case (UserRelationToOrganization.MEMBER_REQUEST_PENDING):\n                return 'infoBox relationRequestPending'\n            case (UserRelationToOrganization.MEMBER_INVITATION_PENDING):\n                return 'infoBox relationInvitationPending'\n            case (UserRelationToOrganization.MEMBER):\n                return 'infoBox'\n            case (UserRelationToOrganization.ADMIN):\n                return 'infoBox'\n            case (UserRelationToOrganization.OWNER):\n                return 'infoBox'\n        }\n    }\n\n    renderUserRelationship() {\n        // apparently TS is not smart enough to know this from the conditional branch in render()!\n        if (!this.props.organization) {\n            return\n        }\n        return (\n            <form className=\"table infoTable\">\n                {/* <div className=\"row\">\n                    <div className=\"col1\">\n                        <span className=\"label\">your relation</span>\n                    </div>\n                    <div className=\"col2\">\n                        <div className='relation'>\n                            {this.renderRelation(this.props.organization)}\n                        </div>\n                    </div>\n                </div> */}\n                {this.renderAdminRequestsRow(this.props.organization)}\n            </form>\n        )\n    }\n\n    renderAdminTasks() {\n        if (!this.props.organization) {\n            return\n        }\n        const org = this.props.organization\n        if (!(org.relation.type === UserRelationToOrganization.ADMIN ||\n            org.relation.type === UserRelationToOrganization.OWNER)) {\n            return\n        }\n        return (\n            <div className=\"adminTasksBox\">\n                <Card\n                    className=\"slimCard adminTasksCard\"\n                    title={<span><Icon type=\"team\" /> admin tasks</span>}\n                >\n                    {this.renderAdminRequests(this.props.organization)}\n                </Card>\n            </div>\n        )\n    }\n\n    renderJoinButton() {\n        if (!this.props.organization) {\n            return\n        }\n        if (this.props.organization.relation.type !== UserRelationToOrganization.VIEW) {\n            return\n        }\n        return (\n            <Button\n                onClick={this.onJoinClick.bind(this)}\n            >\n                Join this Organization\n                </Button>\n        )\n    }\n\n    renderHeader() {\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            Viewing Org \"\n                            {this.props.organization && this.props.organization.name}\n                            \"\n                        </span>\n                    </div>\n                    <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', justifyContent: 'flex-end' }}>\n                        {this.renderEditButton()}\n                        <NavLink to={`/organizations`}><Button type=\"danger\" icon=\"undo\">Return to Orgs</Button></NavLink>\n                        {this.renderJoinButton()}\n                        <Button shape=\"circle\" icon=\"info\" onClick={this.onShowInfo.bind(this)}></Button>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    renderLoadingHeader() {\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            Loading Org...\n                        </span>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    renderMemberCard() {\n        const extras = [\n            (\n                <NavLink\n                    to={`/viewMembers/${this.props.organization!.id}`}>\n                    <Button\n                        onClick={this.onViewMembers.bind(this)}\n                        icon=\"team\"></Button>\n                </NavLink>\n            )\n        ]\n        if (!this.props.organization) {\n            return\n        }\n        // if (this.props.organization.relation.type === UserRelationToOrganization.OWNER ||\n        //     this.props.organization.relation.type === UserRelationToOrganization.ADMIN) {\n        //     extras.push((\n        //         <Button icon=\"setting\"></Button>\n        //     ))\n        // }\n        let memberCount\n        if (this.isMember()) {\n            memberCount = (\n                <span style={{ color: 'rgba(150, 150, 150, 1)' }}>({this.props.organization.members.length})</span>\n            )\n        } else {\n            memberCount = ''\n        }\n        return (\n            <Card\n                className=\"slimCard membersCard\"\n                title={<span><Icon type=\"team\" /> members {memberCount}</span>}\n                extra={extras}\n            >\n                {this.renderMembers()}\n            </Card>\n        )\n    }\n\n    renderNarratives() {\n        const fakeNarratives = []\n        for (let i = 0; i < 20; i += 1) {\n            fakeNarratives.push({\n                workspaceId: i,\n                // name: 'workspace_' + i,\n                title: 'Narrative Title Here ' + i,\n                public: Math.random() < 0.5 ? true : false,\n                perm: ['None', 'Read', 'Write', 'Admin', 'Own'][Math.floor(Math.random() * 4)]\n            })\n        }\n        if (!this.isMember()) {\n            return (\n                <Card\n                    className=\"slimCard membersCard narratives\"\n                    title={<span><Icon type=\"folder-open\" /> narratives</span>}\n                >\n                    <p style={{ textAlign: 'center', fontStyle: 'italic' }}>\n                        Sorry, Narratives are restricted to members only\n                </p>\n                </Card>\n            )\n        }\n        const narrativesTable = fakeNarratives.map((narrative) => {\n            return (\n                <div className=\"narrative\">\n                    <div className=\"title\">{narrative.title}</div>\n                    <div><i>abstract here?</i></div>\n                    <div><i>sharing info here?</i></div>\n                    <div><i>owner and save info here?</i></div>\n                </div>\n            )\n        })\n        const narrativeCount = fakeNarratives.length\n        return (\n            <Card\n                className=\"slimCard membersCard narratives\"\n                title={<span><Icon type=\"folder-open\" /> narratives ({narrativeCount})</span>}\n            >\n                <div className=\"narrativesTable\">\n                    {narrativesTable}\n                </div>\n            </Card>\n        )\n        // return (\n        //     <div className=\"narratives\">\n        //         <h3>Narratives</h3>\n        //         <div className=\"narrativesTable\">\n        //             {narrativesTable}\n        //         </div>\n        //     </div>\n        // )\n    }\n\n    render() {\n        if (typeof this.props.organization !== 'undefined') {\n            return (\n                <div className=\"ViewOrganization\">\n                    {this.renderHeader()}\n                    {this.renderOrgHeader()}\n                    <div className=\"mainRow\">\n                        <div className=\"mainColumn\">\n                            <div className=\"orgRow\">\n                                {this.renderOrg()}\n                            </div>\n                            <div className=\"narrativesRow\">\n                                {this.renderNarratives()}\n                            </div>\n                        </div>\n                        <div className=\"infoColumn\">\n                            {/* <div className={this.renderRelationClass(this.props.organization)}>\n                                {this.renderAdminTasks()}\n                            </div> */}\n                            {this.renderAdminTasks()}\n                            <div className=\"infoBox\">\n                                {this.renderInfo()}\n                            </div>\n                            {this.renderMemberCard()}\n                            {/* <div className=\"infoBox\">\n                                {this.renderMembers()}\n                            </div> */}\n                        </div>\n                    </div>\n                </div>\n            )\n        }\n        return (\n            <div className=\"ViewOrganization\">\n                {this.renderLoadingHeader()}\n                Loading...\n            </div>\n        )\n    }\n}\n\nexport default ViewOrganization","import { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\n\nimport * as types from '../../types'\nimport * as actions from '../../redux/actions/viewOrg'\n\nimport ViewOrganization from './ViewOrganization'\n\n// Props for this component\n\n// The interface for this container component\nexport interface OwnProps {\n    id: string\n}\n\n// the interface for mapStateTo props\ninterface StateProps {\n    id: string,\n    state: types.ViewOrgState\n    organization?: types.Organization\n    error?: types.AppError,\n    username: string\n}\n\n// the interface for mapDispatchToProps\ninterface DispatchProps {\n    onViewOrg: (id: string) => void\n    onJoinOrg: () => void\n    onCancelJoinRequest: (requestId: string) => void\n    onAcceptInvitation: (requestId: string) => void\n    onRejectInvitation: (requestId: string) => void\n}\n\n// hmm this bit would be for the interface for the wrapped component.\n// can't really do that here, but _could_ export the interfaces above\n// and compose them thus in the wrapped component. But the wrapped component\n// should know nothing about this business\n// type Props = StateProps & DispatchProps & OwnProps\n\n\nfunction mapStateToProps({ viewOrg: { state, organization, error }, auth: { authorization: { username } } }: types.StoreState,\n    { id }: OwnProps): StateProps {\n    // TODO: of course this really needs to be an async fetch of the org info!\n    return {\n        id, state, organization, error, username\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.ViewOrgFetch>): DispatchProps {\n    return {\n        onViewOrg: (id: string) => {\n            dispatch(actions.viewOrgFetch(id) as any)\n        },\n        onJoinOrg: () => {\n            dispatch(actions.viewOrgJoinRequest() as any)\n        },\n        onCancelJoinRequest: (requestId: string) => {\n            dispatch(actions.viewOrgCancelJoinRequest(requestId) as any)\n        },\n        onAcceptInvitation: (requestId: string) => {\n            dispatch(actions.acceptJoinInvitation(requestId) as any)\n        },\n        onRejectInvitation: (requestId: string) => {\n            dispatch(actions.rejectJoinInvitation(requestId) as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, types.StoreState>(mapStateToProps, mapDispatchToProps)(ViewOrganization)\n\n// export default connect(mapStateToProps, mapDispatchToProps)(ViewOrganization) \n\n","import { Action } from 'redux'\nimport { ThunkDispatch } from 'redux-thunk'\n\nimport { ActionFlag } from './index'\nimport { StoreState, Organization, AppError, UIError, UIErrorType, FieldState, EditableOrganization } from '../../types'\nimport { Model, Validation } from '../../data/model'\n\n// ACTIONS\n\n// Loading the editor\nexport interface EditOrgEdit extends Action {\n    type: ActionFlag.EDIT_ORG_EDIT,\n    id: string\n}\n\nexport interface EditOrgEditStart extends Action {\n    type: ActionFlag.EDIT_ORG_EDIT_START,\n    id: string\n}\n\nexport interface EditOrgEditSuccess extends Action {\n    type: ActionFlag.EDIT_ORG_EDIT_SUCCESS,\n    editedOrganization: EditableOrganization\n}\n\nexport interface EditOrgEditError extends Action<ActionFlag.EDIT_ORG_EDIT_ERROR> {\n    type: ActionFlag.EDIT_ORG_EDIT_ERROR,\n    error: AppError\n}\n\n// Evaluating state of form \n\nexport interface EditOrgEvaluate extends Action<ActionFlag.EDIT_ORG_EVALUATE> {\n    type: ActionFlag.EDIT_ORG_EVALUATE\n}\n\nexport interface EditOrgEvaluateOK extends Action<ActionFlag.EDIT_ORG_EVALUATE_OK> {\n    type: ActionFlag.EDIT_ORG_EVALUATE_OK\n}\n\nexport interface EditOrgEvaluateErrors extends Action<ActionFlag.EDIT_ORG_EVALUATE_ERRORS> {\n    type: ActionFlag.EDIT_ORG_EVALUATE_ERRORS\n}\n\n// Saving\n\nexport interface EditOrgSave extends Action<ActionFlag.EDIT_ORG_SAVE> {\n    type: ActionFlag.EDIT_ORG_SAVE\n}\n\nexport interface EditOrgSaveStart extends Action<ActionFlag.EDIT_ORG_SAVE_START> {\n    type: ActionFlag.EDIT_ORG_SAVE_START\n}\n\nexport interface EditOrgSaveSuccess extends Action<ActionFlag.EDIT_ORG_SAVE_SUCCESS> {\n    type: ActionFlag.EDIT_ORG_SAVE_SUCCESS\n}\n\nexport interface EditOrgSaveError extends Action<ActionFlag.EDIT_ORG_SAVE_ERROR> {\n    type: ActionFlag.EDIT_ORG_SAVE_ERROR,\n    error: AppError\n}\n\n// Updating name field\n\nexport interface EditOrgUpdateName extends Action {\n    type: ActionFlag.EDIT_ORG_UPDATE_NAME,\n    name: string\n}\n\nexport interface EditOrgUpdateNameSuccess {\n    type: ActionFlag.EDIT_ORG_UPDATE_NAME_SUCCESS,\n    name: string\n}\n\nexport interface EditOrgUpdateNameError extends Action {\n    type: ActionFlag.EDIT_ORG_UPDATE_NAME_ERROR,\n    name: string,\n    error: UIError\n}\n\n// Updating gravatar hash field\n\nexport interface EditOrgUpdateGravatarHash extends Action {\n    type: ActionFlag.EDIT_ORG_UPDATE_GRAVATAR_HASH,\n    name: string\n}\n\nexport interface EditOrgUpdateGravatarHashSuccess {\n    type: ActionFlag.EDIT_ORG_UPDATE_GRAVATAR_HASH_SUCCESS,\n    gravatarHash: string\n}\n\nexport interface EditOrgUpdateGravatarHashError extends Action {\n    type: ActionFlag.EDIT_ORG_UPDATE_GRAVATAR_HASH_ERROR,\n    gravatarHash: string,\n    error: UIError\n}\n\n// Updating id Field\n\n// export interface EditOrgUpdateId extends Action {\n//     type: ActionFlag.EDIT_ORG_UPDATE_ID,\n//     id: string\n// }\n\n// export interface EditOrgUpdateIdSuccess {\n//     type: ActionFlag.EDIT_ORG_UPDATE_ID_SUCCESS,\n//     id: string\n// }\n\n// export interface EditOrgUpdateIdError extends Action {\n//     type: ActionFlag.EDIT_ORG_UPDATE_ID_ERROR,\n//     id: string,\n//     error: UIError\n// }\n\n// Updating description field\n\nexport interface EditOrgUpdateDescription extends Action {\n    type: ActionFlag.EDIT_ORG_UPDATE_DESCRIPTION,\n    description: string\n}\n\nexport interface EditOrgUpdateDescriptionSuccess {\n    type: ActionFlag.EDIT_ORG_UPDATE_DESCRIPTION_SUCCESS,\n    description: string\n}\n\nexport interface EditOrgUpdateDescriptionError extends Action {\n    type: ActionFlag.EDIT_ORG_UPDATE_DESCRIPTION_ERROR,\n    description: string,\n    error: UIError\n}\n\n\n// ACTION CREATORS\n\nexport function editOrgStart(id: string): EditOrgEditStart {\n    return {\n        type: ActionFlag.EDIT_ORG_EDIT_START,\n        id: id\n    }\n}\n\nexport function editOrgEditStart() {\n    return {\n        type: ActionFlag.EDIT_ORG_EDIT_START\n    }\n}\n\nexport function editOrgEditSuccess(editedOrganization: EditableOrganization) {\n    return {\n        type: ActionFlag.EDIT_ORG_EDIT_SUCCESS,\n        editedOrganization: editedOrganization\n    }\n}\n\nexport function editOrgEditError(error: AppError): EditOrgEditError {\n    return {\n        type: ActionFlag.EDIT_ORG_EDIT_ERROR,\n        error: error\n    }\n}\n\n// Evaluate\n\nexport function editOrgEvaluateOk(): EditOrgEvaluateOK {\n    return {\n        type: ActionFlag.EDIT_ORG_EVALUATE_OK\n    }\n}\n\nexport function EditOrgEvaluateErrors(): EditOrgEvaluateErrors {\n    return {\n        type: ActionFlag.EDIT_ORG_EVALUATE_ERRORS\n    }\n}\n\n// Save\n\n// export function editOrgSave(): EditOrgSave {\n//     return {\n//         type: ActionFlag.EDIT_ORG_SAVE\n//     }\n// }\n\nexport function editOrgSaveStart(): EditOrgSaveStart {\n    return {\n        type: ActionFlag.EDIT_ORG_SAVE_START\n    }\n}\n\nexport function editOrgSaveSuccess(): EditOrgSaveSuccess {\n    return {\n        type: ActionFlag.EDIT_ORG_SAVE_SUCCESS\n    }\n}\n\nexport function editOrgSaveError(error: AppError): EditOrgSaveError {\n    return {\n        type: ActionFlag.EDIT_ORG_SAVE_ERROR,\n        error: error\n    }\n}\n\n// Update Name\n\nexport function editOrgUpdateNameSuccess(name: string): EditOrgUpdateNameSuccess {\n    return {\n        type: ActionFlag.EDIT_ORG_UPDATE_NAME_SUCCESS,\n        name: name\n    }\n}\n\nexport function editOrgUpdateNameError(name: string, error: UIError): EditOrgUpdateNameError {\n    return {\n        type: ActionFlag.EDIT_ORG_UPDATE_NAME_ERROR,\n        name: name,\n        error: error\n    }\n}\n\n// export function editOrgUpdateIdSuccess(id: string): EditOrgUpdateIdSuccess {\n//     return {\n//         type: ActionFlag.EDIT_ORG_UPDATE_ID_SUCCESS,\n//         id: id\n//     }\n// }\n\n// Update Gravatar Hash\n\nexport function editOrgUpdateGravatarHashSuccess(gravatarHash: string): EditOrgUpdateGravatarHashSuccess {\n    return {\n        type: ActionFlag.EDIT_ORG_UPDATE_GRAVATAR_HASH_SUCCESS,\n        gravatarHash: gravatarHash\n    }\n}\n\nexport function editOrgUpdateGravatarHashError(gravatarHash: string, error: UIError): EditOrgUpdateGravatarHashError {\n    return {\n        type: ActionFlag.EDIT_ORG_UPDATE_GRAVATAR_HASH_ERROR,\n        gravatarHash: gravatarHash,\n        error: error\n    }\n}\n\n\n// Update Id\n\n// export function editOrgUpdateIdError(id: string, error: UIError): EditOrgUpdateIdError {\n//     return {\n//         type: ActionFlag.EDIT_ORG_UPDATE_ID_ERROR,\n//         id: id,\n//         error: error\n//     }\n// }\n\nexport function editOrgUpdateDescriptionSuccess(description: string): EditOrgUpdateDescriptionSuccess {\n    return {\n        type: ActionFlag.EDIT_ORG_UPDATE_DESCRIPTION_SUCCESS,\n        description: description\n    }\n}\n\nexport function editOrgUpdateDescriptionError(description: string, error: UIError): EditOrgUpdateDescriptionError {\n    return {\n        type: ActionFlag.EDIT_ORG_UPDATE_DESCRIPTION_ERROR,\n        description: description,\n        error: error\n    }\n}\n\n// ACTION THUNKS\n\nexport function editOrgEdit(organizationId: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(editOrgStart(organizationId))\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config }\n        } = getState()\n\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        return model.getOrg(organizationId)\n            .then((org) => {\n                const editableOrg: EditableOrganization = {\n                    id: {\n                        value: org.id,\n                        status: FieldState.UNEDITED_OK,\n                        error: {\n                            type: UIErrorType.NONE,\n                            message: ''\n                        }\n                    },\n                    name: {\n                        value: org.name,\n                        status: FieldState.UNEDITED_OK,\n                        error: {\n                            type: UIErrorType.NONE,\n                            message: ''\n                        }\n                    },\n                    gravatarHash: {\n                        value: org.gravatarHash,\n                        status: FieldState.UNEDITED_OK,\n                        error: {\n                            type: UIErrorType.NONE,\n                            message: ''\n                        }\n                    },\n                    description: {\n                        value: org.description,\n                        status: FieldState.UNEDITED_OK,\n                        error: {\n                            type: UIErrorType.NONE,\n                            message: ''\n                        }\n                    }\n                }\n                dispatch(editOrgEditSuccess(editableOrg))\n            })\n            .catch((err) => {\n                console.error('load org error', err)\n                dispatch(editOrgEditError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}\n\n\nexport function editOrgSave() {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(editOrgSaveStart())\n\n        const { auth: { authorization: { token, username } },\n            editOrg: { organizationId, editedOrganization },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        if (!editedOrganization) {\n            dispatch(editOrgSaveError({\n                code: 'app',\n                message: 'The new organization data does not yet exist'\n            }))\n            return;\n        }\n\n        const update = {\n            name: editedOrganization.name.value,\n            gravatarHash: editedOrganization.gravatarHash.value,\n            description: editedOrganization.description.value\n        }\n\n        model.updateOrg(organizationId, update)\n            .then(() => {\n                dispatch(editOrgSaveSuccess())\n            })\n            .catch((error) => {\n                console.error('error adding', editedOrganization, error)\n                dispatch(editOrgSaveError({\n                    code: 'invalid',\n                    message: error.message\n                }))\n            })\n    }\n}\n\nexport function editOrgEvaluate() {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        const { editOrg: { editedOrganization } } = getState()\n\n        const { editOrg: editState } = getState()\n\n        if (!editedOrganization) {\n            dispatch(EditOrgEvaluateErrors())\n            return\n        }\n\n        if (!(editedOrganization.name.status === FieldState.EDITED_OK ||\n            editedOrganization.name.status === FieldState.UNEDITED_OK)) {\n            dispatch(EditOrgEvaluateErrors())\n            return\n        }\n\n        // if (editedOrganization.id.status !== FieldState.EDITED_OK) {\n        //     dispatch(EditOrgEvaluateErrors())\n        //     return\n        // }\n\n        if (!(editedOrganization.gravatarHash.status === FieldState.EDITED_OK ||\n            editedOrganization.gravatarHash.status === FieldState.UNEDITED_OK)) {\n            dispatch(EditOrgEvaluateErrors())\n            return\n        }\n\n        if (!(editedOrganization.description.status === FieldState.EDITED_OK ||\n            editedOrganization.description.status === FieldState.UNEDITED_OK)) {\n            dispatch(EditOrgEvaluateErrors())\n            return\n        }\n\n        dispatch(editOrgEvaluateOk())\n    }\n}\n\nexport function editOrgUpdateName(name: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>) => {\n        const [validatedName, error] = Validation.validateOrgName(name)\n\n        if (error.type === UIErrorType.ERROR) {\n            dispatch(editOrgUpdateNameError(validatedName, error))\n        } else {\n            dispatch(editOrgUpdateNameSuccess(validatedName))\n        }\n        dispatch(editOrgEvaluate())\n    }\n}\n\nexport function editOrgUpdateGravatarHash(name: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>) => {\n        const [validateGravatarHash, error] = Validation.validateOrgGravatarHash(name)\n\n        if (error.type === UIErrorType.ERROR) {\n            dispatch(editOrgUpdateGravatarHashError(validateGravatarHash, error))\n        } else {\n            dispatch(editOrgUpdateGravatarHashSuccess(validateGravatarHash))\n        }\n        dispatch(editOrgEvaluate())\n    }\n}\n\nexport function editOrgUpdateDescription(description: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>,\n        getState: () => StoreState) => {\n        const { auth: { authorization: { token, username } },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n        const [validatedDescription, error] = model.validateOrgDescription(description)\n\n        if (error.type === UIErrorType.ERROR) {\n            dispatch(editOrgUpdateDescriptionError(validatedDescription, error))\n        } else {\n            dispatch(editOrgUpdateDescriptionSuccess(validatedDescription))\n        }\n        dispatch(editOrgEvaluate())\n    }\n}","import * as React from 'react'\nimport { Redirect } from 'react-router-dom';\nimport marked from 'marked';\nimport { Button, Icon, Modal } from 'antd';\nimport md5 from 'md5'\n\nimport { EditableOrganization, SaveState, ValidationState, EditState } from '../types';\n\nimport './EditOrganization.css'\n\nimport Header from './Header';\n\nexport interface EditOrganizationProps {\n    id: string,\n    editState: EditState,\n    saveState: SaveState,\n    validationState: ValidationState,\n    editedOrganization: EditableOrganization,\n    onEditOrgEdit: (id: string) => void,\n    onEditOrgSave: () => void,\n    onUpdateName: (name: string) => void,\n    onUpdateGravatarHash: (gravatarHash: string) => void;\n    // onUpdateId: (id: string) => void,\n    onUpdateDescription: (description: string) => void\n}\n\n\nexport interface EditOrganizationState {\n    cancelToBrowser: boolean;\n    cancelToViewer: boolean;\n}\n\nclass EditOrganization extends React.Component<EditOrganizationProps, EditOrganizationState> {\n\n    origin: string;\n\n    gravatarEmail: React.RefObject<HTMLInputElement>\n\n    constructor(props: EditOrganizationProps) {\n        super(props)\n\n        this.state = {\n            cancelToBrowser: false,\n            cancelToViewer: false\n        }\n\n        this.gravatarEmail = React.createRef()\n\n        this.origin = document.location!.origin\n\n        this.props.onEditOrgEdit(this.props.id)\n    }\n\n    onShowInfo() {\n        Modal.info({\n            title: 'Organization Editor Help',\n            width: '50em',\n            content: (\n                <div>\n                    <p>This is the organizations editor...</p>\n                </div>\n            )\n        })\n    }\n\n\n    onGravatarEmailSync() {\n        let email;\n        if (this.gravatarEmail.current) {\n            email = this.gravatarEmail.current.value\n        } else {\n            email = 'n/a'\n        }\n        const hashed = md5(email)\n        this.props.onUpdateGravatarHash(hashed);\n    }\n\n    onClickCancelToBrowser() {\n        if (!this.isModified()) {\n            this.setState({ cancelToBrowser: true })\n            return\n        }\n\n        const confirm = () => {\n            this.setState({ cancelToBrowser: true })\n        }\n        const cancel = () => {\n        }\n        Modal.confirm({\n            title: 'Leave the editor?',\n            content: (\n                <div>\n                    <p>You have made changes on this edit form.</p>\n\n                    <p>If you leave the editor without saving, any <i>changes they will be lost</i>.</p>\n\n                    <p><b>Continue to leave the editor?</b></p>\n                </div>\n            ),\n            onOk: confirm,\n            onCancel: cancel,\n            okText: 'Yes',\n            cancelText: 'No'\n        })\n    }\n\n    onClickCancelToViewer() {\n        if (!this.isModified()) {\n            this.setState({ cancelToViewer: true })\n            return\n        }\n\n        const confirm = () => {\n            this.setState({ cancelToViewer: true })\n        }\n        const cancel = () => {\n        }\n        Modal.confirm({\n            title: 'Leave the editor?',\n            content: (\n                <div>\n                    <p>You have made changes on this edit form.</p>\n\n                    <p>If you leave the editor without saving, any <i>changes they will be lost</i>.</p>\n\n                    <p><b>Continue to leave the editor?</b></p>\n                </div>\n            ),\n            onOk: confirm,\n            onCancel: cancel,\n            okText: 'Yes',\n            cancelText: 'No'\n        })\n    }\n\n    onSubmit(e: React.FormEvent<HTMLFormElement>) {\n        e.preventDefault();\n        this.props.onEditOrgSave();\n    }\n\n    onNameChange(e: React.ChangeEvent<HTMLInputElement>) {\n        e.persist();\n        this.props.onUpdateName(e.target.value);\n    }\n\n    onGravatarHashChange(e: React.ChangeEvent<HTMLInputElement>) {\n        e.persist();\n        this.props.onUpdateGravatarHash(e.target.value);\n    }\n\n    onDescriptionChange(e: React.ChangeEvent<HTMLTextAreaElement>): void {\n        e.persist()\n        this.props.onUpdateDescription(e.target.value);\n    }\n\n    onIdChange(e: React.ChangeEvent<HTMLInputElement>) {\n        e.persist();\n        // this.props.onUpdateId(e.target.value);\n        console.warn('no updating id, naughty!')\n    }\n\n    canSave() {\n        return (\n            this.props.editState === EditState.EDITED &&\n            this.props.validationState === ValidationState.VALID &&\n            (this.props.saveState === SaveState.NEW ||\n                this.props.saveState === SaveState.READY ||\n                this.props.saveState === SaveState.SAVED)\n        )\n    }\n\n    isModified() {\n        return (\n            this.props.editState === EditState.EDITED &&\n            (this.props.saveState === SaveState.NEW ||\n                this.props.saveState === SaveState.READY)\n        )\n    }\n\n    renderForm() {\n        return (\n            <form id=\"editOrganizationForm\" className=\"editor\" onSubmit={this.onSubmit.bind(this)}>\n                <div className=\"row\">\n                    <div className=\"col1 field-label\">name</div>\n                    <div className=\"col2\">\n                        <input value={this.props.editedOrganization.name.value || ''}\n                            onChange={this.onNameChange.bind(this)} />\n                        {this.props.editedOrganization.name.error ? (<span style={{ color: 'red' }}>{this.props.editedOrganization.name.error.message}</span>) : ''}\n                    </div>\n                </div>\n                <div className=\"row gravatarHash\">\n                    <div className=\"col1 field-label\">gravatar hash</div>\n                    <div className=\"col2\">\n                        <div style={{ display: 'flex', flexDirection: 'row', marginBottom: '4px' }}>\n                            <div style={{ flex: '1 1 0px' }}>\n                                <input ref={this.gravatarEmail} placeholder=\"Provide your gravatar-linked email address, if any\" />\n                            </div>\n                            <div style={{ flex: '0 0 auto' }}>\n                                <Button\n                                    icon=\"arrow-down\"\n                                    style={{ height: '100%' }}\n                                    onClick={this.onGravatarEmailSync.bind(this)} />\n                            </div>\n                        </div>\n\n                        <input value={this.props.editedOrganization.gravatarHash.value || ''}\n                            onChange={this.onGravatarHashChange.bind(this)} />\n                        {this.props.editedOrganization.gravatarHash.error ? (<span style={{ color: 'red' }}>{this.props.editedOrganization.gravatarHash.error.message}</span>) : ''}\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col1 field-label\">id</div>\n                    <div className=\"col2\">\n                        <input value={this.props.editedOrganization.id.value || ''}\n                            onChange={this.onIdChange.bind(this)} />\n                        {this.props.editedOrganization.id.error ? (<span style={{ color: 'red' }}>{this.props.editedOrganization.id.error.message}</span>) : ''}\n                    </div>\n                </div>\n                <div className=\"row\" style={{ flex: '1 1 0px', minHeight: '30em', maxHeight: '60em' }}>\n                    <div className=\"col1 field-label\">description</div>\n                    <div className=\"col2\">\n                        <textarea value={this.props.editedOrganization.description.value || ''}\n                            onChange={this.onDescriptionChange.bind(this)} />\n                        {this.props.editedOrganization.description.error ? (<div style={{ color: 'red' }}>{this.props.editedOrganization.description.error.message}</div>) : ''}\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col1\"></div>\n                    <div className=\"col2\">\n                        {/* <div className=\"footer\">\n                            <Button form=\"newOrganizationForm\"\n                                key=\"submit\"\n                                htmlType=\"submit\">Save</Button>\n                            <Button type=\"danger\"\n                                onClick={this.onClickCancel.bind(this)}>Cancel</Button>\n                        </div> */}\n                    </div>\n                </div>\n            </form>\n        )\n    }\n\n    getOrgAvatarUrl(org: EditableOrganization) {\n        // const defaultImages = [\n        //     'orgs-64.png',\n        //     'unicorn-64.png'\n        // ]\n        // if (!org.gravatarHash.value) {\n        //     return defaultImages[Math.floor(Math.random() * 2)]\n        // }\n        if (!org.gravatarHash.value) {\n            return 'unicorn-64.png'\n        }\n        const gravatarDefault = 'identicon';\n\n        return 'https://www.gravatar.com/avatar/' + org.gravatarHash.value + '?s=64&amp;r=pg&d=' + gravatarDefault;\n    }\n\n    renderOrgAvatar(org: EditableOrganization) {\n        return (\n            <img style={{ width: 64, height: 64 }}\n                src={this.getOrgAvatarUrl(org)} />\n        )\n    }\n\n    renderPreview() {\n        return <form className=\"preview\">\n            <div className=\"row\">\n                <div className=\"col2\">\n                    <div className=\"name\">\n                        {this.props.editedOrganization.name.value || ''}\n                    </div>\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"col2\">\n                    <div className=\"gravatarHash\">\n                        {this.renderOrgAvatar(this.props.editedOrganization)}\n                    </div>\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"col2\">\n                    <div className=\"id\">\n                        <span style={{ color: 'silver' }}>{this.origin}/#orgs/organizations/</span>\n                        {this.props.editedOrganization.id.value || (<span style={{ fontStyle: 'italic' }}>organization id here</span>)}\n                    </div>\n                </div>\n            </div>\n            <div className=\"row\" style={{ flex: '1 1 0px' }}>\n                <div className=\"col2\">\n                    <div className=\"description\"\n                        dangerouslySetInnerHTML={({ __html: marked(this.props.editedOrganization.description.value || '') })}\n                    />\n                </div>\n            </div>\n        </form>\n    }\n\n    renderState() {\n        const { editState, validationState, saveState } = this.props;\n        const label = 'edit: ' + editState + ', valid: ' + validationState + ', save: ' + saveState\n        return (\n            <span style={{ marginRight: '10px' }}>{label}</span>\n        )\n    }\n\n    renderHeader() {\n        const orgName = this.props.editedOrganization.name.value || (<span style={{ fontStyle: 'italic', color: 'gray' }}>org name will appear here when you edit the name field</span>)\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            {/* <FaPlusCircle style={{ verticalAlign: 'middle' }} /> */}\n                            <Icon type=\"edit\" />\n                            {' '}\n                            Editing Org \"\n                            {orgName}\n                            \"\n                        </span>\n                    </div>\n                    <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', justifyContent: 'flex-end', alignItems: 'center' }}>\n                        {/* {this.renderState()} */}\n                        <Button icon=\"save\"\n                            form=\"editOrganizationForm\"\n                            key=\"submit\"\n                            disabled={!this.canSave.call(this)}\n                            htmlType=\"submit\">\n                            {/* <Icon type=\"save\" /> */}\n                            {/* <FaSave style={{ verticalAlign: 'center' }} /> */}\n                            Save\n                        </Button>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToViewer.bind(this)}>\n                            {/* <FaUndo style={{ verticalAlign: 'center' }} />  */}\n                            Return to this Org\n                        </Button>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToBrowser.bind(this)}>\n                            {/* <FaUndo style={{ verticalAlign: 'center' }} />  */}\n                            Return to Orgs Browser\n                        </Button>\n                        <Button shape=\"circle\" icon=\"info\" onClick={this.onShowInfo.bind(this)}></Button>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    // renderFooter() {\n    //     return (\n    //         <div className=\"footerRow\">\n    //             <div className=\"editorColumn\">\n    //                 <div className=\"row\">\n    //                     <div className=\"col1\">\n    //                     </div>\n    //                     <div className=\"col2\">\n    //                         <div className=\"footer\">\n    //                             <Button form=\"editOrganizationForm\"\n    //                                 key=\"submit\"\n    //                                 htmlType=\"submit\">Save</Button>\n    //                             <Button type=\"danger\"\n    //                                 onClick={this.onClickCancel.bind(this)}>Cancel</Button>\n    //                         </div>\n    //                     </div>\n    //                 </div>\n    //             </div>\n    //             <div className=\"previewColumn\">\n\n    //             </div>\n    //         </div>\n    //     )\n    // }\n\n    renderLoadingHeader() {\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            Loading Org Editor...\n                        </span>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    render() {\n        if (this.state.cancelToBrowser) {\n            return <Redirect push to=\"/organizations\" />\n        }\n\n        if (this.state.cancelToViewer) {\n            return <Redirect push to={\"/viewOrganization/\" + this.props.id} />\n        }\n\n        // // TODO: this is just a prop for today.\n        // if (this.props.saveState === SaveState.SAVED) {\n        //     return <Redirect push to={\"/editOrganization/\" + this.props.editedOrganization.id.value} />\n        // }\n\n        if (!this.props.editedOrganization) {\n            return (\n                <div className=\"EditOrganization\">\n                    {this.renderLoadingHeader()}\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"EditOrganization\">\n                {this.renderHeader()}\n                <div className=\"mainRow\">\n                    <div className=\"editorColumn\">\n                        <h3>Editor</h3>\n                        {this.renderForm()}\n                    </div>\n                    <div className=\"previewColumn\">\n                        <h3>Preview</h3>\n                        {this.renderPreview()}\n                    </div>\n                </div>\n                {/* {this.renderFooter()} */}\n            </div>\n        )\n    }\n}\n\nexport default EditOrganization","import { Dispatch } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { StoreState, EditableOrganization, EditState, SaveState, ValidationState } from '../types';\nimport {\n    EditOrgEdit, editOrgSave,\n    editOrgUpdateName,\n    // editOrgUpdateId, \n    editOrgUpdateDescription, editOrgEdit, editOrgUpdateGravatarHash\n} from '../redux/actions/editOrg';\n\nimport EditOrganization from '../components/EditOrganization';\n\ninterface OwnProps {\n    id: string\n}\n\nexport interface StateProps {\n    editState: EditState,\n    saveState: SaveState,\n    validationState: ValidationState,\n    editedOrganization: EditableOrganization\n}\n\nexport interface DispatchProps {\n    onEditOrgEdit: (id: string) => void,\n    onEditOrgSave: () => void,\n    onUpdateName: (name: string) => void,\n    onUpdateGravatarHash: (gravatarHash: string) => void,\n    // onUpdateId: (id: string) => void,\n    onUpdateDescription: (description: string) => void\n}\n\nexport function mapStateToProps({ editOrg: { editState, saveState, validationState, editedOrganization } }: StoreState): StateProps {\n    return {\n        editState,\n        saveState,\n        validationState,\n        editedOrganization\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<EditOrgEdit>): DispatchProps {\n    return {\n        onEditOrgEdit: (id: string) => {\n            dispatch(editOrgEdit(id) as any)\n        },\n        onEditOrgSave: () => {\n            dispatch(editOrgSave() as any)\n        },\n        onUpdateName: (name: string) => {\n            dispatch(editOrgUpdateName(name) as any)\n        },\n        onUpdateGravatarHash: (gravatarHash: string) => {\n            dispatch(editOrgUpdateGravatarHash(gravatarHash) as any)\n        },\n        // onUpdateId: (id) => {\n        //     dispatch(editOrgUpdateId(id) as any)\n        // },\n        onUpdateDescription: (description) => {\n            dispatch(editOrgUpdateDescription(description) as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(mapStateToProps, mapDispatchToProps)(EditOrganization)","import * as React from 'react'\nimport './Auth.css'\n\nimport * as types from '../types'\nimport { Button } from 'antd';\n\n\nexport interface AuthState {\n\n}\n\nclass Auth extends React.Component<types.AuthProps, AuthState> {\n\n    tokenRef: React.RefObject<HTMLInputElement>\n\n    constructor(props: types.AuthProps) {\n        super(props)\n\n        this.tokenRef = React.createRef()\n\n        this.props.checkAuth()\n    }\n\n    onLogoutClick() {\n        this.props.onRemoveAuthorization()\n    }\n\n    onLoginClick() {\n        if (this.tokenRef.current === null) {\n            return\n        }\n        const token = this.tokenRef.current.value\n        if (token.length === 0) {\n            return\n        }\n        this.props.onAddAuthorization(token)\n    }\n\n    buildAuthForm() {\n        return (\n            <div className=\"Auth-form\">\n                Token: <input ref={this.tokenRef} />\n                <Button\n                    icon=\"save\"\n                    htmlType=\"submit\"\n                    onClick={this.onLoginClick.bind(this)} >\n                    Assign Token\n                </Button>\n            </div>\n        )\n    }\n\n    buildAuthToolbar() {\n        return (\n            <div className=\"Auth-toolbar\">\n                Logged in as <b><span>{this.props.authorization.authorization.realname}</span> (<span>{this.props.authorization.authorization.username}</span></b>)\n                {' '}\n                <Button icon=\"logout\" onClick={this.onLogoutClick.bind(this)}>Sign out</Button>\n            </div>\n        )\n    }\n\n    buildAuthDev() {\n        switch (this.props.authorization.status) {\n            case types.AuthState.NONE:\n            case types.AuthState.CHECKING:\n                return (\n                    <div></div>\n                )\n            case types.AuthState.AUTHORIZED:\n                return (\n                    <div className=\"Auth Auth-authorized\">\n                        {this.buildAuthToolbar()}\n                        {this.props.children}\n                    </div>\n                )\n            case types.AuthState.UNAUTHORIZED:\n                return (\n                    <div className=\"Auth Auth-unauthorized\">\n                        <p>Not authorized! Enter a user token below</p>\n                        {this.buildAuthForm()}\n                    </div>\n                )\n            case types.AuthState.ERROR:\n                return (\n                    <div className=\"Auth Auth-unauthorized\">\n                        <p>Error</p>\n                        {this.props.authorization.message}\n                    </div>\n                )\n            default:\n                return (\n                    <div></div>\n                )\n        }\n    }\n\n    buildAuthProd() {\n        switch (this.props.authorization.status) {\n            case types.AuthState.NONE:\n            case types.AuthState.CHECKING:\n                return (\n                    <div></div>\n                )\n            case types.AuthState.AUTHORIZED:\n                return (\n                    <div className=\"Auth Auth-authorized\">\n                        {this.props.children}\n                    </div>\n                )\n            case types.AuthState.UNAUTHORIZED:\n                return (\n                    <div className=\"Auth Auth-unauthorized\">\n                        <p>Not authorized!</p>\n                    </div>\n                )\n            case types.AuthState.ERROR:\n                return (\n                    <div className=\"Auth Auth-error\">\n                        <p>Error: ??</p>\n                    </div>\n                )\n            default:\n                return (\n                    <div></div>\n                )\n        }\n\n    }\n\n    render() {\n        return (\n            <div className=\"Auth\">\n                {this.props.hosted ? this.buildAuthProd() : this.buildAuthDev()}\n            </div>\n        )\n\n    }\n}\n\nexport default Auth","\nexport interface RootInfo {\n    version: string,\n    servertime: number\n}\n\ninterface AuthEndpoints {\n    root: string,\n    tokenInfo: string,\n    apiMe: string,\n    me: string,\n    loginStart: string,\n    loginChoice: string,\n    loginCreate: string,\n    loginUsernameSuggest: string,\n    loginPick: string,\n    loginCancel: string,\n    logout: string,\n    linkStart: string,\n    linkCancel: string,\n    linkChoice: string,\n    linkPick: string,\n    linkRemove: string,\n    tokens: string,\n    tokensRevoke: string,\n    tokensRevokeAll: string,\n    userSearch: string,\n    adminUserSearch: string,\n    adminUser: string\n}\n\nconst endpoints: AuthEndpoints = {\n    root: '',\n    tokenInfo: 'api/V2/token',\n    apiMe: 'api/V2/me',\n    me: 'me',\n    loginStart: 'login/start',\n    logout: 'logout',\n    loginChoice: 'login/choice',\n    loginCreate: 'login/create',\n    loginUsernameSuggest: 'login/suggestname',\n    loginPick: 'login/pick',\n    loginCancel: 'login/cancel',\n    linkStart: 'link/start',\n    linkCancel: 'link/cancel',\n    linkChoice: 'link/choice',\n    linkPick: 'link/pick',\n    linkRemove: 'me/unlink',\n    tokens: 'tokens',\n    tokensRevoke: 'tokens/revoke',\n    tokensRevokeAll: 'tokens/revokeall',\n    userSearch: 'api/V2/users/search',\n    adminUserSearch: 'api/V2/admin/search',\n    adminUser: 'api/V2/admin/user'\n}\n\nexport interface TokenInfo {\n    created: number,\n    expires: number,\n    id: string,\n    name: string | null,\n    token: string,\n    type: string,\n    user: string,\n    cachefor: number\n}\n\nexport interface Identity {\n    id: string,\n    provider: string,\n    username: string\n}\n\nexport interface Role {\n    id: string,\n    desc: string\n}\n\nexport interface Account {\n    created: number,\n    customroles: Array<string>,\n    display: string,\n    email: string,\n    idents: Array<Identity>,\n    lastLogin: number,\n    local: boolean,\n    roles: Array<Role>,\n    user: string\n}\nexport class AuthClient {\n    url: string;\n\n    constructor({ url }: { url: string }) {\n        this.url = url\n    }\n\n    makePath(path: Array<string> | string): string {\n        if (typeof path === 'string') {\n            return [this.url].concat([path]).join('/');\n        }\n        return [this.url].concat(path).join('/');\n    }\n\n\n    root(): Promise<RootInfo> {\n        return fetch(this.makePath([endpoints.root]), {\n            headers: {\n                Accept: 'application/json'\n            },\n            mode: 'cors'\n        })\n            .then((response) => {\n                return response.json()\n            })\n            .then((result) => {\n                return result as RootInfo\n            })\n    }\n\n    getTokenInfo(token: string): Promise<TokenInfo> {\n        return fetch(this.makePath([endpoints.tokenInfo]), {\n            headers: {\n                Accept: 'application/json',\n                Authorization: token\n            },\n            mode: 'cors'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error(response.statusText)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                return result as TokenInfo\n            })\n    }\n\n    getMe(token: string): Promise<Account> {\n        return fetch(this.makePath([endpoints.apiMe]), {\n            headers: {\n                Accept: 'application/json',\n                Authorization: token\n            },\n            mode: 'cors'\n        })\n            .then((response) => {\n                if (response.status !== 200) {\n                    throw new Error(response.statusText)\n                }\n                return response.json()\n            })\n            .then((result) => {\n                return result as Account\n            })\n    }\n\n\n    // getInfo() : Promise<GroupsServiceInfo> {\n    //     return fetch(this.url + '/', {\n    //         headers: {\n    //             Authorization: this.token,\n    //             Accept: 'application/json'\n    //         },\n    //         mode: 'cors'\n    //     })\n    //         .then((response) => {\n    //             return response.json();\n    //         })\n    //         .then((result) => {\n    //             return result as GroupsServiceInfo;\n    //         });\n    // }\n\n}","import { Action } from 'redux'\nimport { ThunkDispatch } from 'redux-thunk'\nimport * as Cookies from 'es-cookie'\n\nimport { ActionFlag } from './index'\nimport { AppError, StoreState } from '../../types';\nimport { AuthClient, TokenInfo, Account } from '../../data/auth';\n\n// Action Definitions\n\nexport interface AuthCheck extends Action {\n    type: ActionFlag.AUTH_CHECK\n}\n\nexport interface AuthCheckStart extends Action {\n    type: ActionFlag.AUTH_CHECK_START\n}\n\nexport interface AuthCheckError extends Action {\n    type: ActionFlag.AUTH_CHECK_ERROR,\n    error: AppError\n}\n\nexport interface AuthAuthorized extends Action {\n    type: ActionFlag.AUTH_AUTHORIZED,\n    token: string\n    username: string,\n    realname: string,\n    roles: Array<string>\n}\n\nexport interface AuthUnauthorized extends Action {\n    type: ActionFlag.AUTH_UNAUTHORIZED\n}\n\nexport interface AuthRemoveAuthorization extends Action {\n    type: ActionFlag.AUTH_REMOVE_AUTHORIZATION\n}\n\nexport interface AuthAddAuthorization extends Action {\n    type: ActionFlag.AUTH_ADD_AUTHORIZATION,\n    token: string\n}\n\n// Action Creators\n\n\nexport function authCheckStart(): AuthCheckStart {\n    return {\n        type: ActionFlag.AUTH_CHECK_START\n    }\n}\n\nexport function authCheckError(error: AppError): AuthCheckError {\n    return {\n        type: ActionFlag.AUTH_CHECK_ERROR,\n        error\n    }\n}\n\nexport function authAuthorized(token: string, username: string, realname: string, roles: Array<string>): AuthAuthorized {\n    return {\n        type: ActionFlag.AUTH_AUTHORIZED,\n        token, username, realname, roles\n    }\n}\n\nexport function authUnauthorized(): AuthUnauthorized {\n    return {\n        type: ActionFlag.AUTH_UNAUTHORIZED\n    }\n}\n\n// export function authRemoveAuthorization(): AuthRemoveAuthorization {\n//     return {\n//         type: ActionFlag.AUTH_REMOVE_AUTHORIZATION\n//     }\n// }\n\n// export function authAddAuthorization(token: string): AuthAddAuthorization {\n//     return {\n//         type: ActionFlag.AUTH_ADD_AUTHORIZATION,\n//         token: token\n//     }\n// }\n\n// Action Thunks\n\nexport function checkAuth() {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(authCheckStart())\n\n        // TODO: get the auth from the kbase-ui integration api, perhaps a postmessage call\n\n        const token = Cookies.get('kbase_session')\n        if (!token) {\n            dispatch(authUnauthorized())\n            return\n        }\n        const auth = new AuthClient({ url: '/services/auth' })\n        Promise.all([\n            auth.getTokenInfo(token),\n            auth.getMe(token)\n        ])\n            .then(([tokenInfo, account]) => {\n                const roles = account.roles.map(({ id, desc }) => id)\n                dispatch(authAuthorized(token, account.user, account.display, roles))\n            })\n            .catch((err) => {\n                console.error('auth check error', err)\n                dispatch(authCheckError({\n                    code: 'error',\n                    message: err.message\n                }))\n            })\n    }\n}\n\nexport function authRemoveAuthorization() {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        // remove cookie\n        Cookies.remove('kbase_session')\n\n        // remove auth in state\n        dispatch(authUnauthorized())\n    }\n}\n\nexport function authAddAuthorization(token: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        // add cookie\n        Cookies.set('kbase_session', token)\n\n        // TODO: get auth info\n        const auth = new AuthClient({ url: '/services/auth' })\n        Promise.all([\n            auth.getTokenInfo(token),\n            auth.getMe(token)\n        ])\n            .then(([tokenInfo, account]) => {\n                const roles = account.roles.map(({ id, desc }) => id)\n                dispatch(authAuthorized(token, account.user, account.display, roles))\n            })\n            .catch((err) => {\n                console.error('auth check error', err)\n                dispatch(authCheckError({\n                    code: 'error',\n                    message: err.message\n                }))\n            })\n\n    }\n}","import { Dispatch, Action } from 'redux'\nimport { connect } from 'react-redux'\n\nimport { StoreState, AuthState, Authorization } from '../types'\nimport Auth from '../components/Auth'\nimport * as actions from '../redux/actions/auth'\n\nexport interface OwnProps {\n    hosted: boolean\n}\n\ninterface StateProps {\n    authorization: Authorization\n    // authStatus: AuthState,\n    // token: string | null,\n    // username: string | null,\n    // realname: string | null,\n}\n\ninterface DispatchProps {\n    checkAuth: () => void,\n    onRemoveAuthorization: () => void,\n    onAddAuthorization: (token: string) => void\n}\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const { auth } = state\n    return {\n        authorization: auth\n        // authStatus: status,\n        // token: authorization.token || null,\n        // username: authorization.username || null,\n        // realname: authorization.realname || null\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<Action>): DispatchProps {\n    return {\n        checkAuth: () => {\n            dispatch(actions.checkAuth() as any)\n        },\n        onRemoveAuthorization: () => {\n            dispatch(actions.authRemoveAuthorization() as any)\n        },\n        onAddAuthorization: (token: string) => {\n            dispatch(actions.authAddAuthorization(token) as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(mapStateToProps, mapDispatchToProps)(Auth)","\nimport uuidv4 from 'uuid/v4'\n\ninterface ListenerParams {\n    name: string,\n    onSuccess: (payload: Payload) => void,\n    onError: (error: Error) => void\n}\n\nclass Listener {\n    name: string;\n    onSuccess: (payload: Payload) => void;\n    onError: (error: Error) => void;\n\n    constructor({ name, onSuccess, onError }: ListenerParams) {\n        this.name = name;\n        this.onSuccess = onSuccess;\n        this.onError = onError;\n    }\n}\n\ntype Payload = any;\n\ninterface WaitingListenerParams extends ListenerParams {\n    timeout?: number\n}\n\nclass WaitingListener extends Listener {\n    started: Date;\n    timeout: number;\n\n    constructor(params: WaitingListenerParams) {\n        super(params);\n        this.started = new Date();\n        this.timeout = params.timeout || 5000;\n    }\n}\n\ninterface Envelope {\n    channelId: string\n    id: string\n}\n\nclass Message {\n    name: string;\n    payload: any;\n    id: string;\n    created: Date;\n    channel: any\n    envelope: Envelope | null\n\n    constructor({ name, payload, channel }: { name: string, payload: any, channel: any }) {\n        this.name = name\n        this.payload = payload\n        this.id = uuidv4()\n        this.created = new Date()\n        this.channel = channel\n        this.envelope = null;\n    }\n\n    getMessage() {\n        return {\n            envelope: {\n                id: this.id,\n                created: this.created,\n                channel: this.channel\n            },\n            name: this.name,\n            payload: this.payload\n        };\n    }\n}\n\ninterface Handler {\n    started: Date,\n    handler: (response: any) => any\n}\n\ninterface ChannelParams {\n    window: Window,\n    host: string,\n    channelId?: string\n}\n\nexport class Channel {\n    window: Window\n    host: string\n    id: string\n    awaitingResponse: Map<string, Handler>\n    waitingListeners: Map<string, Array<Listener>>\n    listeners: Map<string, Array<Listener>>\n    lastId: number\n    sentCount: number\n    receivedCount: number\n    unwelcomeReceivedCount: number\n    unwelcomeReceivedCountThreshhold: number\n    unwelcomeReceiptWarning: boolean\n    unwelcomeReceiptWarningCount: number\n    currentListener: ((message: MessageEvent) => void) | null\n\n    constructor(params: ChannelParams) {\n        // The given window upon which we will listen for messages.\n        this.window = params.window;\n\n        // The host for the window; required for postmessage\n        if (this.window.document === null) {\n            throw new Error('No document')\n        }\n        if (this.window.document.location === null) {\n            throw new Error('No location')\n        }\n        this.host = params.host || this.window.document.location.origin;\n\n        // The channel id. Used to filter all messages received to\n        // this channel.\n        this.id = params.channelId || uuidv4()\n\n\n        this.awaitingResponse = new Map<string, Handler>()\n        this.waitingListeners = new Map<string, Array<Listener>>()\n        this.listeners = new Map<string, Array<Listener>>()\n\n        this.lastId = 0\n        this.sentCount = 0\n        this.receivedCount = 0\n\n        this.unwelcomeReceivedCount = 0\n        this.unwelcomeReceivedCountThreshhold = 100\n        this.unwelcomeReceiptWarning = true\n        this.unwelcomeReceiptWarningCount = 0\n        this.currentListener = null\n    }\n\n    genId() {\n        this.lastId += 1;\n        return 'msg_' + String(this.lastId);\n    }\n\n    receiveMessage(messageEvent: MessageEvent) {\n        const message = messageEvent.data as Message;\n        if (!message) {\n            this.unwelcomeReceivedCount++;\n            if (this.unwelcomeReceiptWarning) {\n                console.warn('No message data; message ignored', messageEvent);\n            }\n            return;\n        }\n        if (!message.envelope) {\n            this.unwelcomeReceivedCount++;\n            if (this.unwelcomeReceiptWarning) {\n                console.warn('No message envelope, not from KBase; message ignored', messageEvent);\n            }\n            return;\n        }\n        if (!(message.envelope.channelId === this.id)) {\n            this.unwelcomeReceivedCount++;\n            if (this.unwelcomeReceiptWarning) {\n                console.warn('Message envelope does not match this channel\\'s id', messageEvent);\n            }\n            return;\n        }\n        if (this.unwelcomeReceiptWarningCount > this.unwelcomeReceivedCountThreshhold) {\n            this.unwelcomeReceiptWarning = false;\n            console.warn('Unwelcome message warning disabled after ' + this.unwelcomeReceiptWarningCount + ' instances.');\n        }\n\n        // A message sent as a request will have registered a response handler\n        // in the awaitingResponse hash, using a generated id as the key.\n        // TODO: to to rethink using the message id here. Perhaps somehting like a\n        // chain of ids, the root of which is the origination id, which is the one\n        // known here when it it is sent; the message \"id\" should be assigned whenver\n        // a message is sent, but a response  message would include the original\n        // message in the \"chain\"...\n\n        // We can also have awaiting responses without an originating request.\n        // These are useful for, e.g., a promise which awaits a message to be sent\n        // within some window...\n        if (message.envelope.id && this.awaitingResponse.has(message.envelope.id)) {\n            try {\n                const response = this.awaitingResponse.get(message.envelope.id)\n                this.awaitingResponse.delete(message.envelope.id)\n                if (response) {\n                    response.handler(message.payload)\n                }\n            } catch (ex) {\n                console.error('Error handling response for message ', message, ex);\n            }\n        }\n\n        // and also awaiting by message name. Like a listener, but they are only used\n        // once.\n        if (this.waitingListeners.has(message.name)) {\n            const awaiting = this.waitingListeners.get(message.name)!\n            this.waitingListeners.delete(message.name)\n            awaiting.forEach((listener) => {\n                try {\n                    listener.onSuccess(message.payload);\n                } catch (ex) {\n                    console.error('Error handling listener for message', message, ex);\n                    if (listener.onError) {\n                        listener.onError(ex);\n                    }\n                }\n            });\n        }\n\n        // Otherwise, permanently registered handlers are found in the listeners for the\n        // message name.\n        if (this.listeners.has(message.name)) {\n            this.listeners.get(message.name)!.forEach((listener) => {\n                if (!listener.onSuccess) {\n                    console.warn('no handler for listener!', listener);\n                }\n                try {\n                    listener.onSuccess(message.payload);\n                } catch (ex) {\n                    console.error('Error handling listener for message', message, ex);\n                    if (listener.onError) {\n                        listener.onError(ex);\n                    }\n                }\n            });\n        }\n    }\n\n    listen(listener: Listener) {\n        if (!this.listeners.has(listener.name)) {\n            this.listeners.set(listener.name, [])\n        }\n        this.listeners.get(listener.name)!.push(listener)\n    }\n\n    on(messageId: string, success: (payload: any) => any, error: (error: Error) => void) {\n        this.listen(new Listener({\n            name: messageId,\n            onSuccess: success,\n            onError: error\n        }));\n    }\n\n    sendMessage(message: Message) {\n        this.window.postMessage(message.getMessage(), this.host);\n    }\n\n    send(name: string, payload: Payload) {\n        const message = new Message({ name, payload, channel: this.id });\n        this.sendMessage(message);\n    }\n\n    sendRequest(message: Message, handler: (response: any) => any) {\n        this.awaitingResponse.set('message.id', {\n            started: new Date(),\n            handler: handler\n        })\n\n        this.sendMessage(message);\n    }\n\n    request(name: string, payload: Payload) {\n        return new Promise((resolve, reject) => {\n            try {\n                this.sendRequest(new Message({ name, payload, channel: this.id }), (response: any) => {\n                    resolve(response);\n                });\n            } catch (ex) {\n                reject(ex);\n            }\n        });\n    }\n\n    startMonitor() {\n        window.setTimeout(() => {\n            const now = new Date().getTime();\n\n            // first take care of listeners awaiting a message.\n            for (const [id, listeners] of this.waitingListeners.entries()) {\n                const newListeners = listeners.filter((listener) => {\n                    if (listener instanceof WaitingListener) {\n                        const elapsed = now - listener.started.getTime();\n                        if (elapsed > listener.timeout) {\n                            try {\n                                if (listener.onError) {\n                                    listener.onError(new Error('timout after ' + elapsed));\n                                }\n                            } catch (ex) {\n                                console.error('Error calling error handler', id, ex);\n                            }\n                            return false;\n                        } else {\n                            return true;\n                        }\n                    } else {\n                        return true;\n                    }\n                });\n                if (newListeners.length === 0) {\n                    this.waitingListeners.delete(id)\n                }\n            }\n\n            if (this.waitingListeners.size > 0) {\n                this.startMonitor()\n            }\n        }, 100);\n    }\n\n    listenOnce(listener: WaitingListener) {\n        if (!this.waitingListeners.has(listener.name)) {\n            this.waitingListeners.set(listener.name, [])\n        }\n        this.waitingListeners.get(listener.name)!.push(listener);\n        if (listener.timeout) {\n            this.startMonitor();\n        }\n    }\n\n    once(name: string, success: (payload: Payload) => void, error: (error: Error) => void) {\n        this.listenOnce(new WaitingListener({\n            name: name,\n            onSuccess: success,\n            onError: error\n        }));\n    }\n\n    when(name: string, timeout: number) {\n        return new Promise((resolve, reject) => {\n            return this.listenOnce(new WaitingListener({\n                name: name,\n                timeout: timeout,\n                onSuccess: (payload) => {\n                    resolve(payload);\n                },\n                onError: (error) => {\n                    reject(error);\n                }\n            }));\n        });\n    }\n\n    stats() {\n        return {\n            sent: this.sentCount,\n            received: this.receivedCount\n        };\n    }\n\n    attach(window: Window) {\n        this.window = window;\n    }\n\n    start() {\n        this.currentListener = (message: MessageEvent) => {\n            this.receiveMessage(message);\n        };\n        this.window.addEventListener('message', this.currentListener, false);\n    }\n\n    stop() {\n        if (this.currentListener) {\n            this.window.removeEventListener('message', this.currentListener, false);\n        }\n    }\n}\n","import uuid from 'uuid/v4'\nimport { Channel } from './windowChannel'\nimport { runInThisContext } from 'vm';\n\nexport interface IFrameParams {\n    channelId: string,\n    frameId: string,\n    params: {\n        groupsServiceURL: string,\n        userProfileServiceURL: string,\n        workspaceServiceURL: string\n    },\n    parentHost: string\n}\n/*\n channelId: \"3b33179e-8a6d-4ae9-bc95-af4c0492eaa6\"\nframeId: \"frame_kb_html_be553ee5-645c-4737-80ba-dcb642632f0c\"\nhostId: \"host_kb_html_9a3b5d5d-bb92-43ff-a443-73267aa31323\"\nparams: {}\nparentHost: \"https://ci.kbase.us\"\n\n*/\n\n/*\nIFrameSimulator\nThis little doozey allows us to create a simulated iframe. We can query it for\n the params placed on the iframe, and talk to it via the window channel -- it has \n its own window channel.\n Good thing we designed the channel for multiple channels per window.\n*/\nclass IFrameSimulator {\n    params: IFrameParams | null\n    channel: Channel\n\n    constructor() {\n        this.params = null\n\n        // create a window channel.\n\n        this.channel = new Channel({\n            window: window,\n            host: document.location!.origin\n        })\n\n    }\n\n    getParamsFromIFrame(): IFrameParams {\n        return {\n            channelId: this.channel.id,\n            frameId: uuid(),\n            params: {\n                groupsServiceURL: 'services/groups',\n                userProfileServiceURL: 'services/user_profile/rpc',\n                workspaceServiceURL: 'services/ws'\n            },\n            parentHost: document.location!.origin\n        }\n    }\n}\n\n\n\nexport default IFrameSimulator","export interface IFrameParams {\n    channelId: string,\n    frameId: string,\n    params: {\n        groupsServiceURL: string,\n        userProfileServiceURL: string,\n        workspaceServiceURL: string\n    },\n    parentHost: string\n}\n\nexport class IFrameIntegration {\n    getParamsFromIFrame() {\n        if (!window.frameElement) {\n            return null\n        }\n        if (!window.frameElement.hasAttribute('data-params')) {\n            // throw new Error('No params found in window!!');\n            return null\n        }\n        const params = window.frameElement.getAttribute('data-params');\n        if (params === null) {\n            // throw new Error('No params found in window!')\n            return null\n        }\n        return JSON.parse(decodeURIComponent(params)) as IFrameParams\n    }\n}","import { Action } from 'redux'\nimport { ThunkDispatch } from 'redux-thunk'\n\nimport { ActionFlag } from './index'\nimport * as types from '../../types'\nimport IFrameSimulator, { IFrameParams } from '../../lib/IFrameSimulator';\nimport { IFrameIntegration } from '../../lib/IFrameIntegration';\n\n// Action Definitions\n\n// export interface AppStart extends Action {\n//     type: ActionFlag.APP_START,\n\n// }\n\nexport interface AppSuccess extends Action {\n    type: ActionFlag.APP_SUCCESS,\n    config: types.AppConfig\n}\n\nexport interface AppError extends Action {\n    type: ActionFlag.APP_ERROR,\n    error: AppError\n}\n\n// Action Creators\n\nexport function appSuccess(config: types.AppConfig): AppSuccess {\n    return {\n        type: ActionFlag.APP_SUCCESS,\n        config: config\n    }\n}\n\nexport function appError(error: AppError): AppError {\n    return {\n        type: ActionFlag.APP_ERROR,\n        error: error\n    }\n}\n\n// Action Thunks\n\nexport function appStart() {\n    return (dispatch: ThunkDispatch<types.StoreState, void, Action>, getState: () => types.StoreState) => {\n        // check and see if we are in an iframe\n        const iframeParams = new IFrameIntegration().getParamsFromIFrame()\n\n        if (iframeParams) {\n            dispatch(appSuccess({\n                baseUrl: '',\n                services: {\n                    Groups: {\n                        url: iframeParams.params.groupsServiceURL\n                    },\n                    UserProfile: {\n                        url: iframeParams.params.userProfileServiceURL\n                    },\n                    Workspace: {\n                        url: iframeParams.params.userProfileServiceURL\n                    }\n                }\n            }))\n        } else {\n            const fakeIframeParams = new IFrameSimulator().getParamsFromIFrame()\n            dispatch(appSuccess({\n                baseUrl: '',\n                services: {\n                    Groups: {\n                        url: fakeIframeParams.params.groupsServiceURL\n                    },\n                    UserProfile: {\n                        url: fakeIframeParams.params.userProfileServiceURL\n                    },\n                    Workspace: {\n                        url: fakeIframeParams.params.workspaceServiceURL\n                    }\n                }\n            }))\n        }\n\n\n        // if so, get the params\n\n        // if not, use the fake to get it\n    }\n}\n","import * as React from 'react'\nimport './KBaseIntegration.css'\n\nimport { AppState } from '../types'\nimport { } from '../lib/IFrameSimulator'\n\nexport interface KBaseIntegrationProps {\n    status: AppState,\n    onAppStart: () => void\n}\nclass KBaseIntegration extends React.Component<KBaseIntegrationProps, object> {\n    constructor(props: KBaseIntegrationProps) {\n        super(props)\n\n        // const params = this.getParamsFromIFrame()\n\n        this.props.onAppStart()\n    }\n\n    render() {\n        // TODO: some test like \n        // {this.props.env === 'dev' ? this.buildAuthDev() : this.buildAuthProd()}\n\n        if (this.props.status === AppState.NONE) {\n            return (\n                <div className=\"KBaseIntegration\">\n                    Loading...\n                </div>\n            )\n        } else {\n            return (\n                <div className=\"KBaseIntegration\">\n                    {this.props.children}\n                </div>\n            )\n        }\n    }\n\n    // getParamsFromIFrame() {\n    //     if (!window.frameElement) {\n    //         return null\n    //     }\n    //     if (!window.frameElement.hasAttribute('data-params')) {\n    //         // throw new Error('No params found in window!!');\n    //         return null\n    //     }\n    //     const params = window.frameElement.getAttribute('data-params');\n    //     if (params === null) {\n    //         // throw new Error('No params found in window!')\n    //         return null\n    //     }\n    //     return JSON.parse(decodeURIComponent(params));\n    // }\n}\n\nexport default KBaseIntegration","import { Dispatch, Action } from 'redux'\nimport { connect } from 'react-redux'\n\nimport * as types from '../types'\nimport * as actions from '../redux/actions/app'\n\nimport KBaseIntegration from '../components/KBaseIntegration'\n\nexport interface OwnProps {\n\n}\n\ninterface StateProps {\n    status: types.AppState\n}\n\ninterface DispatchProps {\n    onAppStart: () => void\n}\n\nexport function mapStateToProps(state: types.StoreState, props: OwnProps): StateProps {\n    const { app: { status } } = state\n    return {\n        status\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<Action>): DispatchProps {\n    return {\n        onAppStart: () => {\n            dispatch(actions.appStart() as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, types.StoreState>(mapStateToProps, mapDispatchToProps)(KBaseIntegration)","import { ActionFlag } from './index'\nimport { Organization, GroupRequest, StoreState, AppError } from '../../types'\nimport { Model } from '../../data/model'\nimport { ThunkDispatch } from 'redux-thunk';\nimport { Action } from 'redux';\n\n// Action types\n\n\n// Start up requests manager\n\nexport interface ManageOrganizationRequests extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS\n}\n\nexport interface ManageOrganizationRequestsStart extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_START\n}\n\nexport interface ManageOrganizationRequestsSuccess extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_SUCCESS,\n    organization: Organization,\n    requests: Array<GroupRequest>\n}\n\nexport interface ManageOrganizationRequestsError extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_ERROR,\n    error: AppError\n}\n\n// Accept join requests\n\nexport interface ManageOrganizationRequestsAcceptJoinRequest extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST,\n    requestId: string\n}\n\nexport interface ManageOrganizationRequestsAcceptJoinRequestStart extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_START,\n    requestId: string\n}\n\nexport interface ManageOrganizationRequestsAcceptJoinRequestSuccess extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_SUCCESS,\n    request: GroupRequest\n}\n\nexport interface ManageOrganizationRequestsAcceptJoinRequestError extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_ERROR,\n    error: AppError\n}\n\n\nexport function manageOrganizationRequestsAcceptJoinRequestStart(requestId: string): ManageOrganizationRequestsAcceptJoinRequestStart {\n    return {\n        type: ActionFlag.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_START,\n        requestId: requestId\n    }\n}\n\nexport function manageOrganizationRequestsAcceptJoinRequestSuccess(request: GroupRequest): ManageOrganizationRequestsAcceptJoinRequestSuccess {\n    return {\n        type: ActionFlag.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_SUCCESS,\n        request: request\n    }\n}\n\nexport function manageOrganizationRequestsAcceptJoinRequestError(error: AppError): ManageOrganizationRequestsAcceptJoinRequestError {\n    return {\n        type: ActionFlag.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_ERROR,\n        error: error\n    }\n}\n\n// Deny join requests\n\nexport interface ManageOrganizationRequestsDenyJoinRequest extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST,\n    requestId: string\n}\n\nexport interface ManageOrganizationRequestsDenyJoinRequestStart extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_START,\n    requestId: string\n}\n\nexport interface ManageOrganizationRequestsDenyJoinRequestSuccess extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_SUCCESS,\n    request: GroupRequest\n}\n\nexport interface ManageOrganizationRequestsDenyJoinRequestError extends Action {\n    type: ActionFlag.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_ERROR,\n    error: AppError\n}\n\n\nexport function manageOrganizationRequestsDenyJoinRequestStart(requestId: string): ManageOrganizationRequestsDenyJoinRequestStart {\n    return {\n        type: ActionFlag.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_START,\n        requestId: requestId\n    }\n}\n\nexport function manageOrganizationRequestsDenyJoinRequestSuccess(request: GroupRequest): ManageOrganizationRequestsDenyJoinRequestSuccess {\n    return {\n        type: ActionFlag.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_SUCCESS,\n        request: request\n    }\n}\n\nexport function manageOrganizationRequestsDenyJoinRequestError(error: AppError): ManageOrganizationRequestsDenyJoinRequestError {\n    return {\n        type: ActionFlag.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_ERROR,\n        error: error\n    }\n}\n\n\n\n// Action generators\n\n\n\nexport function manageOrganizationRequestsStart(): ManageOrganizationRequestsStart {\n    return {\n        type: ActionFlag.ADMIN_MANAGE_REQUESTS_START\n    }\n}\n\nexport function manageOrganizationRequestsSuccess(organization: Organization, requests: Array<GroupRequest>): ManageOrganizationRequestsSuccess {\n    return {\n        type: ActionFlag.ADMIN_MANAGE_REQUESTS_SUCCESS,\n        organization: organization,\n        requests: requests\n    }\n}\n\nexport function manageOrganizationRequestsError(error: AppError): ManageOrganizationRequestsError {\n    return {\n        type: ActionFlag.ADMIN_MANAGE_REQUESTS_ERROR,\n        error: error\n    }\n}\n\n// Action thunks\n\nexport function manageOrganizationRequests(organizationId: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        const { auth: { authorization: { token, username } },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        // get requests \n        Promise.all([\n            model.getOrg(organizationId),\n            model.getPendingOrganizationRequests(organizationId)\n        ])\n            .then(([organization, requests]) => {\n                dispatch(manageOrganizationRequestsSuccess(organization, requests))\n            })\n            .catch((err) => {\n                dispatch(manageOrganizationRequestsError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}\n\nexport function manageOrganizationRequestsAcceptJoinRequest(requestId: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        const {\n            auth: { authorization: { token, username } },\n            manageOrganizationRequestsView,\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        if (!manageOrganizationRequestsView) {\n            return\n        }\n\n        Promise.all([\n            model.acceptRequest(requestId),\n        ])\n            .then(([request]) => {\n                dispatch(manageOrganizationRequestsAcceptJoinRequestSuccess(request))\n                if (manageOrganizationRequestsView.viewState) {\n                    dispatch(manageOrganizationRequests(manageOrganizationRequestsView.viewState.organization.id))\n                }\n            })\n            .catch((err) => {\n                dispatch(manageOrganizationRequestsAcceptJoinRequestError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}\n\nexport function manageOrganizationRequestsDenyJoinRequest(requestId: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        const {\n            auth: { authorization: { token, username } },\n            manageOrganizationRequestsView,\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        if (!manageOrganizationRequestsView) {\n            return\n        }\n\n        Promise.all([\n            model.denyRequest(requestId),\n        ])\n            .then(([request]) => {\n                dispatch(manageOrganizationRequestsDenyJoinRequestSuccess(request))\n                if (manageOrganizationRequestsView.viewState) {\n                    dispatch(manageOrganizationRequests(manageOrganizationRequestsView.viewState.organization.id))\n                }\n            })\n            .catch((err) => {\n                dispatch(manageOrganizationRequestsDenyJoinRequestError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}","import * as React from 'react'\nimport './User.css'\n\nimport Avatar from './Avatar'\nimport * as types from '../types';\n\nexport interface UserProps {\n    user: types.User\n    avatarSize?: number\n}\n\ninterface UserState {\n\n}\n\nclass User extends React.Component<UserProps, UserState> {\n    constructor(props: UserProps) {\n        super(props)\n    }\n\n    render() {\n        return (\n            <div className=\"User\">\n                <div className=\"avatarCol\">\n                    <Avatar user={this.props.user} size={this.props.avatarSize || 30} />\n                </div>\n                <div className=\"infoCol\">\n                    <div className=\"name\">\n                        <a href={\"#people/\" + this.props.user.username} target=\"_blank\">{this.props.user.realname}</a>\n                        {' '}\n                        {this.props.user.username}\n                                </div>\n                    <div className=\"organization\">\n                        {this.props.user.organization || <i>no organization in user profile</i>}\n                    </div>\n                    <div className=\"location\">\n                        {[this.props.user.city, this.props.user.state, this.props.user.country].filter(x => x).join(', ') || <i>no location information in user profile</i>}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default User","import * as React from 'react'\n\nimport './component.css'\nimport * as types from '../../types';\nimport Header from '../Header';\nimport { Icon, Button, Modal, Card } from 'antd';\nimport { Redirect } from 'react-router';\nimport User from '../User';\nimport OrganizationHeader from '../organizationHeader/container';\n\nexport interface ManageGroupRequestsProps {\n    // organizationId: string,\n    viewState: types.ManageOrganizationRequestsValue\n    // onStart: (organizationId: string) => void,\n    onAcceptJoinRequest: (requestId: string) => void,\n    onDenyJoinRequest: (requestId: string) => void\n}\n\nexport interface ManageGroupRequestsState {\n    cancelToBrowser: boolean\n    cancelToViewer: boolean\n}\n\nclass ManageGroupRequests extends React.Component<ManageGroupRequestsProps, ManageGroupRequestsState> {\n\n    constructor(props: ManageGroupRequestsProps) {\n        super(props)\n\n        this.state = {\n            cancelToBrowser: false,\n            cancelToViewer: false\n        }\n\n        // this.props.onStart(this.props.organizationId)\n    }\n\n    onClickCancelToBrowser() {\n        this.setState({ cancelToBrowser: true })\n    }\n\n    onClickCancelToViewer() {\n        this.setState({ cancelToViewer: true })\n    }\n    onAcceptJoinRequest(requestId: string) {\n        // if (!(this.props.manageOrganizationRequestsView && this.props.manageOrganizationRequestsView.viewState)) {\n        //     return\n        // }\n        this.props.onAcceptJoinRequest(requestId)\n    }\n    onDenyJoinRequest(requestId: string) {\n        // if (!(this.props.manageOrganizationRequestsView && this.props.manageOrganizationRequestsView.viewState)) {\n        //     return\n        // }\n        this.props.onDenyJoinRequest(requestId)\n    }\n    onViewProfile(username: string) {\n        window.open('#people/' + username, '_blank')\n    }\n    onShowInfo() {\n        Modal.info({\n            title: 'Manage Requests Help',\n            width: '50em',\n            content: (\n                <div>\n                    <p>This is the manage requests tool...</p>\n                </div>\n            )\n        })\n    }\n    renderHeader() {\n        let orgName: string\n        // if (this.props.manageOrganizationRequestsView && this.props.manageOrganizationRequestsView.viewState) {\n        //     orgName = this.props.manageOrganizationRequestsView.viewState.organization.name\n        // } else {\n        //     orgName = 'loading...'\n        // }\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            <Icon type=\"tool\" />\n                            {' '}\n                            Managing Requests for Org \"\n                            {this.props.viewState.organization.name}\n                            \"\n                        </span>\n                    </div>\n                    <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', justifyContent: 'flex-end', alignItems: 'center' }}>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToViewer.bind(this)}>\n                            Return to this Org\n                        </Button>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToBrowser.bind(this)}>\n                            Return to Orgs Browser\n                        </Button>\n                        <Button\n                            shape=\"circle\"\n                            icon=\"info\"\n                            onClick={this.onShowInfo.bind(this)}>\n                        </Button>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    renderLoadingHeader() {\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            Loading Org Editor...\n                        </span>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    // renderRequestType(type: types.RequestType) {\n\n    //     switch (type) {\n    //         case types.RequestType.JOIN_GROUP_REQUEST:\n    //             return 'Join Group Request'\n    //         case types.RequestType.JOIN_GROUP_INVITE:\n    //             return 'Join Group Invitation'\n    //         case types.RequestType.ADD_WORKSPACE_REQUEST:\n    //             return 'Add Workspace Request'\n    //         case types.RequestType.ADD_WORKSPACE_INVITE:\n    //             return 'Add Workspace Invitation'\n    //     }\n    // }\n\n    niceElapsed(someDate: Date) {\n        const nowDate = new Date()\n\n        const elapsed = Math.round((nowDate.getTime() - someDate.getTime()) / 1000);\n        const elapsedAbs = Math.abs(elapsed);\n\n        let measure, measureAbs, unit;\n        const maxDays = 90\n        if (elapsedAbs < 60 * 60 * 24 * maxDays) {\n            if (elapsedAbs === 0) {\n                return 'now';\n            } else if (elapsedAbs < 60) {\n                measure = elapsed;\n                measureAbs = elapsedAbs;\n                unit = 'second';\n            } else if (elapsedAbs < 60 * 60) {\n                measure = Math.round(elapsed / 60);\n                measureAbs = Math.round(elapsedAbs / 60);\n                unit = 'minute';\n            } else if (elapsedAbs < 60 * 60 * 24) {\n                measure = Math.round(elapsed / 3600);\n                measureAbs = Math.round(elapsedAbs / 3600);\n                unit = 'hour';\n            } else {\n                measure = Math.round(elapsed / (3600 * 24));\n                measureAbs = Math.round(elapsedAbs / (3600 * 24));\n                unit = 'day';\n            }\n\n            if (measureAbs > 1) {\n                unit += 's';\n            }\n\n            let prefix = null;\n            let suffix = null;\n            if (measure < 0) {\n                prefix = 'in';\n            } else if (measure > 0) {\n                suffix = 'ago';\n            }\n\n            return (prefix ? prefix + ' ' : '') + measureAbs + ' ' + unit + (suffix ? ' ' + suffix : '');\n        } else {\n            // otherwise show the actual date, with or without the year.\n            if (nowDate.getFullYear() === nowDate.getFullYear()) {\n                return Intl.DateTimeFormat('en-US', {\n                    month: 'short',\n                    day: 'numeric'\n                }).format(someDate)\n                // return shortMonths[date.getMonth()] + ' ' + date.getDate();\n            } else {\n                return Intl.DateTimeFormat('en-US', {\n                    month: 'short',\n                    day: 'numeric',\n                    year: 'numeric'\n                }).format(someDate)\n                // return shortMonths[date.getMonth()] + ' ' + date.getDate() + ', ' + date.getFullYear();\n            }\n        }\n    }\n\n    renderRequestJoinRequest(request: types.UserRequest) {\n        const title = (\n            <span>\n                <Icon type=\"user\" />\n                <Icon type=\"arrow-right\" />\n                <Icon type=\"team\" />\n                {' '}\n                Request to Join Group\n            </span>\n        )\n        const actions = [\n            <Button\n                type=\"primary\"\n                style={{ margin: '0 5px' }}\n                onClick={() => this.onAcceptJoinRequest.call(this, request.id)}>\n                Approve\n            </Button>,\n            <Button\n                type=\"danger\"\n                style={{ margin: '0 5px' }}\n                onClick={() => this.onDenyJoinRequest.call(this, request.id)}>\n                Deny\n            </Button>\n        ]\n\n        return (\n            <Card key={request.id}\n                title={title}\n                hoverable={true}\n                actions={actions}\n                headStyle={{ backgroundColor: 'rgba(200, 200, 200,0.3' }}\n                style={{ marginBottom: '10px' }}>\n                <table className=\"pendingRequestsTable\">\n                    <tr>\n                        <th>from</th>\n                        <td className=\"requester\">\n                            <User user={request.requester} avatarSize={50} />\n                        </td>\n                    </tr>\n                    <tr>\n                        <th>sent</th>\n                        <td className=\"createdAt\">{Intl.DateTimeFormat('en-US', {\n                            month: 'long',\n                            day: 'numeric',\n                            year: 'numeric'\n                        }).format(request.createdAt)}</td>\n                    </tr>\n                    <tr>\n                        <th>expires</th>\n                        <td className=\"expiresAt\">{Intl.DateTimeFormat('en-US', {\n                            month: 'long',\n                            day: 'numeric',\n                            year: 'numeric'\n                        }).format(request.expireAt)} ({this.niceElapsed(request.expireAt)})</td>\n                    </tr>\n                </table>\n            </Card>\n        )\n    }\n\n    renderRequestNarrativeRequest(request: types.WorkspaceRequest) {\n        const title = (\n            <span>\n                <Icon type=\"file\" />\n                <Icon type=\"arrow-right\" />\n                <Icon type=\"team\" />\n                {' '}\n                Request to Add Narrative\n            </span>\n        )\n        const actions = [\n            <Button\n                type=\"primary\"\n                style={{ margin: '0 5px' }}\n                onClick={() => this.onAcceptJoinRequest.call(this, request.id)}>\n                Approve\n            </Button>,\n            <Button\n                type=\"danger\"\n                style={{ margin: '0 5px' }}\n                onClick={() => this.onDenyJoinRequest.call(this, request.id)}>\n                Deny\n            </Button>\n        ]\n\n        return (\n            <Card key={request.id}\n                title={title}\n                hoverable={true}\n                actions={actions}\n                headStyle={{ backgroundColor: 'rgba(200, 200, 200,0.3' }}\n                style={{ marginBottom: '10px' }}>\n                <table className=\"pendingRequestsTable\">\n                    <tr>\n                        <th>from</th>\n                        <td className=\"requester\">\n                            <User user={request.requester} avatarSize={50} />\n                        </td>\n                    </tr>\n                    <tr>\n                        <th>narrative</th>\n                        <td className=\"narrative\">\n                            {request.workspace}\n                        </td>\n                    </tr>\n                    <tr>\n                        <th>sent</th>\n                        <td className=\"createdAt\">{Intl.DateTimeFormat('en-US', {\n                            month: 'long',\n                            day: 'numeric',\n                            year: 'numeric'\n                        }).format(request.createdAt)}</td>\n                    </tr>\n                    <tr>\n                        <th>expires</th>\n                        <td className=\"expiresAt\">{Intl.DateTimeFormat('en-US', {\n                            month: 'long',\n                            day: 'numeric',\n                            year: 'numeric'\n                        }).format(request.expireAt)} ({this.niceElapsed(request.expireAt)})</td>\n                    </tr>\n                </table>\n            </Card>\n        )\n    }\n\n    renderRequestAppRequest(request: types.AppRequest) {\n        const title = (\n            <span>\n                <Icon type=\"appstore\" />\n                <Icon type=\"arrow-right\" />\n                <Icon type=\"team\" />\n                {' '}\n                Request to Add App\n            </span>\n        )\n        const actions = [\n            <Button\n                type=\"primary\"\n                style={{ margin: '0 5px' }}\n                onClick={() => this.onAcceptJoinRequest.call(this, request.id)}>\n                Approve\n            </Button>,\n            <Button\n                type=\"danger\"\n                style={{ margin: '0 5px' }}\n                onClick={() => this.onDenyJoinRequest.call(this, request.id)}>\n                Deny\n            </Button>\n        ]\n\n        return (\n            <Card key={request.id}\n                title={title}\n                hoverable={true}\n                actions={actions}\n                headStyle={{ backgroundColor: 'rgba(200, 200, 200,0.3' }}\n                style={{ marginBottom: '10px' }}>\n                <table className=\"pendingRequestsTable\">\n                    <tr>\n                        <th>from</th>\n                        <td className=\"requester\">\n                            <User user={request.requester} avatarSize={50} />\n                        </td>\n                    </tr>\n                    <tr>\n                        <th>app</th>\n                        <td className=\"requester\">\n                            {request.app}\n                        </td>\n                    </tr>\n                    <tr>\n                        <th>sent</th>\n                        <td className=\"createdAt\">{Intl.DateTimeFormat('en-US', {\n                            month: 'long',\n                            day: 'numeric',\n                            year: 'numeric'\n                        }).format(request.createdAt)}</td>\n                    </tr>\n                    <tr>\n                        <th>expires</th>\n                        <td className=\"expiresAt\">{Intl.DateTimeFormat('en-US', {\n                            month: 'long',\n                            day: 'numeric',\n                            year: 'numeric'\n                        }).format(request.expireAt)} ({this.niceElapsed(request.expireAt)})</td>\n                    </tr>\n                </table>\n            </Card>\n        )\n    }\n\n    renderRequest(request: types.GroupRequest) {\n\n        switch (request.type) {\n            case types.RequestType.REQUEST:\n                switch (request.resourceType) {\n                    case types.RequestResourceType.USER:\n                        return this.renderRequestJoinRequest(request as types.UserRequest)\n                    case types.RequestResourceType.WORKSPACE:\n                        return this.renderRequestNarrativeRequest(request as types.WorkspaceRequest)\n                    case types.RequestResourceType.APP:\n                        return this.renderRequestAppRequest(request as types.AppRequest)\n                    default:\n                        throw new Error('Unsupported resource type: ' + request.resourceType)\n                }\n            case types.RequestType.INVITATION:\n                throw new Error('Should never see an invitation here')\n        }\n    }\n\n    // renderRequestxx(request: types.GroupRequest) {\n    //     const title = (\n    //         <span>\n    //             <Icon type=\"user\" />\n    //             <Icon type=\"arrow-right\" />\n    //             <Icon type=\"team\" />\n    //             {' '}\n    //             Request to Join Group\n    //         </span>\n    //     )\n    //     return (\n    //         <Card key={request.id}\n    //             title={title}\n    //             hoverable={true}\n    //             style={{ marginBottom: '10px' }}>\n    //             {this.renderRequestSpecificType(request)}\n    //         </Card>\n    //     )\n    // }\n\n    // renderRequestx(request: types.GroupRequest) {\n    //     return (\n    //         <div key={request.id} className=\"groupRequest\">\n    //             <div className=\"requestType\">{this.renderRequestType(request.type)}</div>\n    //             {/* <div className=\"field\">\n    //                 <span className=\"field-label\">type</span>\n    //                 <span className=\"requestType\">{this.renderRequestType(request.type)}</span>\n    //             </div> */}\n    //             {/* <div className=\"field\">\n    //                 <span className=\"field-label\">id</span>\n    //                 <span>{request.id}</span>\n    //             </div> */}\n    //             {this.renderRequestSpecificType(request)}\n    //         </div>\n    //     )\n    // }\n\n    renderRequests() {\n        // if (!(this.props.manageOrganizationRequestsView && this.props.manageOrganizationRequestsView.viewState)) {\n        //     return\n        // }\n        if (this.props.viewState.requests.length === 0) {\n            return (\n                <p style={{ textAlign: 'center', padding: '10px' }}>\n                    No pending requests for this organization\n                </p>\n            )\n        }\n        return this.props.viewState.requests.map((request) => {\n            return this.renderRequest(request)\n        })\n    }\n\n    render() {\n\n        if (this.state.cancelToBrowser) {\n            return <Redirect push to=\"/organizations\" />\n        }\n\n        if (this.state.cancelToViewer) {\n            return <Redirect push to={\"/viewOrganization/\" + this.props.viewState.organization.id} />\n        }\n\n        return (\n            <div className=\"ManageGroupRequests\">\n                {this.renderHeader()}\n                <OrganizationHeader organization={this.props.viewState.organization} />\n                <div className=\"row\">\n                    <div className=\"pendingCol\">\n                        <h2>Current Pending Requests ({this.props.viewState.organization.adminRequests.length})</h2>\n                        <div className=\"pendingRequests\">\n                            {this.renderRequests()}\n                        </div>\n                    </div>\n                    <div className=\"historyCol\">\n                        <h2>Request History</h2>\n                        <p>[to be done]</p>\n                        <p>This will show a browesable, searchable, filterable list\n                            of \"closed\" (canceled, accepted, denied) requests. Default shows\n                            all in descending date (modified) order\n                        </p>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default ManageGroupRequests","import { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\n\nimport * as types from '../../types'\nimport * as actions from '../../redux/actions/manageOrganizationRequests'\n\nimport Component from './component'\n\nexport interface OwnProps {\n    // organizationId: string\n}\n\ninterface StateProps {\n    viewState: types.ManageOrganizationRequestsValue\n}\n\ninterface DispatchProps {\n    // onStart: (organizationId: string) => void,\n    onAcceptJoinRequest: (requestId: string) => void,\n    onDenyJoinRequest: (requestId: string) => void\n}\n\nfunction mapStateToProps(state: types.StoreState, props: OwnProps): StateProps {\n    const {\n        manageOrganizationRequestsView\n    } = state\n    if (!manageOrganizationRequestsView.viewState) {\n        throw new Error('view state not loaded!')\n    }\n    return {\n        viewState: manageOrganizationRequestsView.viewState\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.ManageOrganizationRequests>): DispatchProps {\n    return {\n        // onStart: (organizationId: string) => {\n        //     dispatch(actions.manageOrganizationRequests(organizationId) as any)\n        // },\n        onAcceptJoinRequest: (requestId: string) => {\n            dispatch(actions.manageOrganizationRequestsAcceptJoinRequest(requestId) as any)\n        },\n        onDenyJoinRequest: (requestId: string) => {\n            dispatch(actions.manageOrganizationRequestsDenyJoinRequest(requestId) as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, types.StoreState>(mapStateToProps, mapDispatchToProps)(Component)\n\n","import * as React from 'react'\n\nimport { ComponentLoadingState } from '../../types'\nimport Container from './container'\n\nexport interface LoaderProps {\n    organizationId: string,\n    loadingState: ComponentLoadingState,\n    onLoad: (organizationId: string) => void\n}\n\ninterface LoaderState {\n\n}\n\nclass Loader extends React.Component<LoaderProps, LoaderState> {\n    constructor(props: LoaderProps) {\n        super(props)\n    }\n\n    renderLoading() {\n        return (\n            <div>\n                Loading...\n            </div>\n        )\n    }\n\n    render() {\n        switch (this.props.loadingState) {\n            case ComponentLoadingState.NONE:\n                this.props.onLoad(this.props.organizationId)\n                return this.renderLoading()\n            case ComponentLoadingState.LOADING:\n                return this.renderLoading()\n            case ComponentLoadingState.SUCCESS:\n                return (\n                    <Container />\n                )\n        }\n    }\n}\n\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\n\nimport * as types from '../../types'\nimport * as actions from '../../redux/actions/manageOrganizationRequests'\n\n// org id fed from the url\nexport interface OwnProps {\n    organizationId: string\n}\n\n// we unpack the view state?\ninterface StateProps {\n    loadingState: types.ComponentLoadingState\n}\n\n// the loader can just load this view\ninterface DispatchProps {\n    onLoad: (organizationId: string) => void\n}\n\nfunction mapStateToProps(state: types.StoreState, props: OwnProps): StateProps {\n    return {\n        loadingState: state.manageOrganizationRequestsView.state\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.ManageOrganizationRequests>): DispatchProps {\n    return {\n        onLoad: (organizationId: string) => {\n            dispatch(actions.manageOrganizationRequests(organizationId) as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, types.StoreState>(mapStateToProps, mapDispatchToProps)(Loader)","import { Action } from 'redux'\nimport { ThunkDispatch } from 'redux-thunk'\n\nimport { ActionFlag } from './index'\n\nimport { Organization, AppError, StoreState, MemberType } from '../../types'\nimport { Model } from '../../data/model'\n\n// LOADING\n\nexport interface ViewMembersLoad extends Action {\n    type: ActionFlag.VIEW_MEMBERS_LOAD,\n    organizationId: string\n}\n\nexport interface ViewMembersLoadStart extends Action {\n    type: ActionFlag.VIEW_MEMBERS_LOAD_START\n}\n\nexport interface ViewMembersUnload extends Action {\n    type: ActionFlag.VIEW_MEMBERS_UNLOAD\n}\n\nexport interface ViewMembersLoadSuccess extends Action {\n    type: ActionFlag.VIEW_MEMBERS_LOAD_SUCCESS,\n    organization: Organization\n}\n\nexport interface ViewMembersLoadError extends Action {\n    type: ActionFlag.VIEW_MEMBERS_LOAD_ERROR,\n    error: AppError\n}\n\n\nexport function viewMembersLoadStart(): ViewMembersLoadStart {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_LOAD_START\n    }\n}\n\nexport function viewMembersLoadSuccess(organization: Organization): ViewMembersLoadSuccess {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_LOAD_SUCCESS,\n        organization: organization\n    }\n}\n\nexport function viewMembersLoadError(error: AppError): ViewMembersLoadError {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_LOAD_ERROR,\n        error: error\n    }\n}\n\nexport function viewMembersUnload(): ViewMembersUnload {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_UNLOAD\n    }\n}\n\nexport function viewMembersLoad(organizationId: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(viewMembersLoadStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        model.getOrg(organizationId)\n            .then((org) => {\n                dispatch(viewMembersLoadSuccess(org))\n            })\n            .catch((err) => {\n                dispatch(viewMembersLoadError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}\n\n// Promoting member to admin\n\nexport interface ViewMembersPromoteToAdmin extends Action {\n    type: ActionFlag.VIEW_MEMBERS_PROMOTE_TO_ADMIN,\n    memberUsername: string\n}\n\nexport interface ViewMembersPromoteToAdminStart extends Action {\n    type: ActionFlag.VIEW_MEMBERS_PROMOTE_TO_ADMIN_START\n}\n\nexport interface ViewMembersPromoteToAdminSuccess extends Action {\n    type: ActionFlag.VIEW_MEMBERS_PROMOTE_TO_ADMIN_SUCCESS,\n    memberUsername: string\n}\n\nexport interface ViewMembersPromoteToAdminError extends Action {\n    type: ActionFlag.VIEW_MEMBERS_PROMOTE_TO_ADMIN_ERROR,\n    error: AppError\n}\n\n\nexport function viewMembersPromoteToAdminStart(): ViewMembersPromoteToAdminStart {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_PROMOTE_TO_ADMIN_START\n    }\n}\n\nexport function viewMembersPromoteToAdminSuccess(memberUsername: string): ViewMembersPromoteToAdminSuccess {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_PROMOTE_TO_ADMIN_SUCCESS,\n        memberUsername\n    }\n}\n\nexport function viewMembersPromoteToAdminError(error: AppError): ViewMembersPromoteToAdminError {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_PROMOTE_TO_ADMIN_ERROR,\n        error: error\n    }\n}\n\nexport function viewMembersPromoteToAdmin(memberUsername: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(viewMembersPromoteToAdminStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config },\n            viewMembersView: { view } } = getState()\n        if (view === null) {\n            throw new Error('view is not populated')\n        }\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        model.memberToAdmin(view.organization.id, memberUsername)\n            .then((org) => {\n                console.log('dispatching...', memberUsername)\n                dispatch(viewMembersPromoteToAdminSuccess(memberUsername))\n\n                // Brute force, update the in-store organization\n                // const { viewMembersView: { view } } = getState()\n\n                // if (!view) {\n                //     dispatch(viewMembersPromoteToAdminError({\n                //         code: 'NoView',\n                //         message: 'No view for viewMembers'\n                //     }))\n                //     return\n                // }\n\n\n                // dispatch(viewMembersLoad(view.organization.id))\n            })\n            .catch((err: Error) => {\n                dispatch(viewMembersPromoteToAdminError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}\n\n// Demote admin to member\n\nexport interface ViewMembersDemoteToMember extends Action {\n    type: ActionFlag.VIEW_MEMBERS_DEMOTE_TO_MEMBER,\n    memberUsername: string\n}\n\nexport interface ViewMembersDemoteToMemberStart extends Action {\n    type: ActionFlag.VIEW_MEMBERS_DEMOTE_TO_MEMBER_START\n}\n\nexport interface ViewMembersDemoteToMemberSuccess extends Action {\n    type: ActionFlag.VIEW_MEMBERS_DEMOTE_TO_MEMBER_SUCCESS,\n    memberUsername: string\n}\n\nexport interface ViewMembersDemoteToMemberError extends Action {\n    type: ActionFlag.VIEW_MEMBERS_DEMOTE_TO_MEMBER_ERROR,\n    error: AppError\n}\n\n\nexport function viewMembersDemoteToMemberStart(): ViewMembersDemoteToMemberStart {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_DEMOTE_TO_MEMBER_START\n    }\n}\n\nexport function viewMembersDemoteToMemberSuccess(memberUsername: string): ViewMembersDemoteToMemberSuccess {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_DEMOTE_TO_MEMBER_SUCCESS,\n        memberUsername: memberUsername\n    }\n}\n\nexport function viewMembersDemoteToMemberError(error: AppError): ViewMembersDemoteToMemberError {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_DEMOTE_TO_MEMBER_ERROR,\n        error: error\n    }\n}\n\nexport function viewMembersDemoteToMember(memberUsername: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(viewMembersDemoteToMemberStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config },\n            viewMembersView: { view } } = getState()\n        if (view === null) {\n            throw new Error('view is not populated')\n        }\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        model.adminToMember(view.organization.id, memberUsername)\n            .then((org) => {\n                dispatch(viewMembersDemoteToMemberSuccess(memberUsername))\n                // dispatch(viewMembersLoad(view.organization.id))\n            })\n            .catch((err: Error) => {\n                dispatch(viewMembersDemoteToMemberError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}\n\n// Remove a member\n\nexport interface ViewMembersRemoveMember extends Action {\n    type: ActionFlag.VIEW_MEMBERS_REMOVE_MEMBER,\n    memberUsername: string\n}\n\ninterface RemoveMemberStart extends Action {\n    type: ActionFlag.VIEW_MEMBERS_REMOVE_MEMBER_START\n}\n\ninterface RemoveMemberSuccess extends Action {\n    type: ActionFlag.VIEW_MEMBERS_REMOVE_MEMBER_SUCCESS\n}\n\ninterface RemoveMemberError extends Action {\n    type: ActionFlag.VIEW_MEMBERS_REMOVE_MEMBER_ERROR,\n    error: AppError\n}\n\nfunction removeMemberStart(): RemoveMemberStart {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_REMOVE_MEMBER_START\n    }\n}\n\nfunction removeMemberSuccess(): RemoveMemberSuccess {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_REMOVE_MEMBER_SUCCESS\n    }\n}\n\nfunction removeMemberError(error: AppError): RemoveMemberError {\n    return {\n        type: ActionFlag.VIEW_MEMBERS_REMOVE_MEMBER_ERROR,\n        error: error\n    }\n}\n\nexport function viewMembersRemoveMember(memberUsername: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(removeMemberStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config },\n            viewMembersView: { view } } = getState()\n        if (view === null) {\n            throw new Error('view is not populated')\n        }\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        model.removeMember(view.organization.id, memberUsername)\n            .then(() => {\n                dispatch(removeMemberSuccess())\n                dispatch(viewMembersLoad(view.organization.id))\n            })\n            .catch((err: Error) => {\n                dispatch(removeMemberError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}","import * as React from 'react'\n\nimport './component.css'\n\nimport { Member, Organization, UserRelationToOrganization, MemberType } from '../../types'\nimport { Button, Icon, Menu, Dropdown } from 'antd';\nimport MemberComponent from '../Member';\n\ninterface MemberRowProps {\n    member: Member,\n    organization: Organization,\n    onPromoteMemberToAdmin: (memberUsername: string) => void,\n    onDemoteAdminToMember: (adminUsername: string) => void,\n    onRemoveMember: (memberUsername: string) => void\n}\n\ninterface MemberRowState {\n    over: boolean\n}\n\nclass MemberRow extends React.Component<MemberRowProps, MemberRowState> {\n    constructor(props: MemberRowProps) {\n        super(props)\n        this.state = {\n            over: false\n        }\n    }\n\n    renderPromoteButton() {\n        switch (this.props.member.type) {\n            case MemberType.MEMBER:\n                return (\n                    <Button\n                        style={{ width: '100%' }}\n                        disabled={!this.state.over}\n                        onClick={() => { this.props.onPromoteMemberToAdmin(this.props.member.user.username) }}>\n                        <Icon type=\"unlock\" />Promote to Admin\n                    </Button>\n                )\n            case MemberType.ADMIN:\n                return (<Button\n                    style={{ width: '100%' }}\n                    disabled={!this.state.over}\n                    onClick={() => { this.props.onDemoteAdminToMember(this.props.member.user.username) }}>\n                    <Icon type=\"user\" />Demote to Member\n                </Button>\n                )\n            case MemberType.OWNER:\n                return\n        }\n\n    }\n\n    renderMemberButtons(member: Member) {\n        if (!(this.props.organization.relation.type === UserRelationToOrganization.OWNER ||\n            this.props.organization.relation.type === UserRelationToOrganization.ADMIN)) {\n            return\n        }\n        // if (!this.state.over) {\n        //     return\n        // }\n        return (\n            <div>\n                <div>\n                    <Button\n                        type=\"danger\"\n                        disabled={!this.state.over}\n                        style={{ width: '100%' }}\n                        onClick={() => { this.props.onRemoveMember(member.user.username) }}>\n                        <Icon type=\"delete\" />Remove from Org\n                    </Button>\n                </div>\n                <div>\n                    {this.renderPromoteButton()}\n                </div>\n            </div>\n        )\n    }\n\n    renderMemberMenu(member: Member) {\n        const menu = (\n            <Menu>\n                <Menu.Item key=\"promoteToAdmin\" onClick={() => { console.log('here'); this.props.onPromoteMemberToAdmin(member.user.username) }} >\n                    <Icon type=\"unlock\" />Promote to Admin\n                </Menu.Item>\n                <Menu.Item key=\"removeMember\" type=\"danger\" onClick={() => { this.props.onRemoveMember(member.user.username) }}>\n                    <Icon type=\"delete\" />Remove Member\n                </Menu.Item>\n            </Menu>\n        )\n        return (\n            <div>\n                <Dropdown overlay={menu} trigger={['click']}>\n                    <Button icon=\"ellipsis\" />\n                </Dropdown>\n            </div>\n        )\n    }\n\n    renderAdminMenu(member: Member) {\n        const menu = (\n            <Menu>\n                <Menu.Item key=\"demoteToMember\" onClick={() => { this.props.onDemoteAdminToMember(member.user.username) }}>\n                    <Icon type=\"user\" />Demote to Member\n                    </Menu.Item>\n            </Menu>\n        )\n        return (\n            <div>\n                <Dropdown overlay={menu} trigger={['click']}>\n                    <Button icon=\"ellipsis\" />\n                </Dropdown>\n            </div>\n        )\n    }\n\n    renderOwnerMenu(member: Member) {\n        return\n    }\n\n    renderMemberOptions(member: Member) {\n        if (!(this.props.organization.relation.type === UserRelationToOrganization.OWNER ||\n            this.props.organization.relation.type === UserRelationToOrganization.ADMIN)) {\n            return\n        }\n\n        switch (this.props.member.type) {\n            case MemberType.OWNER:\n                return this.renderOwnerMenu(member)\n            case MemberType.ADMIN:\n                return this.renderAdminMenu(member)\n            case MemberType.MEMBER:\n                return this.renderMemberMenu(member)\n        }\n    }\n\n    onMouseOver() {\n        this.setState({ over: true })\n    }\n\n    onMouseOut() {\n        this.setState({ over: false })\n    }\n\n    render() {\n        return (\n            <div key={this.props.member.user.username}\n                className=\"memberRow\"\n                onMouseEnter={this.onMouseOver.bind(this)}\n                onMouseLeave={this.onMouseOut.bind(this)}>\n                <div style={{ flex: '1 1 0px' }}>\n                    <MemberComponent member={this.props.member} avatarSize={50} key={this.props.member.user.username} />\n                </div>\n                <div style={{ flex: '0 0 10em', textAlign: 'right' }}>\n                    {/* {this.renderMemberButtons(this.props.member)} */}\n                    {this.renderMemberOptions(this.props.member)}\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default MemberRow","import * as React from 'react'\n\nimport './component.css'\n\nimport { Member, Organization, UserRelationToOrganization, MemberType } from '../../types'\nimport Header from '../Header'\nimport { Redirect } from 'react-router'\nimport { Button, Icon, Modal, Row, Col, Menu, Dropdown } from 'antd';\nimport MemberComponent from '../Member';\nimport MemberRowComponent from './MemberRow'\nimport { NavLink } from 'react-router-dom';\nimport OrganizationHeader from '../organizationHeader/container';\n\nexport interface ViewMembersProps {\n    organization: Organization,\n    onViewMembersUnload: () => void,\n    onPromoteMemberToAdmin: (memberUsername: string) => void,\n    onDemoteAdminToMember: (adminUsername: string) => void,\n    onRemoveMember: (memberUsername: string) => void\n}\n\ninterface ViewMembersState {\n    cancelToBrowser: boolean\n    cancelToViewer: boolean\n}\n\n\n\nclass ViewMembers extends React.Component<ViewMembersProps, ViewMembersState> {\n    constructor(props: ViewMembersProps) {\n        super(props)\n\n        this.state = {\n            cancelToBrowser: false,\n            cancelToViewer: false\n        }\n    }\n\n    onClickCancelToBrowser() {\n        this.setState({ cancelToBrowser: true })\n    }\n\n    onClickCancelToViewer() {\n        this.setState({ cancelToViewer: true })\n    }\n\n    onPromoteMemberToAdmin(memberUsername: string) {\n        console.log('here', memberUsername)\n        this.props.onPromoteMemberToAdmin(memberUsername)\n    }\n\n    onDemoteAdminToMember(adminUsername: string) {\n        this.props.onDemoteAdminToMember(adminUsername)\n    }\n\n    onShowInfo() {\n        Modal.info({\n            title: 'View Members Help',\n            width: '50em',\n            content: (\n                <div>\n                    <p>This is the view members tool...</p>\n                </div>\n            )\n        })\n    }\n\n    isMember(): boolean {\n        if (!this.props.organization) {\n            return false\n        }\n        if (this.props.organization.relation.type === UserRelationToOrganization.OWNER ||\n            this.props.organization.relation.type === UserRelationToOrganization.ADMIN ||\n            this.props.organization.relation.type === UserRelationToOrganization.MEMBER) {\n            return true\n        }\n        return false\n    }\n\n    renderHeader() {\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            <Icon type=\"tool\" />\n                            {' '}\n                            Viewing Members for Org \"\n                            {this.props.organization.name}\n                            \"\n                        </span>\n                    </div>\n                    <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', justifyContent: 'flex-end', alignItems: 'center' }}>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToViewer.bind(this)}>\n                            Return to this Org\n                        </Button>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToBrowser.bind(this)}>\n                            Return to Orgs Browser\n                        </Button>\n                        <Button\n                            shape=\"circle\"\n                            icon=\"info\"\n                            onClick={this.onShowInfo.bind(this)}>\n                        </Button>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    renderMembersToolbar() {\n        switch (this.props.organization.relation.type) {\n            case UserRelationToOrganization.NONE:\n                return (\n                    <div className=\"toolbar\">\n                        <Button><Icon type=\"plus\" />Join</Button>\n                    </div>\n                )\n\n            case UserRelationToOrganization.MEMBER:\n                return (\n                    <div className=\"toolbar\">\n                    </div>\n                )\n\n            case UserRelationToOrganization.ADMIN:\n                return (\n                    <div className=\"toolbar\">\n                        <NavLink to={\"/inviteUser/\" + this.props.organization.id}><Button><Icon type=\"mail\" /> Invite a User</Button></NavLink>\n                    </div>\n                )\n\n            case UserRelationToOrganization.OWNER:\n                return (\n                    <div className=\"toolbar\">\n                        <NavLink to={\"/inviteUser/\" + this.props.organization.id}><Button><Icon type=\"mail\" /> Invite a User</Button></NavLink>\n                    </div>\n                )\n\n        }\n    }\n\n    // renderMemberButtons(member: UserBase) {\n    //     if (!(this.props.organization.relation.type === UserRelationToOrganization.OWNER ||\n    //         this.props.organization.relation.type === UserRelationToOrganization.ADMIN)) {\n    //         return\n    //     }\n    //     return (\n    //         <div>\n    //             <div><Button type=\"danger\" style={{ width: '100%' }}><Icon type=\"delete\" />Remove from Org</Button></div>\n    //             <div><Button style={{ width: '100%' }} onClick={() => { this.onPromoteMemberToAdmin.call(this, member.username) }}><Icon type=\"unlock\" />Promote to Admin</Button></div>\n    //         </div>\n    //     )\n    // }\n\n    renderMembers() {\n        let members\n        if (!this.isMember()) {\n            return (\n                <p className=\"message\">\n                    Sorry, group membership restricted to members only\n                </p>\n            )\n        }\n        if (this.props.organization.members.length === 0) {\n            members = (\n                <p className=\"message\">\n                    This organization has no members\n                </p>\n            )\n        } else {\n            members = this.props.organization.members.map((member) => (\n                <MemberRowComponent\n                    member={member}\n                    organization={this.props.organization}\n                    onPromoteMemberToAdmin={this.props.onPromoteMemberToAdmin}\n                    onDemoteAdminToMember={this.props.onDemoteAdminToMember}\n                    onRemoveMember={this.props.onRemoveMember}\n                />\n            ))\n        }\n        return (\n            <div className=\"table infoTable\">\n                <div className=\"row\">\n                    <div className=\"col0\" style={{ display: 'flex', flexDirection: 'column', overflowY: 'auto' }}>\n                        {members}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n    renderAdminsToolbar() {\n        return (\n            <div className=\"toolbar\">\n\n            </div>\n        )\n    }\n    renderAdminButtons(admin: Member) {\n        if (!(this.props.organization.relation.type === UserRelationToOrganization.OWNER ||\n            this.props.organization.relation.type === UserRelationToOrganization.ADMIN)) {\n            return\n        }\n        return (\n            <div>\n                <div><Button type=\"danger\" style={{ width: '100%' }}><Icon type=\"delete\" />Remove from Org</Button></div>\n                <div><Button style={{ width: '100%' }} onClick={() => { this.onDemoteAdminToMember.call(this, admin.user.username) }}><Icon type=\"user\" />Demote to Member</Button></div>\n            </div>\n        )\n    }\n    renderAdmins() {\n        const admins = this.props.organization.members.filter((member) => (member.type === MemberType.ADMIN))\n        let adminList\n        if (admins.length === 0) {\n            adminList = (\n                <p style={{ fontStyle: 'italic', textAlign: 'center' }}>\n                    This organization has no admins\n                </p>\n            )\n        } else {\n            adminList = admins.map((member) => {\n                return (\n                    <div key={member.user.username} style={{ flex: '0 0 auto', display: 'flex', flexDirection: 'row' }}>\n                        <div style={{ flex: '1 1 0px' }}>\n                            <MemberComponent member={member} avatarSize={50} key={member.user.username} />\n                        </div>\n                        <div style={{ flex: '0 0 10em' }}>\n                            {this.renderAdminButtons(member)}\n                        </div>\n                    </div>\n\n                )\n            })\n        }\n        return (\n            <div className=\"table infoTable\">\n                <div className=\"row\">\n                    <div className=\"col0\" style={{ display: 'flex', flexDirection: 'column', overflowY: 'auto' }}>\n                        {adminList}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    renderOrganizationHeader() {\n        return (\n            <OrganizationHeader organization={this.props.organization} />\n        )\n    }\n\n    componentWillUnmount() {\n        console.log('unmounting...')\n        this.props.onViewMembersUnload()\n    }\n\n    render() {\n\n        if (this.state.cancelToBrowser) {\n            return <Redirect push to=\"/organizations\" />\n        }\n\n        if (this.state.cancelToViewer) {\n            return <Redirect push to={\"/viewOrganization/\" + this.props.organization.id} />\n        }\n\n        return (\n            <div className=\"ViewMembers\">\n                {this.renderHeader()}\n                {this.renderOrganizationHeader()}\n                <div className=\"body\">\n                    <div className=\"membersCol\">\n                        <h2>Members</h2>\n                        {this.renderMembersToolbar()}\n                        {this.renderMembers()}\n                    </div>\n                    <div className=\"otherCol\">\n                        <h2>Admins</h2>\n                        {this.renderAdminsToolbar()}\n                        {this.renderAdmins()}\n                    </div>\n                </div>\n\n            </div>\n        )\n    }\n}\n\nexport default ViewMembers","import { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\n\nimport * as types from '../../types'\nimport * as actions from '../../redux/actions/viewMembers'\nimport ViewMembers from './component'\n\nexport interface OwnProps {\n\n}\n\ninterface StateProps {\n    organization: types.Organization\n}\n\ninterface DispatchProps {\n    onViewMembersUnload: () => void,\n    onPromoteMemberToAdmin: (memberUsername: string) => void,\n    onDemoteAdminToMember: (adminUsername: string) => void,\n    onRemoveMember: (memberUsername: string) => void\n}\n\nfunction mapStateToProps(state: types.StoreState, props: OwnProps): StateProps {\n    if (!state.viewMembersView || (state.viewMembersView.view === null)) {\n        throw new Error('Runtime Error - view members view is not defined!')\n    }\n    return {\n        organization: state.viewMembersView.view.organization\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.ViewMembersLoad>): DispatchProps {\n    return {\n        onViewMembersUnload: () => {\n            dispatch(actions.viewMembersUnload() as any)\n        },\n        onPromoteMemberToAdmin: (memberUsername: string) => {\n            dispatch(actions.viewMembersPromoteToAdmin(memberUsername) as any)\n        },\n        onDemoteAdminToMember: (adminUsername: string) => {\n            dispatch(actions.viewMembersDemoteToMember(adminUsername) as any)\n        },\n        onRemoveMember: (memberUsername: string) => {\n            dispatch(actions.viewMembersRemoveMember(memberUsername) as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, types.StoreState>(mapStateToProps, mapDispatchToProps)(ViewMembers)","import * as React from 'react'\n\nimport './component.css'\n\nimport { ViewMembersViewState } from '../../types'\nimport ViewMembersContainer from './container'\n\nexport interface ViewMemberLoaderProps {\n    organizationId: string,\n    state: ViewMembersViewState,\n    onViewMembersLoad: (organizationId: string) => void\n}\n\ninterface ViewMemberLoaderState {\n\n}\n\nclass ViewMembersLoader extends React.Component<ViewMemberLoaderProps, ViewMemberLoaderState> {\n    constructor(props: ViewMemberLoaderProps) {\n        super(props)\n    }\n\n    renderLoading() {\n        return (\n            <div>\n                Loading...\n            </div>\n        )\n    }\n\n    render() {\n        switch (this.props.state) {\n            case ViewMembersViewState.NONE:\n                this.props.onViewMembersLoad(this.props.organizationId)\n                return this.renderLoading()\n            case ViewMembersViewState.LOADING:\n                return this.renderLoading()\n            case ViewMembersViewState.SUCCESS:\n                return (\n                    <ViewMembersContainer />\n                )\n        }\n    }\n}\n\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\n\nimport * as types from '../../types'\nimport * as actions from '../../redux/actions/viewMembers'\n// import ViewMembers from './component'\n\nexport interface OwnProps {\n    organizationId: string\n}\n\ninterface StateProps {\n    state: types.ViewMembersViewState\n}\n\ninterface DispatchProps {\n    onViewMembersLoad: (organizationId: string) => void\n}\n\nfunction mapStateToProps(state: types.StoreState, props: OwnProps): StateProps {\n    return {\n        state: state.viewMembersView.state\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.ViewMembersLoad>): DispatchProps {\n    return {\n        onViewMembersLoad: (organizationId: string) => {\n            dispatch(actions.viewMembersLoad(organizationId) as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, types.StoreState>(mapStateToProps, mapDispatchToProps)(ViewMembersLoader)","import { Action } from 'redux'\nimport { ThunkDispatch } from 'redux-thunk'\n\nimport { ActionFlag } from './index'\n\nimport { AppError, StoreState, Organization, BriefUser, User, InviteUserState, InviteUserValue } from '../../types'\nimport { Model } from '../../data/model'\nimport * as userProfile from '../../data/userProfile'\n\n// View Loading\n\nexport interface InviteUserLoad extends Action {\n    type: ActionFlag.INVITE_USER_LOAD\n}\n\nexport interface InviteUserLoadStart extends Action {\n    type: ActionFlag.INVITE_USER_LOAD_START\n}\n\nexport interface InviteUserLoadReady extends Action {\n    type: ActionFlag.INVITE_USER_LOAD_READY,\n    organization: Organization,\n    // users: Array<User>\n}\n\nexport interface InviteUserLoadError extends Action {\n    type: ActionFlag.INVITE_USER_LOAD_ERROR,\n    error: AppError\n}\n\n\n\nexport function inviteUserLoadStart(): InviteUserLoadStart {\n    return {\n        type: ActionFlag.INVITE_USER_LOAD_START\n    }\n}\n\nexport function inviteUserLoadReady(organization: Organization): InviteUserLoadReady {\n    return {\n        type: ActionFlag.INVITE_USER_LOAD_READY,\n        organization: organization,\n        // users: users\n    }\n}\n\nexport function inviteUserLoadError(error: AppError): InviteUserLoadError {\n    return {\n        type: ActionFlag.INVITE_USER_LOAD_ERROR,\n        error: error\n    }\n}\n\nexport function inviteUserLoad(organizationId: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(inviteUserLoadStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config } } = getState()\n\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        Promise.all([\n            model.getOrg(organizationId),\n            // userProfileClient.getAllUsers()\n        ])\n            .then(([org, users]) => {\n                dispatch(inviteUserLoadReady(org))\n            })\n            .catch((err) => {\n                dispatch(inviteUserLoadError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n\n    }\n}\n\n// User Selection\n\nexport interface InviteUserSearchUsers extends Action {\n    type: ActionFlag.INVITE_USER_SEARCH_USERS,\n    query: string\n}\n\ninterface SearchUsersStart extends Action {\n    type: ActionFlag.INVITE_USER_SEARCH_USERS_START\n}\n\nexport interface SearchUsersSuccess extends Action {\n    type: ActionFlag.INVITE_USER_SEARCH_USERS_SUCCESS,\n    users: Array<BriefUser>\n}\n\ninterface SearchUsersError extends Action {\n    type: ActionFlag.INVITE_USER_SEARCH_USERS_ERROR,\n    error: AppError\n}\n\nfunction searchUsersStart(): SearchUsersStart {\n    return {\n        type: ActionFlag.INVITE_USER_SEARCH_USERS_START\n    }\n}\n\nfunction searchUsersSuccess(users: Array<BriefUser>): SearchUsersSuccess {\n    return {\n        type: ActionFlag.INVITE_USER_SEARCH_USERS_SUCCESS,\n        users: users\n    }\n}\n\nfunction searchUsersError(error: AppError): SearchUsersError {\n    return {\n        type: ActionFlag.INVITE_USER_SEARCH_USERS_ERROR,\n        error: error\n    }\n}\n\nexport function inviteUserSearchUsers(query: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(searchUsersStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config } } = getState()\n\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        Promise.all([\n            model.searchUsers(query)\n        ])\n            .then(([users]) => {\n                dispatch(searchUsersSuccess(users))\n            })\n            .catch((err) => {\n                dispatch(searchUsersError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n\n}\n\n// Select a user\n\nexport interface SelectUser extends Action {\n    type: ActionFlag.INVITE_USER_SELECT_USER,\n    username: string\n}\n\ninterface SelectUserStart extends Action {\n    type: ActionFlag.INVITE_USER_SELECT_USER_START\n}\n\nexport interface SelectUserSuccess extends Action {\n    type: ActionFlag.INVITE_USER_SELECT_USER_SUCCESS,\n    user: User\n}\n\ninterface SelectUserError extends Action {\n    type: ActionFlag.INVITE_USER_SELECT_USER_ERROR,\n    error: AppError\n}\n\n\nfunction selectUserStart(): SelectUserStart {\n    return {\n        type: ActionFlag.INVITE_USER_SELECT_USER_START\n    }\n}\n\nfunction selectUserSuccess(user: User): SelectUserSuccess {\n    return {\n        type: ActionFlag.INVITE_USER_SELECT_USER_SUCCESS,\n        user: user\n    }\n}\n\nfunction selectUserError(error: AppError): SelectUserError {\n    return {\n        type: ActionFlag.INVITE_USER_SELECT_USER_ERROR,\n        error: error\n    }\n}\n\nexport function selectUser(selectedUsername: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(selectUserStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config } } = getState()\n\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        model.getUser(selectedUsername)\n            .then((user) => {\n                dispatch(selectUserSuccess(user))\n            })\n            .catch((err) => {\n                dispatch(selectUserError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}\n\n// Now send the invitation, whew!\n\nexport interface SendInvitation extends Action {\n    type: ActionFlag.INVITE_USER_SEND_INVITATION\n}\n\ninterface SendInvitationStart extends Action {\n    type: ActionFlag.INVITE_USER_SEND_INVITATION_START\n}\n\ninterface SendInvitationSuccess extends Action {\n    type: ActionFlag.INVITE_USER_SEND_INVITATION_SUCCESS\n}\n\ninterface SendInvitationError extends Action {\n    type: ActionFlag.INVITE_USER_SEND_INVITATION_ERROR,\n    error: AppError\n}\n\n\nfunction sendInvitationStart(): SendInvitationStart {\n    return {\n        type: ActionFlag.INVITE_USER_SEND_INVITATION_START\n    }\n}\n\nfunction sendInvitationSuccess(): SendInvitationSuccess {\n    return {\n        type: ActionFlag.INVITE_USER_SEND_INVITATION_SUCCESS\n    }\n}\n\nfunction sendInvitationError(error: AppError): SendInvitationError {\n    return {\n        type: ActionFlag.INVITE_USER_SEND_INVITATION_ERROR,\n        error: error\n    }\n}\n\nexport function sendInvitation() {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(sendInvitationStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config },\n            inviteUserView: { state, viewState } } = getState()\n\n        if (state !== InviteUserState.READY) {\n            return\n        }\n\n        if (viewState === null) {\n            return\n        }\n\n        const { selectedUser, organization: { id } } = viewState as InviteUserValue\n\n        if (!selectedUser) {\n            return\n        }\n\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        model.requestJoinGroup(id, selectedUser.username)\n            .then((groupRequest) => {\n                dispatch(sendInvitationSuccess())\n            })\n            .catch((err) => {\n                dispatch(sendInvitationError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n}","import * as React from 'react'\n\nimport './InviteUser.css'\nimport { BriefUser, Organization, User } from '../../types';\nimport { Button, AutoComplete, Input, Icon, Modal } from 'antd';\nimport Header from '../Header';\nimport { Redirect } from 'react-router-dom';\n\nexport interface InviteUserProps {\n    organization: Organization,\n    users: Array<BriefUser>\n    selectedUser: User | null,\n    onSearchUsers: (query: string) => void,\n    onSelectUser: (username: string) => void,\n    onSendInvitation: () => void\n}\n\ninterface InviteUserState {\n    cancelToViewMembers: boolean\n    cancelToBrowser: boolean\n    cancelToViewer: boolean\n    autocompleteMessage: string\n}\n\nclass InviteUser extends React.Component<InviteUserProps, InviteUserState> {\n\n    lastSearchAt: Date | null\n\n    static searchDebounce: number = 200\n\n    constructor(props: InviteUserProps) {\n        super(props)\n\n        this.lastSearchAt = null\n\n        this.state = {\n            cancelToViewMembers: false,\n            cancelToBrowser: false,\n            cancelToViewer: false,\n            autocompleteMessage: ''\n        }\n    }\n\n    onClickCancelToViewMembers() {\n        this.setState({ cancelToViewMembers: true })\n    }\n\n    onClickCancelToBrowser() {\n        this.setState({ cancelToBrowser: true })\n    }\n\n    onClickCancelToViewer() {\n        this.setState({ cancelToViewer: true })\n    }\n\n    onSendInvitation() {\n        this.props.onSendInvitation()\n    }\n\n    onSearchUsers(value: string) {\n        if (value.length < 3) {\n            this.setState({ autocompleteMessage: 'Search begins after 3 or more characters' })\n            return\n        }\n        this.setState({ autocompleteMessage: '' })\n        if (this.lastSearchAt === null ||\n            (new Date().getTime() - this.lastSearchAt.getTime() > InviteUser.searchDebounce)) {\n            this.lastSearchAt = new Date()\n            this.props.onSearchUsers(value)\n        }\n    }\n\n    onSelectUser(value: string) {\n        this.props.onSelectUser(value);\n    }\n\n    onShowInfo() {\n        Modal.info({\n            title: 'Invite User Help',\n            width: '50em',\n            content: (\n                <div>\n                    <p>This is the invite user tool...</p>\n                </div>\n            )\n        })\n    }\n\n    foundUsers() {\n        console.log('now getting users...')\n        const users = this.props.users.map(({ username, realname }) => {\n            return {\n                value: username,\n                text: realname + ' (' + username + ')'\n            }\n        })\n        console.log('got them')\n        return users\n    }\n\n    renderHeader() {\n        let orgName: string\n        // if (this.props.manageGroupRequestsView && this.props.manageGroupRequestsView.view) {\n        //     orgName = this.props.manageGroupRequestsView.view.organization.name\n        // } else {\n        //     orgName = 'loading...'\n        // }\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            <Icon type=\"tool\" />\n                            {' '}\n                            Inviting Users to join Org \"\n                            {this.props.organization.name}\n                            \"\n                        </span>\n                    </div>\n                    <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', justifyContent: 'flex-end', alignItems: 'center' }}>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToViewMembers.bind(this)}>\n                            Return to Org Members\n                        </Button>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToViewer.bind(this)}>\n                            Return to this Org\n                        </Button>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.onClickCancelToBrowser.bind(this)}>\n                            Return to Orgs Browser\n                        </Button>\n                        <Button\n                            shape=\"circle\"\n                            icon=\"info\"\n                            onClick={this.onShowInfo.bind(this)}>\n                        </Button>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    renderUsers() {\n        return this.props.users.map((user) => {\n            return (\n                <div>\n                    {user.username}\n                </div>\n            )\n        })\n    }\n\n    renderUserSelection() {\n        const dataSource = this.foundUsers()\n        return (\n            <div>\n                <div className=\"userSelection\">\n                    <AutoComplete\n                        onSearch={this.onSearchUsers.bind(this)}\n                        onSelect={this.onSelectUser.bind(this)}\n                        dataSource={dataSource}\n                        className=\"userAutocomplete\" >\n                        <Input suffix={<Icon type=\"search\" />} />\n                    </AutoComplete>\n                    <div className=\"autocompleteMessage\">\n                        {this.state.autocompleteMessage}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    renderSelectedUser() {\n        if (this.props.selectedUser === null) {\n            return (\n                <div className=\"selectedUser\">\n                    <p className=\"noSelection\">\n                        No user yet selected\n                </p>\n                </div>\n            )\n        } else {\n            return (\n                <div className=\"selectedUser\">\n                    <div className=\"username\">\n                        <span className=\"field-label\">\n                            username\n                        </span>\n                        <span>\n                            {this.props.selectedUser.username}\n                        </span>\n                    </div>\n                    <div className=\"realname\">\n                        <span className=\"field-label\">\n                            realname\n                        </span>\n                        <span>\n                            {this.props.selectedUser.realname}\n                        </span>\n                    </div>\n                </div>\n            )\n        }\n    }\n\n    renderOrgInfo() {\n        return (\n            <div className=\"orgInfo\">\n                <div className=\"name\">\n                    <span className=\"field-label\">name</span>\n                    <span>{this.props.organization.name}</span>\n                </div>\n                <div className=\"description\">\n                    <span className=\"field-label\">description</span>\n                    <span>{this.props.organization.description}</span>\n                </div>\n            </div>\n        )\n    }\n\n    renderInvitationForm() {\n        return (\n            <div className=\"invitationForm\">\n                <table>\n                    <tbody>\n                        <tr>\n                            <td>\n                                <span className=\"field-label\">\n                                    message\n                            </span>\n                            </td>\n                            <td>\n                                <textarea></textarea>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td colSpan={2} style={{ textAlign: 'center' }}>\n                                <Button onClick={this.onSendInvitation.bind(this)}>Send Invitation</Button>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n\n            </div>\n        )\n    }\n\n    renderInvitationStatus() {\n        return (\n            <div>\n                nothing to show yet\n            </div>\n        )\n    }\n\n    render() {\n\n        if (this.state.cancelToViewMembers) {\n            return <Redirect push to={\"/viewMembers/\" + this.props.organization.id} />\n        }\n\n        if (this.state.cancelToBrowser) {\n            return <Redirect push to=\"/organizations\" />\n        }\n\n        if (this.state.cancelToViewer) {\n            return <Redirect push to={\"/viewOrganization/\" + this.props.organization.id} />\n        }\n\n        return (\n            <div className=\"InviteUser\">\n                {this.renderHeader()}\n                <div className=\"row\">\n                    <div className=\"col1\">\n                        <h3>Organization</h3>\n                        {this.renderOrgInfo()}\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col1 firstCol\">\n                        <h3>Select User to Invite</h3>\n                        {this.renderUserSelection()}\n                    </div>\n                    <div className=\"col1 lastCol\">\n                        <h3>Selected User</h3>\n                        {this.renderSelectedUser()}\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col1\">\n                        <h3>Send Invitation</h3>\n                        {this.renderInvitationForm()}\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col1\">\n                        <h3>Status</h3>\n                        {this.renderInvitationStatus()}\n                    </div>\n                </div>\n                {/* {this.renderUsers()} */}\n            </div>\n        )\n    }\n}\n\nexport default InviteUser","import { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\n\nimport * as types from '../../types'\nimport * as actions from '../../redux/actions/inviteUser'\nimport InviteUser from './InviteUser'\n\nexport interface OwnProps {\n\n}\n\ninterface StateProps {\n    organization: types.Organization,\n    users: Array<types.BriefUser>,\n    selectedUser: types.User | null\n}\n\ninterface DispatchProps {\n    onSearchUsers: (query: string) => void,\n    onSelectUser: (username: string) => void,\n    onSendInvitation: () => void\n}\n\nfunction mapStateToProps(state: types.StoreState, props: OwnProps): StateProps {\n    // if (!state.viewMembersView || (state.viewMembersView.view === null)) {\n    //     throw new Error('Runtime Error - view members view is not defined!')\n    // }\n    // return {\n    //     organization: state.viewMembersView.view.organization\n    // }\n\n    return {\n        organization: (state.inviteUserView.viewState as types.InviteUserValue).organization,\n        users: (state.inviteUserView.viewState as types.InviteUserValue).users,\n        selectedUser: (state.inviteUserView.viewState as types.InviteUserValue).selectedUser\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.InviteUserLoad>): DispatchProps {\n    return {\n        onSearchUsers: (query: string) => {\n            dispatch(actions.inviteUserSearchUsers(query) as any)\n        },\n        onSelectUser: (username: string) => {\n            dispatch(actions.selectUser(username) as any)\n        },\n        onSendInvitation: () => {\n            dispatch(actions.sendInvitation() as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, types.StoreState>(mapStateToProps, mapDispatchToProps)(InviteUser)","import * as React from 'react'\n\nimport InviteUserContainer from './InviteUserContainer'\nimport { InviteUserState } from '../../types';\n\nexport interface InviteUserLoaderProps {\n    state: InviteUserState,\n    organizationId: string,\n    onInviteUserLoad: (organizationId: string) => void\n}\n\ninterface InviteUserLoaderState {\n\n}\n\nclass InviteUserLoader extends React.Component<InviteUserLoaderProps, InviteUserLoaderState> {\n    constructor(props: InviteUserLoaderProps) {\n        super(props)\n    }\n\n    renderLoading() {\n        return (\n            <div>\n                Loading...\n            </div>\n        )\n    }\n\n    renderError() {\n        return (\n            <div>\n                Error!\n            </div>\n\n        )\n    }\n\n    render() {\n        console.log('loader', this.props)\n        switch (this.props.state) {\n            case InviteUserState.NONE:\n                this.props.onInviteUserLoad(this.props.organizationId)\n                return this.renderLoading()\n            case InviteUserState.LOADING:\n                return this.renderLoading()\n            case InviteUserState.ERROR:\n                return this.renderError()\n            case InviteUserState.READY:\n                return (\n                    <InviteUserContainer />\n                )\n        }\n\n\n    }\n}\n\n// The container component -- just in this file!\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\n\nimport * as types from '../../types'\nimport * as actions from '../../redux/actions/inviteUser'\n// import ViewMembers from './component'\n\nexport interface OwnProps {\n    organizationId: string\n}\n\ninterface StateProps {\n    state: types.InviteUserState\n}\n\ninterface DispatchProps {\n    onInviteUserLoad: (organizationId: string) => void\n}\n\nfunction mapStateToProps(state: types.StoreState, props: OwnProps): StateProps {\n    console.log('mapping state to props', props)\n    return {\n        state: state.inviteUserView.state\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.InviteUserLoad>): DispatchProps {\n    return {\n        onInviteUserLoad: (organizationId: string) => {\n            dispatch(actions.inviteUserLoad(organizationId) as any)\n        }\n    }\n}\n\n\nexport default connect<StateProps, DispatchProps, OwnProps, types.StoreState>(mapStateToProps, mapDispatchToProps)(InviteUserLoader)","import * as React from 'react'\nimport Header from '../Header';\nimport { Icon, Button, Modal } from 'antd';\nimport { Redirect } from 'react-router-dom';\nimport './style.css'\nimport { Organization } from '../../types';\n\nexport interface ManageMembershipProps {\n    // temp.\n    organization: Organization\n}\n\ninterface MangeMembershipState {\n    cancelToBrowser: boolean\n    cancelToViewer: boolean\n}\n\nclass ManageMembership extends React.Component<ManageMembershipProps, MangeMembershipState> {\n    constructor(props: ManageMembershipProps) {\n        super(props)\n        console.log('here...')\n\n        this.state = {\n            cancelToBrowser: false,\n            cancelToViewer: false\n        }\n    }\n\n    doCancelToViewer() {\n        this.setState({ cancelToViewer: true })\n    }\n\n    doCancelToBrowser() {\n        this.setState({ cancelToBrowser: true })\n    }\n\n    doShowInfo() {\n        // this.setState({ showInfo: true })\n        Modal.info({\n            title: 'Manage My Membership Help',\n            width: '50em',\n            content: (\n                <div>\n                    <p>This is the view to help you manage your membership...</p>\n                </div>\n            )\n        })\n    }\n\n    renderHeader() {\n        let orgName: string\n        return (\n            <Header>\n                <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                    <div style={{ flex: '0 0 auto' }}>\n                        <span>\n                            <Icon type=\"tool\" />\n                            {' '}\n                            Managing your membership in the Organization \"\n                            {this.props.organization.name}\n                            \"\n                        </span>\n                    </div>\n                    <div style={{ flex: '1 1 0px', display: 'flex', flexDirection: 'row', justifyContent: 'flex-end', alignItems: 'center' }}>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.doCancelToViewer.bind(this)}>\n                            Return to this Org\n                        </Button>\n                        <Button icon=\"undo\"\n                            type=\"danger\"\n                            onClick={this.doCancelToBrowser.bind(this)}>\n                            Return to Orgs Browser\n                        </Button>\n                        <Button\n                            shape=\"circle\"\n                            icon=\"info\"\n                            onClick={this.doShowInfo.bind(this)}>\n                        </Button>\n                    </div>\n                </div>\n            </Header>\n        )\n    }\n\n    render() {\n\n        if (this.state.cancelToBrowser) {\n            return <Redirect push to=\"/organizations\" />\n        }\n\n        if (this.state.cancelToViewer) {\n            return <Redirect push to={\"/viewOrganization/\" + this.props.organization.id} />\n        }\n\n        return (\n            <div className=\"ManageMembership\">\n                {this.renderHeader()}\n                <div className=\"body\">\n                    <div className=\"col1\">\n                        <div>\n                            editing area here\n                        </div>\n                    </div>\n                    <div className=\"col2\">\n                        <div>\n                            org user profile here\n                        </div>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default ManageMembership","import { Action } from 'redux'\nimport { ThunkDispatch } from 'redux-thunk'\nimport { ActionFlag } from './index'\nimport { Model } from '../../data/model'\nimport { AppError, Organization, StoreState } from '../../types';\n\n// Loading\n\nexport interface Load extends Action {\n    type: ActionFlag.MANAGE_MEMBERSHIP_LOAD\n}\n\nexport interface LoadStart extends Action {\n    type: ActionFlag.MANAGE_MEMBERSHIP_LOAD_START\n}\n\nexport interface LoadSuccess extends Action {\n    type: ActionFlag.MANAGE_MEMBERSHIP_LOAD_SUCCESS,\n    organization: Organization\n}\n\nexport interface LoadError extends Action {\n    type: ActionFlag.MANAGE_MEMBERSHIP_LOAD_ERROR,\n    error: AppError\n}\n\nexport function loadStart(): LoadStart {\n    return {\n        type: ActionFlag.MANAGE_MEMBERSHIP_LOAD_START\n    }\n}\n\nexport function loadSuccess(organization: Organization): LoadSuccess {\n    return {\n        type: ActionFlag.MANAGE_MEMBERSHIP_LOAD_SUCCESS,\n        organization: organization\n    }\n}\n\nexport function loadError(error: AppError): LoadError {\n    return {\n        type: ActionFlag.MANAGE_MEMBERSHIP_LOAD_ERROR,\n        error: error\n    }\n}\n\nexport function manageMembershipLoad(organizationId: string, memberUsername: string) {\n    return (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        console.log('here?')\n        dispatch(loadStart())\n\n        const {\n            auth: { authorization: { token, username } },\n            app: { config } } = getState()\n        const model = new Model({\n            token, username,\n            groupsServiceURL: config.services.Groups.url,\n            userProfileServiceURL: config.services.UserProfile.url,\n            workspaceServiceURL: config.services.Workspace.url\n        })\n\n        model.getOrg(organizationId)\n            .then((org) => {\n                dispatch(loadSuccess(org))\n            })\n            .catch((err) => {\n                dispatch(loadError({\n                    code: err.name,\n                    message: err.message\n                }))\n            })\n    }\n\n}\n\n// Modify fields\n\n\n// Save","import * as React from 'react'\n\nimport Container from './component'\nimport { ComponentLoadingState, StoreState, ManageMembershipValue, AppError, ManageMembershipView } from '../../types';\n\nexport interface LoaderProps {\n    organizationId: string\n    view: ManageMembershipView\n    onLoad: (organizationId: string) => void\n}\n\ninterface LoaderState {\n\n}\n\nclass ManageMembershipLoader extends React.Component<LoaderProps, LoaderState> {\n    constructor(props: LoaderProps) {\n        super(props)\n    }\n\n    renderLoading() {\n        return (\n            <div>\n                Loading...\n            </div>\n        )\n    }\n\n    renderError(error: AppError) {\n        return (\n            <div>\n                Error: {error.message}\n            </div>\n        )\n    }\n\n    render() {\n        if (this.props.view.loading) {\n            return this.renderLoading()\n        } else {\n            if (this.props.view.error) {\n                return this.renderError(this.props.view.error)\n            } else if (this.props.view.value) {\n                return (\n                    <Container organization={this.props.view.value.organization} />\n                )\n            } else {\n                this.props.onLoad(this.props.organizationId)\n                return this.renderLoading()\n            }\n        }\n\n\n        //     case ComponentLoadingState.NONE:\n        //         this.props.onLoad(this.props.organizationId)\n        //         return this.renderLoading()\n        //     case ComponentLoadingState.LOADING:\n        //         return this.renderLoading()\n        //     case ComponentLoadingState.SUCCESS:\n        //         if (this.props.view.viewState.)\n        //         return (\n        //             <Container organization={this.props.view.viewState.organization />\n        //         )\n        // }\n    }\n}\n\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\nimport * as actions from '../../redux/actions/manageMembership'\n\nexport interface OwnProps {\n    organizationId: string\n}\n\ninterface StateProps {\n    view: ManageMembershipView\n}\n\ninterface DispatchProps {\n    onLoad: (organizationId: string) => void\n}\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    return {\n        view: state.manageMembershipView\n    }\n}\n\nexport function mapDispatchToProps(dispatch: Dispatch<actions.Load>): DispatchProps {\n    return {\n        onLoad: (organizationId: string) => {\n            // todo: username below...\n            dispatch(actions.manageMembershipLoad(organizationId, '') as any)\n        }\n    }\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(mapStateToProps, mapDispatchToProps)(ManageMembershipLoader)","import { StoreState, SortDirection, AuthState, AppState, EditState, SaveState, ValidationState, ViewOrgState, EditOrgState, ViewMembersViewState, BrowseOrgsState, InviteUserState, ComponentLoadingState } from \"../types\";\nimport { StaticData } from \"../data/model\";\n\nexport class StateInstances {\n    static makeInitialState(): StoreState {\n        return {\n            browseOrgs: {\n                state: BrowseOrgsState.NONE,\n                error: null,\n                view: {\n                    rawOrganizations: [],\n                    organizations: [],\n                    totalCount: 0,\n                    filteredCount: 0,\n                    sortBy: 'name',\n                    sortDirection: SortDirection.ASCENDING,\n                    filter: 'all',\n                    searchTerms: [],\n                    selectedOrganizationId: null,\n                    searching: false\n                }\n            },\n\n            auth: {\n                status: AuthState.NONE,\n                message: '',\n                authorization: {\n                    token: '',\n                    username: '',\n                    realname: '',\n                    roles: []\n                }\n            },\n            error: null,\n\n            app: {\n                status: AppState.NONE,\n                config: {\n                    baseUrl: '',\n                    services: {\n                        Groups: {\n                            url: ''\n                        },\n                        UserProfile: {\n                            url: ''\n                        },\n                        Workspace: {\n                            url: ''\n                        }\n                    }\n                }\n            },\n            addOrg: {\n                editState: EditState.NONE,\n                saveState: SaveState.NONE,\n                validationState: ValidationState.NONE,\n                newOrganization: StaticData.makeEmptyEditableOrganization()\n            },\n            updateOrg: {\n                pending: false\n            },\n            viewOrg: {\n                state: ViewOrgState.NONE\n            },\n            editOrg: {\n                organizationId: '',\n                editState: EditState.NONE,\n                saveState: SaveState.NONE,\n                validationState: ValidationState.NONE,\n                editedOrganization: StaticData.makeEmptyEditableOrganization()\n            },\n            manageOrganizationRequestsView: {\n                state: ComponentLoadingState.NONE,\n                error: null,\n                viewState: null\n            },\n            viewMembersView: {\n                state: ViewMembersViewState.NONE,\n                error: null,\n                view: null\n            },\n            inviteUserView: {\n                state: InviteUserState.NONE,\n                viewState: null\n            },\n            manageMembershipView: {\n                loading: false,\n                error: null,\n                value: null\n            }\n        }\n    }\n}","import React, { Component } from 'react'\nimport { Route } from 'react-router'\nimport { BrowserRouter, Redirect, HashRouter } from 'react-router-dom'\n\n// redux\nimport { Provider } from 'react-redux';\nimport { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\n\nimport theReducer from './redux/reducers'\n\n// the app and subcomponents\nimport './App.css';\n\n// fontawesome setup\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faSpinner, faSearch } from '@fortawesome/free-solid-svg-icons'\nlibrary.add(faSpinner, faSearch)\n\nimport OrganizationsBrowser from './components/browseOrgs/OrganizationsBrowserContainer'\nimport NewOrganization from './components/newOrganization/container'\nimport ViewOrganization from './components/viewOrganization/ViewOrganizationContainer'\nimport EditOrganization from './containers/EditOrganization'\nimport Auth from './containers/Auth'\nimport KBaseIntegration from './containers/KBaseIntegration'\nimport ManageOrganizationRequests from './components/manageOrganizationRequests/loader'\nimport ViewMembers from './components/viewMembers/loader'\nimport InviteUser from './components/inviteUser/InviteUserLoader'\nimport ManageMembership from './components/manageMembership/loader'\nimport { StateInstances } from './redux/state';\n\n// Put the redux store together\n// Just for prototyping --- This is super naive and will change!\n// import {organizations} from './data/temp';\n\n// TODO: determine the environment\n\nconst hosted = window.frameElement ? true : false\n\n// Set up initial state \n// TODO: move to own file\nconst initialState = StateInstances.makeInitialState()\n\n\n// TODO: remove the cast of reducer to any...\n// const middleware = [thunk]\n// const store = createStore<StoreState, SortOrgs, null, null>(theReducer as any, initialState, applyMiddleware(thunk));\nconst store = createStore(theReducer as any, initialState as any, compose(applyMiddleware(thunk)))\n\nclass App extends Component {\n  constructor(props: any) {\n    super(props)\n  }\n\n  render() {\n    return (\n      <Provider store={store}>\n        <Auth hosted={hosted}>\n          <KBaseIntegration>\n            <HashRouter basename=\"/orgs/\">\n              <div className=\"App\">\n                <div className=\"App-body\">\n                  <Route path=\"/organizations\" component={OrganizationsBrowser} />\n                  <Route path=\"/newOrganization\" component={NewOrganization} />\n                  {/* The destructuring below is ugly, but effective */}\n                  <Route path=\"/viewOrganization/:id\" component={({ match: { params: { id } } }: { match: { params: { id: string } } }) => <ViewOrganization id={id} />} />\n                  <Route path=\"/editOrganization/:id\" component={({ match: { params: { id } } }: { match: { params: { id: string } } }) => <EditOrganization id={id} />} />\n                  <Route path=\"/manageOrganizationRequests/:id\" component={({ match: { params: { id } } }: { match: { params: { id: string } } }) => <ManageOrganizationRequests organizationId={id} />} />\n                  <Route path=\"/viewMembers/:id\" component={({ match: { params: { id } } }: { match: { params: { id: string } } }) => <ViewMembers organizationId={id} />} />\n                  <Route path=\"/inviteUser/:id\" component={({ match: { params: { id } } }: { match: { params: { id: string } } }) => (<InviteUser organizationId={id} />)} />\n                  <Route path=\"/membership/:id\" component={({ match: { params: { id } } }: { match: { params: { id: string } } }) => (<ManageMembership organizationId={id} />)} />\n\n                  <Redirect from=\"/\" to=\"/organizations\" exact={true} />\n                </div>\n              </div>\n            </HashRouter>\n          </KBaseIntegration>\n        </Auth>\n      </Provider>\n    )\n  }\n}\n\nexport default App\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\nimport 'typeface-oxygen';\nimport 'normalize.css';\nimport 'antd/dist/antd.css'\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}